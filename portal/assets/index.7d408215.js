var Wf=Object.defineProperty;var Qf=(t,e,n)=>e in t?Wf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var G=(t,e,n)=>(Qf(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const Zf=[0,31,59,90,120,151,181,212,243,273,304,334],Jf=1e3,Kf=60*Jf,ht=(t,e)=>t!=null&&typeof t[e]=="function",H=t=>typeof t=="number",j=t=>typeof t=="string",t1=t=>j(t)||H(t)?new Date(t):ht(t,"toDate")?t.toDate():t,wc=t=>!(t%4)&&(!!(t%100)||!(t%400));function os(t,e){return!e&&(e={}),(...n)=>{const s=JSON.stringify(n);return s!==void 0?s in e?e[s]:e[s]=t.apply(null,n):t.apply(null,n)}}const _c=os((t,e)=>t.repeat(e)),$i=os((t,e=" ")=>{const n=_c(String(e),t);return(s,i)=>s==null?n:(s=s.toString(),i=i!==void 0?i:s.length,i<t?n.substring(i)+s:s)}),_t=$i(2,"0"),e1=$i(3,"0"),n1=$i(4,"0"),Se=t=>typeof t=="function",s1={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],sepHM:".",date:["dd","/DM","MM","/MY","yyyy"],time:["h","/HM","mm"," ","a"],units:{y:{s:"y",p:"y"},M:{s:"m",p:"m"},d:{s:"d",p:"d"},h:{s:"h",p:"h"},m:{s:"min",p:"min"},s:{s:"s",p:"s"},t:{s:"ms",p:"ms"}},less:"< %s",past:"%s ago",now:"just now",future:"in %s"},i1=t=>{const e={sepED:" ",sepDM:"/",sepMY:"/",sepHM:":",date:["E","/ED","d","/DM","MMM","/MY","yyyy"],time:["H","/HM","mm"],...t};return!e.dateTime&&(e.dateTime=[...e.date,", ",...e.time]),e};let Ne=i1(s1);const r1=(t,e,n)=>Zf[e]+n+~~(e>1&&wc(t)),o1=(t,e,n)=>{const s=new Date(Date.UTC(t,0,1)).getDay()||7;if(!e){if(s===5&&n<4)return 53;if(s===6&&n<3)return 52+~~wc(t-1);if(s===7&&n<2)return 52}const i=(s<5?8:15)-s;return Math.ceil((r1(t,e,n)-i)/7+1)},Ur={yyyy:t=>n1(t.getFullYear()),yy:t=>_t(t.getFullYear()%100),MMM:t=>Ne.months[t.getMonth()],MM:t=>_t(t.getMonth()+1),M:t=>String(t.getMonth()+1),dd:t=>_t(t.getDate()),d:t=>String(t.getDate()),E:t=>Ne.days[t.getDay()],ww:t=>_t(Ur.w(t,!1)),w:t=>String(o1(t.getFullYear(),t.getMonth(),t.getDate())),q:t=>String((t.getMonth()/3|0)+1),HH:t=>_t(t.getHours()),H:t=>String(t.getHours()),hh:t=>{const e=t.getHours()%12;return _t(e>0?e:12)},h:t=>{const e=t.getHours()%12;return String(e>0?e:12)},mm:t=>_t(t.getMinutes()),m:t=>String(t.getMinutes()),ss:t=>_t(t.getSeconds()),s:t=>String(t.getSeconds()),SS:t=>e1(t.getMilliseconds()),S:t=>String(t.getMilliseconds()),A:t=>String(t.getHours()<12?"AM":"PM"),a:t=>String(t.getHours()<12?"am":"pm"),Z:(t,e=!1)=>{const n=e?0:t.getTimezoneOffset(),s=Math.abs(n);return`${n<0?"+":"-"}${_t(s/60|0)}:${_t(s%60)}`},ZZ:(t,e=!1)=>e?"Z":Ur.Z(t,e),"/DM":()=>Ne.sepDM,"/ED":()=>Ne.sepED,"/HM":()=>Ne.sepHM,"/MY":()=>Ne.sepMY},a1=t=>(e=Date.now(),n=!1)=>{let s=t1(e);return n&&(s=new Date(s.getTime()+s.getTimezoneOffset()*Kf)),t.map(i=>{let r;return j(i)?i.startsWith("\\")?i.substring(1):(r=Ur[i])?r(s,n):i:Se(i)?i(s,n):i}).join("")},Pa=a1(["yyyy","MM","dd","-","HH","mm","ss"]),Ao=(t,e,n)=>{const s={expire:1e4,utf8:!1,...n};j(e)&&s.utf8&&(e=new TextEncoder().encode(e),s.mime+=";charset=UTF-8");const i=URL.createObjectURL(e instanceof Blob?e:new Blob([e],{type:s.mime})),r=document.createElement("a");r.setAttribute("download",t),r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),s.expire>0&&setTimeout(()=>URL.revokeObjectURL(i),s.expire)},l1=(t,e,n="png",s=.95)=>{const i=`image/${n}`;t.toBlob(r=>r?Ao(`${e}.${n}`,r,{mime:i}):console.warn("can't download canvas"),i,s)},c1=(t,e,n)=>{n={fps:60,mimeType:"video/webm; codecs=vp9",...n};const s=t.captureStream(n.fps),i=new MediaRecorder(s,{mimeType:n.mimeType});let r=[];return i.ondataavailable=o=>{o.data.size>0&&(r.push(o.data),Ao(e,new Blob(r,{type:n.mimeType}),{mime:n.mimeType}),r=[])},i},u1=(t,e,n=!1)=>{const s=typeof global<"u"?global:typeof window<"u"?window:void 0;s&&(n||(typeof process<"u"&&process.env!==void 0?!!{}.UMBRELLA_GLOBALS:!!{}.VITE_UMBRELLA_GLOBALS))&&(s[t]=e)},as=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},f1=as(()=>"illegal arity"),wo=t=>{throw new f1(t)};function Sc(...t){let[e,n,s,i,r,o,a,l,u,c]=t;switch(t.length){case 0:wo(0);case 1:return e;case 2:return(...h)=>e(n(...h));case 3:return(...h)=>e(n(s(...h)));case 4:return(...h)=>e(n(s(i(...h))));case 5:return(...h)=>e(n(s(i(r(...h)))));case 6:return(...h)=>e(n(s(i(r(o(...h))))));case 7:return(...h)=>e(n(s(i(r(o(a(...h)))))));case 8:return(...h)=>e(n(s(i(r(o(a(l(...h))))))));case 9:return(...h)=>e(n(s(i(r(o(a(l(u(...h)))))))));case 10:default:const m=(...h)=>e(n(s(i(r(o(a(l(u(c(...h))))))))));return t.length===10?m:Sc(m,...t.slice(10))}}const Ni=t=>ht(t,"xform")?t.xform():t;function Rc(...t){return t=t.map(Ni),Sc.apply(null,t)}const Mi=t=>t!=null&&typeof t[Symbol.iterator]=="function",Oi=(t,e)=>[t[0],t[1],e],Nn=Symbol(),Fa=()=>{},_o=t=>t!=null&&typeof t!="function"&&t.length!==void 0;class Fn{constructor(e){this.value=e}deref(){return this.value}}const d1=t=>new Fn(t),Fe=t=>t instanceof Fn,h1=t=>t instanceof Fn?t:new Fn(t),js=t=>t instanceof Fn?t.deref():t,m1=t=>t.length===2?[void 0,t[1]]:t.length===3?[t[1],t[2]]:wo(t.length);function g1(...t){const e=t[0],n=e[0],s=e[1],i=e[2];t=m1(t);const r=t[0]==null?n():t[0],o=t[1];return js(s(ht(o,"$reduce")?o.$reduce(i,r):_o(o)?p1(i,r,o):y1(i,r,o)))}const p1=(t,e,n)=>{for(let s=0,i=n.length;s<i;s++)if(e=t(e,n[s]),Fe(e)){e=e.deref();break}return e},y1=(t,e,n)=>{for(let s of n)if(e=t(e,s),Fe(e)){e=e.deref();break}return e},Ic=(t,e)=>[t,n=>n,e];function b1(t){return t?[...t]:Ic(()=>[],(e,n)=>(e.push(n),e))}function*A1(t,e){const n=Ni(t)(b1()),s=n[1],i=n[2];for(let r of e){const o=i([],r);if(Fe(o)){yield*js(s(o.deref()));return}o.length&&(yield*o)}yield*js(s([]))}function*Di(t,e){const n=Ni(t)([Fa,Fa,(s,i)=>i])[2];for(let s of e){let i=n(Nn,s);if(Fe(i)){i=js(i.deref()),i!==Nn&&(yield i);return}i!==Nn&&(yield i)}}const w1=(t,e,n=Di)=>{const s=e.length-1;return Mi(e[s])?e.length>1?n(t.apply(null,e.slice(0,s)),e[s]):n(t(),e[0]):void 0};function ls(t,e){return Mi(e)?Di(ls(t),e):n=>{const s=n[2];return Oi(n,(i,r)=>s(i,t(r)))}}function Ec(...t){return w1(Ec,t)||(e=>{const n=e[2],s=t[0];let i=t[1]||0;return Oi(e,(r,o)=>n(r,s(i++,o)))})}function vc(t,e,n){return new _1(t,e,n)}class _1{constructor(e,n,s){e===void 0?(e=0,n=1/0):n===void 0&&(n=e,e=0),s=s===void 0?e<n?1:-1:s,this.from=e,this.to=n,this.step=s}*[Symbol.iterator](){let{from:e,to:n,step:s}=this;if(s>0)for(;e<n;)yield e,e+=s;else if(s<0)for(;e>n;)yield e,e+=s}$reduce(e,n){const s=this.step;if(s>0)for(let i=this.from,r=this.to;i<r&&!Fe(n);i+=s)n=e(n,i);else for(let i=this.from,r=this.to;i>r&&!Fe(n);i+=s)n=e(n,i);return n}}function S1(t,e){t=t||"";let n=!0;return e?[...e].join(t):Ic(()=>"",(s,i)=>(s=n?s+i:s+t+i,n=!1,s))}function $c(t,e){return Mi(e)?A1($c(t),e):n=>{const s=n[2];let i=t;return Oi(n,(r,o)=>--i>0?s(r,o):i===0?h1(s(r,o)):d1(r))}}function Nc(...t){return R1(Nc,g1,t)}const R1=(t,e,n)=>{let s,i;switch(n.length){case 4:i=n[3],s=n[2];break;case 3:i=n[2];break;case 2:return ls(r=>t(n[0],n[1],r));default:wo(n.length)}return e(Ni(n[0])(n[1]),s,i)};function*I1(...t){const e=t.map(n=>n[Symbol.iterator]());for(;;){const n=[];for(let s of e){let i=s.next();if(i.done)return;n.push(i.value)}yield n}}const E1=as(()=>"unsupported operation"),cs=t=>{throw new E1(t)},Xt=(t=0)=>{const e=new Array(5);let n;const s=(...i)=>{const r=e[i[t].length]||n;return r?r(...i):cs(`no impl for vec size ${i[t].length}`)};return s.add=(i,r)=>e[i]=r,s.default=i=>n=i,s.impl=i=>e[i]||n,s},v1="o,a",Un="o,a,b",Mc="o,a,b,c",$1="o,a,n",N1="o,a,n,b",M1="o,a,b,n",Oc="io=0,ia=0,so=1,sa=1",O1="io=0,ia=0,ib=0,so=1,sa=1,sb=1",D1="!o&&(o=a);",Dc="!o&&(o=[]);",xc="!a&&(a=[]);",x1=t=>([e,n,s])=>`${e}=${n}${t}${s};`,G1=t=>([e,n])=>`${e}=${n}${t}n;`,T1=(t,e)=>([n,s,i,r])=>`${n}=(${s}${t}${i})${e}${r};`,C1=(t,e)=>([n,s,i])=>`${n}=(${s}${t}n)${e}${i};`,z1=(t="op")=>([e,n])=>`${e}=${t}(${n});`,Gc=(t="op")=>([e,n,s])=>`${e}=${t}(${n},${s});`,Tc=([t,e])=>`${t}*${e}`,B1=([t,e])=>`s+=${t}*${e};`,Cc=([t,e])=>`${t}=${e};`,L1=([t])=>`${t}=n;`,P1=([t,e,n,s])=>`${t}=${e}+(${n}-${e})*${s};`,F1=([t,e,n])=>`${t}=${e}+(${n}-${e})*n;`,U1=t=>e=>e>1?`${t}[i${t}+${e}*s${t}]`:e==1?`${t}[i${t}+s${t}]`:`${t}[i${t}]`,k1=t=>ls(U1(t),vc()),q1=t=>ls(e=>`${t}[${e}]`,vc()),zc=(t,e,n,s="a",i="",r="",o="",a=!1)=>[r,Nc(Rc($c(t),Ec((l,u)=>e(u,l))),S1(i),I1.apply(null,n.split(",").map(a?k1:q1))),o,s!==""?`return ${s};`:""],Bc=(t,e,n="a",s,i,r=!1)=>[s,"for(let i=a.length;--i>=0;) {",t(e.split(",").map(r?o=>`${o}[i${o}+i*s${o}]`:o=>`${o}[i]`)),"}",i,n!==null?`return ${n};`:""],V1=(t,e=Un,n="o",s=D1,i)=>[s,"while(k-->0) {",t(e.split(",").map(r=>`${r}[i${r}+k*s${r}]`)),"}",i,n!==null?`return ${n};`:""],So=(t,e)=>`!${t} && (${t}=${e.split(",")[1]});`,tn=(t,e,n,s=n,i="a",r,o,a,l=!1)=>new Function(n,zc(t,e,s,i,r,o,a,l).join("")),Lc=(t,e,n,s,i,r=i,o="a",a="",l,u,c=!1)=>new Function(s,`return (${i})=>{${zc(t,n,r,o,a,l,u,c).join("")}}`)(...e),xi=(t,e,n=e,s="a",i,r,o=!1)=>new Function(e,Bc(t,n,s,i,r,o).join("")),j1=(t,e,n=e,s,i,r)=>new Function(e,V1(t,n,s,i,r).join("")),H1=(t,e,n,s,i=s,r="a",o,a,l=!1)=>new Function(n,`return (${s})=>{${Bc(e,i,r,o,a,l).join("")}}`)(...t),xt=(t,e=Un,n,s="o",i=1,r)=>{n=n||e,r=r!=null?r:So(s,e);const o=Xt(i),a=l=>o.add(l,tn(l,t,e,n,s,"",r));return o.default(xi(t,e,n,s,r)),[o,a(2),a(3),a(4)]},Ro=(t,e,n=v1,s,i="o",r=1,o)=>{const a=e||z1("op");s=s||n,o=o!=null?o:So(i,n);const l=Xt(r),u=c=>l.add(c,Lc(c,[t],a,"op",n,s,i,"",o));return l.default(H1([t],a,"op",n,s,i,o)),[l,u(2),u(3),u(4)]},Y1=(t,e=Un,n=O1,s=Un,i="o",r,o=[2,3,4])=>[j1(t,`${e},k,${n}`,s,i,r),...o.map(a=>tn(a,t,`${e},${n}`,s,i,"",r!=null?r:So(i,e),"",!0))],Io=t=>xt(x1(t)),Eo=t=>xt(G1(t),$1),[Ue,Gi,Pc,IA]=Io("+"),[EA,Fc,X1,vA]=Eo("+"),Ut=-1/0,kt=1/0,Uc=Object.freeze([Ut,Ut]),kc=Object.freeze([kt,kt]),W1=Object.freeze([1,1]),vo=Object.freeze([0,0]),Q1=Object.freeze([1,0]),Z1=Object.freeze([0,1]);Object.freeze([Ut,Ut,Ut]);Object.freeze([kt,kt,kt]);Object.freeze([1,1,1]);const qc=Object.freeze([0,0,0]);Object.freeze([1,0,0]);Object.freeze([0,1,0]);Object.freeze([0,0,1]);Object.freeze([Ut,Ut,Ut,Ut]);Object.freeze([kt,kt,kt,kt]);Object.freeze([1,1,1,1]);Object.freeze([0,0,0,0]);Object.freeze([1,0,0,0]);Object.freeze([0,1,0,0]);Object.freeze([0,0,1,0]);Object.freeze([0,0,0,1]);const[kn,Vc,J1,$A]=xt(Gc("Math.max")),[J,ke,kr,NA]=xt(Cc,"o,a",void 0,"o",1,Dc),[MA,qr,K1,OA]=Eo("-"),Ua=Object.getPrototypeOf,Dt=t=>{let e;return t!=null&&typeof t=="object"&&((e=Ua(t))===null||Ua(e)===null)},td=(t,e=0)=>new Array(t).fill(e),$o=t=>{if(t.length){const e=t[t.length-1];return Dt(e)?t.pop():(e==null&&t.pop(),void 0)}},ed=t=>{const e=$o(t);return t.length?t.length===2?[t[0],t[1],e]:[void 0,t[0],e]:[void 0,void 0,e]},nd=t=>{const e=$o(t);return t.length?t.length===2?[t[0],t[1],e]:H(t[0])?[void 0,t[0],e]:[t[0],void 0,e]:[void 0,void 0,e]},vt=(t,e=2)=>H(t)?td(e,t):t,Mn=t=>ht(t,"copy")?t.copy():J([],t),jc=t=>t.map(Mn),P=t=>({...t.attribs}),Wt=(t,e)=>new t(jc(e.points),P(e));class qn{constructor(e=[0,0,0],n=1,s){this.pos=e,this.attribs=s,this.size=vt(n,3)}get type(){return"aabb"}copy(){return new qn(kr([],this.pos),kr([],this.size),P(this))}withAttribs(e){return new qn(this.pos,this.size,e)}max(){return Pc([],this.pos,this.size)}offset(e){return K1(null,this.pos,e),J1(null,X1(null,this.size,e*2),qc),this}}class Qt{constructor(e=[],n){this.points=e,this.attribs=n}*[Symbol.iterator](){yield*this.points}}const ka=Object.getPrototypeOf({}),hs="function",qa="string",Re=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===hs)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===hs)return e.equiv(t)}else return t==e;return typeof t===qa||typeof e===qa?!1:(n=Object.getPrototypeOf(t),(n==null||n===ka)&&(n=Object.getPrototypeOf(e),n==null||n===ka)?od(t,e):typeof t!==hs&&t.length!==void 0&&typeof e!==hs&&e.length!==void 0?sd(t,e):t instanceof Set&&e instanceof Set?id(t,e):t instanceof Map&&e instanceof Map?rd(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},sd=(t,e,n=Re)=>{let s=t.length;if(s===e.length)for(;s-- >0&&n(t[s],e[s]););return s<0},id=(t,e,n=Re)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),rd=(t,e,n=Re)=>t.size===e.size&&n([...t].sort(),[...e].sort()),od=(t,e,n=Re)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(!e.hasOwnProperty(s)||!n(t[s],e[s]))return!1;return!0},z=Math.PI,k=z*2,V=z/2,ad=z/180;let mt=1e-6;const No=(t,e=1)=>[Math.cos(t)*e,Math.sin(t)*e],Va=t=>(t%=k,t<0?k+t:t),y=t=>t*ad,le=(t,e,n)=>t<e?e:t>n?n:t,F=t=>t<0?0:t>1?1:t,Hc=(t,e,n)=>t>=e&&t<=n,ld=(t,e,n)=>n!==e?(t-e)/(n-e):0,S=(t,e,n,s,i)=>s+(i-s)*F(ld(t,e,n)),Vr=(t,e,n)=>e+(n-e)*F(t),[cd,rt,ja,DA]=Io("*"),ud=(t,e)=>(n,s,i)=>{n?n!==s&&J(n,s):n=s;const r=Math.sin(i),o=Math.cos(i),a=s[t],l=s[e];return n[t]=a*o-l*r,n[e]=a*r+l*o,n},Yc=ud(0,1),Gs=Yc,Xc=(t,e,n,s,i=[])=>Gi(null,Yc(null,rt(i,No(s),e),n),t),fd=as(()=>"Assertion failed"),At=(typeof process<"u"&&process.env!==void 0?!!{}.UMBRELLA_ASSERTS:!!{}.VITE_UMBRELLA_ASSERTS)?(t,e)=>{if(typeof t=="function"&&!t()||!t)throw new fd(typeof e=="function"?e():e)}:()=>{},[On,dd,xA,GA]=xt(C1("*","+"),N1,Un),[Ti,Hs,hd,TA]=Eo("*"),md=(t,e,n,s,i,r,o)=>(!t&&(t=e),On(t,s,o,On(t,n,r,Ti(t,e,i)))),gd=(t,e,n,s,i,r,o,a,l)=>(!t&&(t=e),On(t,i,l,On(t,s,a,On(t,n,o,Ti(t,e,r))))),pd=(t,e,n,s,i,r)=>{const o=1-r,a=o*o,l=r*r;return gd(t,e,n,s,i,a*o,3*a*r,3*l*o,l*r)};class Vn{constructor(e=[0,0],n=1,s){this.pos=e,this.r=n,this.attribs=s}get type(){return"circle"}copy(){return new Vn(J([],this.pos),this.r,P(this))}withAttribs(e){return new Vn(this.pos,this.r,e)}toHiccup(){return["circle",this.attribs,this.pos,this.r]}}class Ys extends Qt{get type(){return"cubic"}copy(){return Wt(Ys,this)}withAttribs(e){return new Ys(this.points,e)}toHiccup(){return["path",this.attribs,[["M",this.points[0]],...this.toHiccupPathSegments()]]}toHiccupPathSegments(){const e=this.points;return[["C",e[1],e[2],e[3]]]}}class jn{constructor(e=[0,0],n=[1,1],s){this.pos=e,this.attribs=s,this.r=vt(n)}get type(){return"ellipse"}copy(){return new jn(J([],this.pos),J([],this.r),P(this))}withAttribs(e){return new jn(this.pos,this.r,e)}toHiccup(){return["ellipse",this.attribs,this.pos,this.r]}}class Dn{constructor(e,n=[]){this.attribs=e,this.children=n}get type(){return"group"}*[Symbol.iterator](){yield*this.children}copy(){return this.copyTransformed(e=>e.copy())}copyTransformed(e){return new Dn(P(this),this.children.map(e))}withAttribs(e){return new Dn(e,this.children)}equiv(e){return e instanceof Dn&&Re(this.children,e.children)}toHiccup(){return["g",this.attribs,...this.children.map(e=>e.toHiccup())]}}class Hn extends Qt{get type(){return"line"}copy(){return Wt(Hn,this)}withAttribs(e){return new Hn(this.points,e)}toHiccup(){return["line",this.attribs,this.points[0],this.points[1]]}toHiccupPathSegments(){const[e,n]=this.points;return[e[0]===n[0]?["V",n[1]]:e[1]===n[1]?["H",n[0]]:["L",n]]}}const yd=as(()=>"illegal state"),bd=t=>{throw new yd(t)};class xn{constructor(e=[],n){this.segments=e,this.attribs=n,this.closed=!1}get type(){return"path"}*[Symbol.iterator](){yield*this.segments}copy(){const e=new xn(this.segments.map(n=>{const s={type:n.type};return n.point&&(s.point=Mn(n.point)),n.geo&&(s.geo=n.geo.copy()),s}),P(this));return e.closed=this.closed,e}withAttribs(e){const n=new xn(this.segments,e);return n.closed=!0,n}equiv(e){return e instanceof xn&&Re(this.segments,e.segments)}add(e){this.closed&&bd("path already closed"),this.segments.push(e)}toHiccup(){let e=[];const n=this.segments,s=n.length;if(s>1){for(let i=0;i<s;i++){const r=n[i];r.geo?e=e.concat(r.geo.toHiccupPathSegments()):r.point&&e.push(["M",r.point])}this.closed&&e.push(["Z"])}return["path",this.attribs||{},e]}}class qe extends Qt{get type(){return"points"}copy(){return Wt(qe,this)}withAttribs(e){return new qe(this.points,e)}toHiccup(){return["points",this.attribs,this.points]}}class Xs extends Qt{get type(){return"points3"}copy(){return Wt(Xs,this)}withAttribs(e){return new Xs(this.points,e)}toHiccup(){return["points3",this.attribs,this.points]}}class _e extends Qt{get type(){return"poly"}copy(){return Wt(_e,this)}withAttribs(e){return new _e(this.points,e)}toHiccup(){return["polygon",this.attribs,this.points]}}class Ve extends Qt{get type(){return"polyline"}copy(){return Wt(Ve,this)}withAttribs(e){return new Ve(this.points,e)}toHiccup(){return["polyline",{...this.attribs,fill:"none"},this.points]}toHiccupPathSegments(){const e=[];for(let n=this.points,s=n.length,i=1;i<s;i++)e.push(["L",n[i]]);return e}}class Ws extends Qt{get type(){return"quad"}copy(){return Wt(Ws,this)}withAttribs(e){return new Ws(this.points,e)}toHiccup(){return["polygon",this.attribs,this.points]}}class Qs extends Qt{get type(){return"quadratic"}copy(){return Wt(Qs,this)}withAttribs(e){return new Qs(this.points,e)}toHiccup(){return["path",this.attribs,[["M",this.points[0]],...this.toHiccupPathSegments()]]}toHiccupPathSegments(){const e=this.points;return[["Q",e[1],e[2]]]}}class Zs{constructor(e,n,s){this.pos=e,this.dir=n,this.attribs=s}get type(){return"ray"}copy(){return new Zs(J([],this.pos),J([],this.dir),P(this))}withAttribs(e){return new Zs(this.pos,this.dir,e)}toHiccup(){return["line",this.attribs,this.pos,dd([],this.dir,1e6,this.pos)]}}class yt{constructor(e=[0,0],n=1,s){this.pos=e,this.attribs=s,this.size=vt(n)}get type(){return"rect"}copy(){return new yt(ke([],this.pos),ke([],this.size),P(this))}withAttribs(e){return new yt(this.pos,this.size,e)}max(){return Gi([],this.pos,this.size)}offset(e){return qr(null,this.pos,e),Vc(null,Fc(null,this.size,e*2),vo),this}toHiccup(){return["rect",this.attribs,this.pos,this.size[0],this.size[1]]}}class Js{constructor(e=[0,0,0],n=1,s){this.pos=e,this.r=n,this.attribs=s}get type(){return"sphere"}copy(){return new Js(kr([],this.pos),this.r,P(this))}withAttribs(e){return new Js(this.pos,this.r,e)}toHiccup(){return["sphere",this.attribs,this.pos,this.r]}}class Ks{constructor(e,n,s){this.pos=e,this.body=n,this.attribs=s}get type(){return"text"}copy(){return new Ks(J([],this.pos),this.body,P(this))}withAttribs(e){return new Ks(this.pos,this.body,e)}toHiccup(){return["text",this.attribs,this.pos,this.body]}}class ti extends Qt{get type(){return"tri"}copy(){return Wt(ti,this)}withAttribs(e){return new ti(this.points,e)}toHiccup(){return["polygon",this.attribs,this.points]}}const[Yn,Ad,CA,zA]=xt(Gc("Math.min")),[Xn,Wc,wd,BA]=Io("-"),_d=(t,e,n)=>new qn(t,wd([],e,t),n),Sd=(t,e,n,s)=>_d(t,e,s).offset(n),Rd=(t,e,n,s)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=s,t),et=(t,e,n,s,i)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=s,t[3]=i,t),Id=(t,...e)=>{!t&&(t=[]);for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t},Ed=(t,e)=>t[0]*e[1]-t[1]*e[0],Mo=t=>Oo.add(t,tn(t,Tc,"a,b",void 0,"","+","return ",";")),Oo=Xt();Oo.default(xi(B1,"a,b",void 0,"s","let s=0;"));Mo(2);Mo(3);Mo(4);const Do=t=>Ci.add(t,tn(t,([e])=>`${e}*${e}`,"a","a","","+","return ",";")),Ci=Xt();Ci.default(xi(([t])=>`sum+=${t}*${t};`,"a",void 0,"sum","let sum=0;"));const vd=Do(2);Do(3);Do(4);const jr=t=>Math.sqrt(Ci(t)),$d=Math.abs,Qc=(t,e,n=mt)=>$d(t-e)<=n,xo=t=>Wn.add(t,Lc(t,[Qc,mt],([e,n])=>`eq(${e},${n},eps)`,"eq,_eps","a,b,eps=_eps","a,b","","&&","return a.length === b.length && ",";")),Wn=Xt();Wn.default((t,e,n=mt)=>ht(t,"eqDelta")?t.eqDelta(e,n):ht(e,"eqDelta")?e.eqDelta(t,n):Md(t,e,t.length,n));const Nd=xo(2);xo(3);xo(4);const Md=(t,e,n,s=mt,i=0,r=0,o=1,a=1)=>{for(;n>0;n--,i+=o,r+=a)if(!Qc(t[i],e[r],s))return!1;return!0},Od=(t,e,n=mt)=>{for(let s=e.length;s-- >0;)if(Wn(t,e[s],n))return!0;return!1};function*Dd(t,e,n,s,i,r){for(;n-- >0;)yield new t(e,s,i),s+=r}function*xd(t,e,n,s){for(;e-- >0;)yield t[n],n+=s}const Gd=(t,e,n,s=!0,i=!0)=>{const r=n>0?s?function(){return this.buf[this.offset+n*this.stride]}:function(){return this.buf[this.offset+n]}:function(){return this.buf[this.offset]},o=n>0?s?function(a){this.buf[this.offset+n*this.stride]=a}:function(a){this.buf[this.offset+n]=a}:function(a){this.buf[this.offset]=a};i&&Object.defineProperty(t,n,{get:r,set:o,enumerable:!0}),Object.defineProperty(t,e,{get:r,set:o,enumerable:!0})},Td=(t,e,n,s)=>e.forEach((i,r)=>Gd(t,i,r,n,s)),Go=os((t,e=!1)=>e?n=>Zc(n)||n.toFixed(t):n=>n.toFixed(t)),Cd=os((t,e=3)=>{const n=t-e-1,s=Math.pow(10,n),i=-Math.pow(10,n-1),r=Math.pow(10,-(e-1)),o=$i(t);return a=>{const l=Math.abs(a);return o(Zc(a)||(a===0?"0":l<r||l>=s?zd(a,t):a.toFixed(e-(a<i?1:0))))}}),zd=(t,e)=>t.toExponential(Math.max(e-4-(Math.log(Math.abs(t))/Math.LN10>=10?2:1)-(t<0?1:0),0)),Zc=t=>isNaN(t)?"NaN":t===1/0?"+\u221E":t===-1/0?"-\u221E":void 0,Bd=t=>{const{prec:e,width:n,delim:s,wrap:i}={prec:3,delim:", ",wrap:"[]",...t},r=n?Cd(n,e):Go(e);return o=>{let a=[];for(let l of o)a.push(r(l));return`${i[0]}${a.join(s)}${i[1]}`}};let Ld=Bd();class Pd{constructor(e,n=0,s=1){this.buf=e,this.offset=n,this.stride=s}toString(){return Ld(this)}}var Y;(function(t){t[t.I8=5120]="I8",t[t.U8=5121]="U8",t[t.I16=5122]="I16",t[t.U16=5123]="U16",t[t.I32=5124]="I32",t[t.U32=5125]="U32",t[t.F32=5126]="F32"})(Y||(Y={}));const Fd={[Y.I8]:"i8",[Y.U8]:"u8",[Y.I16]:"i16",[Y.U16]:"u16",[Y.I32]:"i32",[Y.U32]:"u32",[Y.F32]:"f32"};Y.I8,Y.U8,Y.U8,Y.I16,Y.U16,Y.I32,Y.U32,Y.F32;const Ud={f32:Float32Array,f64:Float64Array},kd={i8:Int8Array,i16:Int16Array,i32:Int32Array},qd={u8:Uint8Array,u8c:Uint8ClampedArray,u16:Uint16Array,u32:Uint32Array},Vd={i64:BigInt64Array,u64:BigUint64Array},jd={...Ud,...kd,...qd},Hd=t=>{const e=Fd[t];return e!==void 0?e:t};function Hr(t,...e){const n=Vd[t];return new(n||jd[Hd(t)])(...e)}const Yd=t=>t>16?"u32":t>8?"u16":"u8",Xd=(t,e,n,s,i,r)=>{const o=[];for(;n-- >0;)o.push(new t(e,s,i)),s+=r;return o},Wd=(t,e,n,s,i,r)=>{for(let o of n)t(e,o,s,0,i,1),s+=r;return e},zi=new Float64Array(1),Qd=new Float32Array(zi.buffer);new Int32Array(zi.buffer);const Jc=new Uint32Array(zi.buffer);zi[0]=2,Jc[1];const Zd=t=>(Qd[0]=t,Jc[0]),Ha=(t,e)=>(t<<e|t>>>32-e)>>>0,Ts=Math.imul,Jd=(t,e=2654435761)=>{let n=-1;for(let s=t.length;s-- >0;)n=Ts(e,n)+nh(n,Zd(t[s]))>>>0;return n},Kd=3432918353,th=461845907,eh=3864292196,nh=(t,e)=>(e=Ts(Ha(Ts(e,Kd)>>>0,15),th)>>>0,(Ts(Ha(t^e,13),5)>>>0)+eh>>>0),[LA,sh,PA,FA]=Y1(Cc,"o,a",Oc,"o,a","o",Dc);class B extends Pd{static mapBuffer(e,n=e.length>>1,s=0,i=1,r=2){return Xd(B,e,n,s,i,r)}static intoBuffer(e,n,s=0,i=1,r=2){return Wd(sh,e,n,s,i,r)}static iterator(e,n,s=0,i=1,r=2){return Dd(B,e,n,s,i,r)}constructor(e,n=0,s=1){super(e||[0,0],n,s)}[Symbol.iterator](){return xd(this.buf,2,this.offset,this.stride)}get length(){return 2}copy(){return new B([this.x,this.y])}copyView(){return new B(this.buf,this.offset,this.stride)}empty(){return new B}eqDelta(e,n=mt){return Nd(this,e,n)}hash(){return Jd(this)}toJSON(){return[this.x,this.y]}}B.X_AXIS=new B(Q1);B.Y_AXIS=new B(Z1);B.MIN=new B(Uc);B.MAX=new B(kc);B.ZERO=new B(vo);B.ONE=new B(W1);Td(B.prototype,["x","y"]);const ih=(t=0,e=0)=>new B([t,e]),To=(t,e,n=1)=>{!t&&(t=e);const s=jr(e);return s>=mt?Ti(t,e,n/s):t!==e?J(t,e):t},rh=(t,e,n=1)=>{!t&&(t=e);const s=Math.sqrt(vd(e));return s>=mt?Hs(t,e,n/s):t!==e?ke(t,e):t},[ei,UA,kA,qA]=xt(F1,M1),Ya=Math.cos,Xa=Math.sin,Kc=Xt(1),oh=Kc.add(2,(t,e,n=vo)=>Gi(t||e,No(e[1],e[0]),n));Kc.add(3,(t,e,n=qc)=>{const s=e[0],i=e[1],r=e[2],o=Ya(i);return Rd(t||e,s*o*Ya(r)+n[0],s*o*Xa(r)+n[1],s*Xa(i)+n[2])});const ah=(t,e=mt)=>t>e?1:t<-e?-1:0,Gn=(t,e,n)=>{const s=t[0],i=t[1];return(e[0]-s)*(n[1]-i)-(n[0]-s)*(e[1]-i)},lh=(t,e,n,s=mt)=>ah(Gn(t,e,n),s),ch=(t,e,n,s=mt)=>lh(t,e,n,s)<0,t0=([t,e])=>`t=${t}-${e};s+=t*t;`,e0="let t,s=0;",Co=t=>Ie.add(t,tn(t,t0,"a,b",void 0,"s","",e0)),Ie=Xt();Ie.default(xi(t0,"a,b",void 0,"s",e0));Co(2);Co(3);Co(4);const uh=(t,e)=>Math.sqrt(Ie(t,e)),zo=t=>tn(t,Tc,`o,a,${Oc}`,"o,a","","+","return ",";",!0);zo(2);const Ce=zo(3);zo(4);xt(L1,"a,n","a","a",0,"");const fh=t=>new Array(t).fill(0),dh=t=>ht(t,"empty")?t.empty():fh(t.length),ni=(t,e)=>t-e*Math.floor(t/e),Q=t=>t-Math.floor(t),Wa=(t,e=1)=>Math.round(t/e)*e,Qa=1/2**32;class n0{float(e=1){return this.int()*Qa*e}norm(e=1){return(this.int()*Qa-.5)*2*e}minmax(e,n){return this.float()*(n-e)+e}minmaxInt(e,n){return e|=0,n|=0,e+(this.float()*(n-e)|0)}}const or=Math.random;class hh extends n0{int(){return or()*4294967296>>>0}float(e=1){return or()*e}norm(e=1){return(or()-.5)*2*e}}const en=new hh,mh=(t=en,e=0,n=1)=>{let s,i,r;return()=>{if(s!=null)i=s,s=null;else do s=t.norm(),i=t.norm(),r=s*s+i*i;while(r>1||r===0);return e+n*i*Math.sqrt(-2*Math.log(r)/r)}};Ro(en,([t])=>`${t}=rnd.minmax(n,m);`,"a,n=-1,m=1,rnd=op","a","a",0,xc);Ro(mh,([t])=>`${t}=rnd()*n;`,"a,rnd=op(),n=1","a","a",0,xc);const[gh,ms,VA,jA]=Ro(en,([t,e,n])=>`${t}=rnd.minmax(${e},${n});`,"o,a,b,rnd=op","o,a,b"),[HA,ph,YA,XA]=xt(T1("*","+"),Mc),Ae=(t,e,n)=>t+(e-t)*n,s0=(t,e,n,s,i,r)=>{const o=1-i,a=1-r;return t*o*a+e*i*a+n*o*r+s*i*r},yh=(t,e,n,s,i)=>{const r=i*i,o=1-i,a=o*o;return t*a*o+e*3*a*i+n*3*r*o+s*r*i},mn=(t,e,n,s,i)=>{s*=.5;const r=-.5*t+1.5*e-1.5*n+s,o=t-2.5*e+2*n-s,a=-.5*t+.5*n,l=e,u=i*i;return i*u*r+u*o+i*a+l},i0=(t,e,n,s,i,r,o,a,l,u,c,m,h,b,A,N,E,D)=>mn(mn(t,e,n,s,E),mn(i,r,o,a,E),mn(l,u,c,m,E),mn(h,b,A,N,E),D),bh=(t,e,n,s,i)=>{const r=1-i;return md(t,e,n,s,r*r,2*r*i,i*i)},[Ah,WA,QA,ZA]=xt(P1,Mc);function K(...t){return new Vn(...nd(t))}const wh=(t,e)=>{const n=$o(e);return new t(e.length===1?e[0]:e,n)},si=(t={},e)=>new Dn(t,e);function _h(...t){return wh(Hn,t)}var Yr;(function(t){t[t.FINE=0]="FINE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.SEVERE=4]="SEVERE",t[t.NONE=5]="NONE"})(Yr||(Yr={}));const Sh=Object.freeze({level:Yr.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});let Rh=Sh;const se=Symbol();function nn(t,e,n){const s={},i=e?Ih(e):{},r=(...o)=>{const a=t(...o),l=s[a]||Cs(s,i,a)||s[se];return l?l(...o):cs(`missing implementation for: "${a.toString()}"`)};return r.add=(o,a)=>(s[o]&&Rh.warn(`overwriting '${o.toString()}' impl`),s[o]=a,!0),r.addAll=o=>{let a=!0;for(let l in o)a=r.add(l,o[l])&&a;return se in o&&r.setDefault(o[se]),a},r.setDefault=o=>r.add(se,o),r.remove=o=>s[o]?(delete s[o],!0):!1,r.callable=(...o)=>{const a=t(...o);return!!(s[a]||Cs(s,i,a)||s[se])},r.isa=(o,a)=>{let l=i[o];!l&&(i[o]=l=new Set),l.add(a)},r.impls=()=>{const o=new Set(Object.keys(s));for(let a in i)Cs(s,i,a)&&o.add(a);return s[se]&&o.add(se),o},r.rels=()=>i,r.parents=o=>i[o],r.ancestors=o=>new Set(r0([],i,o)),r.dependencies=function*(){for(let o in i)for(let a of i[o])yield[o,a];for(let o in s)!i[o]&&(yield[o,void 0])},n&&r.addAll(n),r}const Cs=(t,e,n)=>{const s=e[n];if(!!s)for(let i of s){let r=t[i]||Cs(t,e,i);if(r)return r}},r0=(t,e,n)=>{const s=e[n];if(s)for(let i of s)t.push(i),r0(t,e,i);return t},Ih=t=>{const e={};for(let n in t){const s=t[n];e[n]=s instanceof Set?s:Array.isArray(s)?new Set(s):new Set([s])}return e},sn=t=>t.type,ue=Array.isArray;let $t=20;const Bo=(t,e,n)=>{const s=Xn([],n,e),i=Ci(s);return i>1e-6?Oo(Xn([],t,e),s)/i:void 0},o0=(t,e,n,s,i=!1,r=0)=>{const o=Bo(t,e,n);if(o!==void 0&&(!i||o>=r&&o<=1-r))return s=s||dh(t),o<=0?J(s,e):o>=1?J(s,n):ei(s,e,n,o)},Eh=(t,e,n=!1,s=[])=>{if(!e.length)return;const i=[],r=e.length-1;let o=1/0,a,l;for(n?(a=r,l=0):(a=0,l=1);l<=r;a=l,l++)if(o0(t,e[a],e[l],i)){const u=Ie(t,i);u<o&&(o=u,J(s,i))}return o<1/0?s:void 0};class Lo{constructor(e,n=!1){n?(this.points=e.slice(),this.points.push(e[0])):this.points=e,this.buildIndex()}totalLength(){const e=this.index;return e?e[e.length-1]:0}pointAt(e){const n=this.points,s=n.length-1;if(s<0)return;if(s===0||e<=0)return n[0];if(e>=1)return n[s];const i=this.index,r=e*i[s];for(let o=1;o<=s;o++)if(i[o]>=r)return ei([],n[o-1],n[o],(r-i[o-1])/(i[o]-i[o-1]))}closestPoint(e){return Eh(e,this.points)}closestT(e){const{index:n,points:s}=this,i=[],r=[];let o=1/0,a=-1;for(let l=0,u=n.length-1;l<u;l++)if(o0(e,s[l],s[l+1],i)){const c=Ie(e,i);c<o&&(o=c,a=l,J(r,i))}return a>=0?Vr(Bo(e,s[a],s[a+1])||0,n[a],n[a+1])/this.totalLength():void 0}segmentAt(e){let n=this.indexAt(e);if(n!==void 0)return n=Math.max(1,n),[this.points[n-1],this.points[n]]}tangentAt(e,n=1){const s=this.segmentAt(e);return s?To(null,Xn([],s[1],s[0]),n):void 0}splitAt(e){if(e<=0||e>=1)return[this.points];const n=this.pointAt(e);if(!n)return;const s=Math.max(1,this.indexAt(e)),i=this.points.slice(0,s),r=this.points.slice(s);return Wn(i[s-1],n)||i.push(n),Wn(r[0],n)||r.unshift(n),[i,r]}splitNear(e){const n=this.closestT(e);return n!==void 0?this.splitAt(n):void 0}indexAt(e){const s=this.points.length-1;if(s<0)return;if(s===0||e<=0)return 0;if(e>=1)return s;const i=this.index,r=e*i[s];for(let o=1;o<=s;o++)if(i[o]>=r)return o}sampleUniform(e,n=!1,s=[]){const{index:i,points:r}=this,o=this.totalLength(),a=e/o,l=i.length;for(let u=0,c=1;u<1;u+=a){const m=u*o;for(;m>=i[c]&&c<l;)c++;if(c>=l)break;const h=i[c-1];s.push(ei([],r[c-1],r[c],(m-h)/(i[c]-h)))}return n&&s.push(J([],r[r.length-1])),s}sampleFixedNum(e,n=!1,s){return this.sampleUniform(this.totalLength()/e,n,s)}buildIndex(){const e=[0],n=this.points,s=n.length;for(let i=0,r=1;r<s;i=r,r++)e[r]=e[i]+uh(n[i],n[r]);this.index=e}}const a0=(t,e,n,s,i,r)=>{if(Dt(r)&&r.dist!==void 0)return new Lo(a0(t,e,n,s,i,r.num||$t)).sampleUniform(r.dist,r.last!==!1);r=H(r)?{num:r,last:!0}:{num:$t,...r};let o=i-s,a=r.theta?Math.round(o/r.theta):r.num;o/=a,r.last!==!1&&a++;const l=new Array(a);for(let u=0;u<a;u++)l[u]=Xc(t,e,n,s+u*o);return l},Za=(t,e,n=!1,s=!1)=>{if(vh(e)){const i=new Lo(t,n);return Dt(e)?n?e.dist?i.sampleUniform(e.dist,e.last):i.sampleFixedNum(e.num||$t,e.last):e.dist?i.sampleUniform(e.dist,e.last!==!1):i.sampleFixedNum(e.num||$t,e.last!==!1):i.sampleFixedNum(e||$t,!n)}return s?jc(t):t},vh=t=>t!==void 0&&(H(t)||t.dist!=null||t.last!=null||t.num!=null),l0=t=>function e(n,s){if(Dt(s)&&s.dist!==void 0)return new Lo(e(n,s.num||$t)).sampleUniform(s.dist,s.last!==!1);s=H(s)?{num:s,last:!0}:{num:$t,...s};const i=[];return t(i,n,s.num),s.last&&i.push(J([],n[n.length-1])),i},c0=t=>(e,n=!1,s)=>{const i=H(s)?{num:s}:s,r=e.length-1;return Array.prototype.concat.apply([],e.map((o,a)=>t(o,{...i,last:!n&&a===r})))},u0=l0((t,[e,n,s,i],r)=>{const o=1/r;for(let a=0;a<r;a++)t.push(pd([],e,n,s,i,a*o))});c0(u0);const f0=l0((t,[e,n,s],i)=>{const r=1/i;for(let o=0;o<i;o++)t.push(bh([],e,n,s,o*r))});c0(f0);const zs=nn(sn,{line:"polyline",bpatch:"points",points3:"points",quad:"poly",tri:"poly"},{aabb:({pos:t,size:e})=>{const[n,s,i]=t,[r,o,a]=Pc([],t,e);return[[n,s,i],[n,s,a],[r,s,a],[r,s,i],[n,o,i],[n,o,a],[r,o,a],[r,o,i]]},arc:(t,e)=>a0(t.pos,t.r,t.axis,t.start,t.end,e),circle:(t,e=$t)=>{const n=t.pos,s=t.r;let[i,r]=Ja(e,s);const o=k/i;r&&i++;const a=new Array(i);for(let l=0;l<i;l++)a[l]=oh(null,[s,l*o],n);return a},cubic:(t,e)=>u0(t.points,e),ellipse:(t,e=$t)=>{const n=[],s=t.pos,i=t.r;let[r,o]=Ja(e,Math.max(t.r[0],t.r[1]));const a=k/r;o&&r++;for(let l=0;l<r;l++)n[l]=ph([],No(l*a),i,s);return n},group:({children:t})=>t.reduce((e,n)=>e.concat(zs(n)),[]),path:(t,e)=>{const n=H(e)?{num:e}:e;let s=[];for(let i=t.segments,r=i.length-1,o=0;o<=r;o++){const a=i[o];a.geo&&(s=s.concat(zs(a.geo,{...n,last:o===r&&!t.closed})))}return s},points:t=>t.points,poly:(t,e)=>Za(t.points,e,!0),polyline:(t,e)=>Za(t.points,e),quadratic:(t,e)=>f0(t.points,e),rect:(t,e)=>{const n=t.pos,s=Gi([],n,t.size),i=[ke([],n),[s[0],n[1]],s,[n[0],s[1]]];return e!=null?zs(new _e(i),e):i}}),Ja=(t,e)=>H(t)?[t,!1]:[t.theta?Math.floor(k/t.theta):t.dist?Math.floor(k/(t.dist/e)):t.num||$t,t.last===!0],$h=nn(sn,{circle:"points",ellipse:"points",line:"points",path:"points",poly:"points",polyline:"points",quad:"points",rect:"points",tri:"points"},{points:(t,e)=>new _e(zs(t,e),P(t))}),Nh=t=>t[t.length-1],Mh=(t,e)=>new _e(t,e),Oh=as(()=>"illegal argument(s)"),je=t=>{throw new Oh(t)};function ii(...t){return new yt(...ed(t))}const v=(t,e,n)=>new yt(t,Wc([],e,t),n),gn=(t,e,n,s)=>v(t,e,s).offset(n),Dh=t=>t instanceof Set,xh=t=>Dh(t)?t:new Set(t),Gh=(t,e)=>{const n=xh(e),s={};for(let i in t)t.hasOwnProperty(i)&&!n.has(i)&&(s[i]=t[i]);return s},Th=(t,e)=>t.map(H(e)?n=>Ti([],n,e):n=>cd([],n,e)),zt=t=>(e,n)=>new t(Th(e.points,n),P(e)),Tn=nn(sn,{},{aabb:(t,e)=>(e=vt(e,3),new qn(ja([],t.pos,e),ja([],t.size,e),P(t))),arc:(t,e)=>{e=vt(e);const n=t.copy();return rt(null,n.pos,e),rt(null,n.r,e),n},circle:(t,e)=>H(e)?new Vn(Hs([],t.pos,e),t.r*e,P(t)):new jn(rt([],t.pos,e),Hs([],e,t.r),P(t)),cubic:zt(Ys),ellipse:(t,e)=>(e=vt(e),new jn(rt([],t.pos,e),rt([],t.r,e),P(t))),group:(t,e)=>t.copyTransformed(n=>Tn(n,e)),line:zt(Hn),path:(t,e)=>(e=vt(e),new xn(t.segments.map(n=>n.geo?{type:n.type,geo:Tn(n.geo,e)}:{type:n.type,point:rt([],n.point,e)}),P(t))),points:zt(qe),points3:zt(Xs),poly:zt(_e),polyline:zt(Ve),quad:zt(Ws),quadratic:zt(Qs),ray:(t,e)=>(e=vt(e),new Zs(rt([],t.pos,e),rh(null,rt([],t.dir,e)),P(t))),rect:(t,e)=>(e=vt(e),new yt(rt([],t.pos,e),rt([],t.size,e),P(t))),sphere:(t,e)=>H(e)?new Js(hd([],t.pos,e),t.r*e,P(t)):cs("can't non-uniformly scale sphere"),text:(t,e)=>new Ks(rt([],t.pos,vt(e)),t.body,P(t)),tri:zt(ti)}),Ch=t=>{const e=t.length-1;if(e<2)return 0;let n=0,s=t[e],i=t[0];for(let r=0;r<=e;s=i,i=t[++r])n+=Ed(s,i);return n/2},Xr=nn(sn,{quad:"poly"},{aabb:({size:[t,e,n]})=>2*(t*e+t*n+e*n),arc:t=>.5*Math.abs(t.start-t.end)*t.r[0]*t.r[1],circle:t=>z*t.r**2,ellipse:t=>z*t.r[0]*t.r[1],group:({children:t})=>t.reduce((e,n)=>e+Xr(n,!1),0),path:t=>t.closed?Xr($h(t)):0,plane:()=>1/0,poly:(t,e)=>{const n=Ch(t.points);return e?n:Math.abs(n)},rect:t=>t.size[0]*t.size[1],sphere:t=>4*z*t.r**2,tri:(t,e)=>{const n=.5*Gn(...t.points);return e?n:Math.abs(n)},[se]:()=>0}),ar={},zh=(t,e,n,s)=>{const i=ar[n];At(!!i,`no conversions available for ${n}`);let r=i[s];return r?r(t,e):ar.rgb[s]?i.rgb(t,ar.rgb[s]([],e)):cs(`can't convert: ${s} -> ${n}`)},d0=(t=0)=>e=>(e*100).toFixed(t)+"%";Object.freeze([0,0,0,1]);Object.freeze([1,1,1,1]);Object.freeze([1,0,0,1]);Object.freeze([0,1,0,1]);Object.freeze([0,0,1,1]);Object.freeze([0,1,1,1]);Object.freeze([1,0,1,1]);Object.freeze([1,1,0,1]);const Bh=[3.1338561,-.9787684,.0719453,-1.6168667,1.9161415,-.2289914,-.4906146,.033454,1.4052427],Lh=[3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252],Ph=[.96422,1,.82521],Fh=[.95047,1,1.08883];let ri=Go(3),Ka=d0(3);const Uh=1/255,Ee=(t,e=1)=>t!=null?F(t):e,h0=t=>{const e=ri(Q(t[0])*360),n=Ka(F(t[1])),s=Ka(F(t[2])),i=Ee(t[3]);return i<1?`hsla(${e},${n},${s},${ri(i)})`:`hsl(${e},${n},${s})`},kh=(t,e,n=1)=>et(t||e,Q(e[0]),F(e[1]),F(e[2]),Ee(e[3],n)),qh=(t,e)=>{t=kh(t||e,e);const n=t[1],s=t[2],i=(2-n)*s/2;return t[2]=i,t[1]=i&&i<1?n*s/(i<.5?i*2:2-i*2):n,t},Vh=t=>h0(qh([],t)),tl="0123456789abcdef",Wr=t=>tl[t>>>4&15]+tl[t&15],jh=t=>Wr(t>>>8)+Wr(t&255),Hh=t=>Wr(t>>>16)+jh(t);const Po=os((t,e,n="")=>{const s=_c("0",e);return i=>(i=(i>>>0).toString(t),n+(i.length<e?s.substring(i.length)+i:i))});Po(2,8);Po(2,16);Po(2,32);const Bi=Hh,Qr=t=>{const e=t>>>24;return e<255?`rgba(${t>>16&255},${t>>8&255},${t&255},${ri(e*Uh)})`:`#${Bi(t&16777215)}`},Zr=t=>(t&255)<<16|t>>16&255|t&4278255360,Yh=Zr,Xh=(t,e)=>{let{1:n,2:s}=e;s*=k;const i=Ee(e[3]);return n>0?et(t||e,e[0],Math.cos(s)*n,Math.sin(s)*n,i):et(t||e,e[0],0,0,i)},lr=t=>{const e=t**3;return e>.008856?e:(t-16/116)/7.787},m0=(t,e,n=Ph)=>{const s=(e[0]+.16)/1.16;return et(t||e,lr(e[1]/5+s)*n[0],lr(s)*n[1],lr(s-e[2]/2)*n[2],Ee(e[3]))},Wh=(t,e)=>m0(t,e,Fh),Qh=(t,e,n,s=!1)=>{const i=Ce(e,n,0,0,3),r=Ce(e,n,1,0,3),o=Ce(e,n,2,0,3),a=Ee(n[3]);return s?et(t||n,F(i),F(r),F(o),a):et(t||n,i,r,o,a)},g0=(t,e,n=Bh)=>Qh(t,n,e),Zh=(t,e)=>g0(t,e,Lh),el=(t,e)=>g0(null,m0(t,e)),Jh=(t,e)=>Zh(null,Wh(t,e)),cr=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Bs=(t,e)=>et(t||e,cr(e[0]),cr(e[1]),cr(e[2]),Ee(e[3])),ur=(t,e=0)=>(t<0?0:t>1?1:t)*255+.5<<e,xe=t=>{const e=ur(t[0]),n=ur(t[1]),s=ur(t[2]),i=Ee(t[3]);return i<1?`rgba(${e},${n},${s},${ri(i)})`:`#${Bi(e<<16|n<<8|s)}`},Kh=t=>xe(Bs([],t)),nl={abgr32:t=>Qr(Yh(t[0])),argb32:t=>Qr(t[0]),hsl:h0,hsv:Vh,lab50:t=>xe(Bs(null,el([],t))),lab65:t=>xe(Bs(null,Jh([],t))),lch:t=>xe(Bs(null,el(null,Xh([],t)))),rgb:Kh,srgb:xe},tm=t=>{let e;return j(t)?t:H(t)?Qr(t):t.mode?(e=nl[t.mode])?e(t):nl.rgb(zh([],t,"rgb",t.mode)):xe(t)};let em=3;const _=t=>t===(t|0)?t:t.toFixed(em),p0=t=>_(t[0])+","+_(t[1]),Fo=(t,e=" ")=>t?t.map(p0).join(e):"",nm=["font-size","opacity","stroke-width","stroke-miterlimit"],sm=(t,e)=>{let n;for(let s of nm.concat(e))typeof(n=t[s])=="number"&&(t[s]=_(n));return t},nt=(t,...e)=>{if(!t)return;const n=im(t);let s;return(s=t.fill)&&(n.fill=Jr(s)),(s=t.stroke)&&(n.stroke=Jr(s)),sm(t,e)},im=t=>{let e;return((e=t.transform)||t.translate||t.scale||t.rotate)&&(e?(t.transform=j(e)?e:`matrix(${[...e].map(_).join(" ")})`,delete t.translate,delete t.rotate,delete t.scale):t.transform=rm(t)),t},rm=t=>{const e=[];let n;return(n=t.translate)&&(e.push(j(n)?n:`translate(${_(n[0])} ${_(n[1])})`),delete t.translate),(n=t.rotate)&&(e.push(j(n)?n:`rotate(${_(n*180/Math.PI)})`),delete t.rotate),(n=t.scale)&&(e.push(j(n)?n:_o(n)?`scale(${_(n[0])} ${_(n[1])})`:`scale(${_(n)})`),delete t.scale),e.join(" ")},Jr=t=>j(t)?t[0]==="$"?`url(#${t.substring(1)})`:t:tm(t),y0=(t,e)=>{const n={};for(let s in t)t.hasOwnProperty(s)&&!e.has(s)&&(n[s]=t[s]);return n},om=(t,e,n,...s)=>["circle",nt({...n,cx:_(t[0]),cy:_(t[1]),r:_(e)}),...s],am=(t,e,n,s,...i)=>["ellipse",nt({...s,cx:_(t[0]),cy:_(t[1]),rx:_(e),ry:_(n)}),...i],lm=/(rgb|hsl)a\(([a-z0-9.-]+),([0-9.%]+),([0-9.%]+),([0-9.]+)\)/,b0=(t,e,n)=>[t,nt(e),...n.map(cm)],cm=([t,e])=>{e=Jr(e);let n;const s=lm.exec(e);return s&&(e=`${s[1]}(${s[2]},${s[3]},${s[4]})`,n=s[5]),["stop",{offset:t,"stop-color":e,"stop-opacity":n}]},um=(t,e,n,s,i)=>b0("linearGradient",{...i,id:t,x1:_(e[0]),y1:_(e[1]),x2:_(n[0]),y2:_(n[1])},s),fm=(t,e,n,s,i,r,o)=>b0("radialGradient",{...o,id:t,fx:_(e[0]),fy:_(e[1]),cx:_(n[0]),cy:_(n[1]),fr:_(s),r:_(i)},r),dm=(t,e,n,...s)=>["image",nt({...n,"xlink:href":e,x:_(t[0]),y:_(t[1])}),...s],Uo=(t,e,n,...s)=>["line",nt({...n,x1:_(t[0]),y1:_(t[1]),x2:_(e[0]),y2:_(e[1])}),...s],hm=(t,e)=>Uo([-1e6,t],[1e6,t],e),mm=(t,e)=>Uo([t,-1e6],[t,1e6],e),gm=180/Math.PI,pm=(t,e,...n)=>{let s=[];for(let i of t)switch(s.push(i[0]),i[0].toLowerCase()){case"a":s.push([_(i[1]),_(i[2]),_(i[3]*gm),i[4]?1:0,i[5]?1:0,_(i[6][0]),_(i[6][1])].join(","));break;case"h":case"v":s.push(_(i[1]));break;case"m":case"l":s.push(p0(i[1]));break;case"z":break;default:s.push(Fo(i.slice(1),","))}return["path",nt({...e,d:s.join("")}),...n]},ym=(t,e,n=1,s,...i)=>{const r=["g",nt(y0(s,new Set(["shape","size"]))),...i],o=A0(r,e,n);for(let a of t)r.push(["use",{"xlink:href":o,x:_(a[0]),y:_(a[1])}]);return r},bm=(t,e,n=1,s,...i)=>{s={start:0,cstride:1,estride:2,...s};const{start:r,cstride:o,estride:a}=s;let l=s&&s.num!=null?s.num:(t.length-r)/a|0;const u=["g",nt(y0(s,new Set(["start","cstride","estride","shape","size","num"]))),...i],c=A0(u,e,n);for(let m=r;l-- >0;m+=a)u.push(["use",{"xlink:href":c,x:_(t[m]),y:_(t[m+o])}]);return u},A0=(t,e,n)=>{let s;return!e||e[0]!=="#"?(s="_"+(Math.random()*1e6|0).toString(36),t.push(["g",{opacity:0},Am(e,s,n)]),s="#"+s):s=e,s},Am=(t,e,n)=>{const s=_(n);if(t==="circle")return["circle",{id:e,cx:0,cy:0,r:s}];const i=_(-n/2);return["rect",{id:e,x:i,y:i,width:s,height:s}]},wm=(t,e,...n)=>["polygon",nt({...e,points:Fo(t)}),...n],_m=(t,e,...n)=>["polyline",nt({fill:"none",points:Fo(t),...e}),...n],Sm=(t,e,n,s,i,r,...o)=>(r=nt({...r,x:_(t[0]),y:_(t[1]),width:_(e),height:_(n)}),(s>0||i>0)&&(r.rx=_(s),r.ry=_(i)),["rect",r,...o]),Rm=(t,e,n,...s)=>["text",nt({...n,x:_(t[0]),y:_(t[1])}),e,...s],Im={alpha:"opacity",dash:"stroke-dasharray",dashOffset:"stroke-dashoffset",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",miterLimit:"stroke-miterlimit",weight:"stroke-width"},Em={left:"start",right:"end",center:"middle",start:"start",end:"end"},vm={top:"text-top",bottom:"text-bottom"},Cn=t=>{if(t==null)return null;if(ht(t,"toHiccup"))return Cn(t.toHiccup());const e=t[0];if(ue(e))return t.map(Cn);let n=$m(t[1]);switch(t[0]){case"svg":case"defs":case"a":case"g":{const s=[e,nt(n)];for(let i=2,r=t.length;i<r;i++){const o=Cn(t[i]);o!=null&&s.push(o)}return s}case"linearGradient":return um(n.id,n.from,n.to,t[2],{gradientUnits:n.gradientUnits||"userSpaceOnUse",...n.gradientTransform?{gradientTransform:n.gradientTransform}:null});case"radialGradient":return fm(n.id,n.from,n.to,n.r1,n.r2,t[2],{gradientUnits:n.gradientUnits||"userSpaceOnUse",...n.gradientTransform?{gradientTransform:n.gradientTransform}:null});case"circle":return om(t[2],t[3],n,...t.slice(4));case"ellipse":return am(t[2],t[3][0],t[3][1],n,...t.slice(4));case"rect":{const s=t[5]||0;return Sm(t[2],t[3],t[4],s,s,n,...t.slice(6))}case"line":return Uo(t[2],t[3],n,...t.slice(4));case"hline":return hm(t[2],n);case"vline":return mm(t[2],n);case"polyline":return _m(t[2],n,...t.slice(3));case"polygon":return wm(t[2],n,...t.slice(3));case"path":return pm(t[2],n,...t.slice(3));case"text":return Rm(t[2],t[3],n,...t.slice(4));case"img":return dm(t[3],t[2].src,n,...t.slice(4));case"points":return ym(t[2],n.shape,n.size,n,...t.slice(3));case"packedPoints":return bm(t[2],n.shape,n.size,n,...t.slice(3));default:return t}},$m=t=>{const e={};if(!t)return e;for(let n in t){const s=t[n],i=Im[n];i?e[i]=s:Nm(e,n,s)}return e},Nm=(t,e,n)=>{switch(e){case"font":{const s=n.indexOf(" ");t["font-size"]=n.substring(0,s),t["font-family"]=n.substring(s+1);break}case"align":t["text-anchor"]=Em[n];break;case"baseline":t["dominant-baseline"]=vm[n]||n;break;default:t[e]=n}},Mm="http://www.w3.org/2000/svg",Om="http://www.w3.org/1999/xlink",Dm=(t,...e)=>(t=nt({version:"1.1",xmlns:Mm,"xmlns:xlink":Om,...t},"width","height","stroke-width"),t.convert&&(delete t.convert,e=e.map(Cn)),["svg",t,...e]),w0=t=>t!=null&&typeof t.deref=="function",He=t=>w0(t)?t.deref():t,_0=t=>t!=null&&typeof t!="string"&&typeof t[Symbol.iterator]=="function",ko={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","\u2014":"&mdash;","\u2013":"&ndash;","\u2026":"&hellip;","\xA2":"&cent;","\u20AC":"&euro;","\xA3":"&pound;","\xA7":"&sect;","\xA9":"&copy;","\xAE":"&reg;","\u2122":"&trade;","\xA0":"&nbsp;"},xm=new RegExp(`[${Object.keys(ko).join("")}]`,"g"),Gm=Object.entries(ko).reduce((t,[e,n])=>(t[n]=e,t),{});new RegExp(`(${Object.keys(Gm).join("|")})`,"g");const Tm=(t,e)=>n=>n.replace(t,s=>e[s]),qo=Tm(xm,ko),S0={"?xml":`?>
`,"!DOCTYPE":`>
`,"!ENTITY":`>
`,"!ELEMENT":`>
`,"!ATTLIST":`>
`},Cm=/^([^\s\.#]+)(?:#([^\s\.#]+))?(?:\.([^\s#]+))?$/,zm="__COMMENT__",Bm="!CDATA",Lm={button:1,option:1,script:1,style:1,text:1,textarea:1,title:1},Vo=t=>t.split(" ").reduce((e,n)=>(e[n]=!0,e),{});Vo("animate animateColor animateMotion animateTransform circle clipPath color-profile defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font foreignObject g image line linearGradient marker mask metadata mpath path pattern polygon polyline radialGradient rect set stop style svg switch symbol text textPath title tref tspan use view");const R0=Vo("area base br col command embed hr img input keygen link meta param source stop track use wbr ?xml"),Pm=Vo("animate circle ellipse line path polygon polyline rect"),Fm={accept:",",sizes:",",srcset:","},Um=t=>{let e="",n;for(let s in t)n=He(t[s]),Se(n)&&(n=n(t)),n!=null&&(e+=`${s}:${n};`);return e},sl=(t,e)=>{if(e=He(e),e==null)return t;if(j(e))return t+" "+e;const n=new Set(t.split(" "));for(let s in e)He(e[s])?n.add(s):n.delete(s);return[...n].join(" ")},km=(t,e,n)=>{e&&(t.id=e);let s=He(t.class);return n?(n=n.replace(/\./g," "),t.class=s?sl(n,s):n):s&&(t.class=j(s)?s:sl("",s)),t},qm=t=>{let e=t[0],n;const s=Dt(t[1]),i=s?{...t[1]}:{};return(!j(e)||!(n=Cm.exec(e)))&&je(`"${e}" is not a valid tag name`),e=n[1],km(i,n[2],n[3]),t.length>1&&(t=t.slice(s?2:1).filter(r=>r!=null),t.length>0)?[e,i,t]:[e,i]},Vm=t=>Object.keys(t).reduce((e,n)=>(e.push(`${n}: ${t[n]}`),e),[]).join(" "),jm=(t,e,n=!1,s=!1,i=s,r=[0])=>ae(t,e,n,s,i,r),ae=(t,e,n,s,i,r)=>t==null?"":Array.isArray(t)?Hm(t,e,n,s,i,r):Se(t)?ae(t(e),e,n,s,i,r):ht(t,"toHiccup")?ae(t.toHiccup(e),e,n,s,i,r):w0(t)?ae(t.deref(),e,n,s,i,r):_0(t)?I0(t,e,n,s,i,r):(t=n?qo(String(t)):String(t),s?`<span${i?` key="${r.join("-")}"`:""}>${t}</span>`:t),Hm=(t,e,n,s,i,r)=>{let o=t[0];return t.length?Se(o)?ae(o.apply(null,[e,...t.slice(1)]),e,n,s,i,r):ht(o,"render")?ae(o.render.apply(null,[e,...t.slice(1)]),e,n,s,i,r):o===zm?Km(t):o==Bm?tg(t):j(o)?Ym(t,e,n,s,i,r):_0(t)?I0(t,e,n,s,i,r):je(`invalid tree node: ${t}`):""},Ym=(t,e,n,s,i,r)=>{t=qm(t);const o=t[1];if(o.__skip||o.__serialize===!1)return"";i&&o.key===void 0&&(o.key=r.join("-"));const a=t[0],l=t[2]?Jm(a,t[2],e,n,s,i,r):!R0[a]&&!Pm[a]?`></${a}>`:S0[a]||"/>";return`<${a}${Xm(o,n)}${l}`},Xm=(t,e)=>{let n="";for(let s in t){if(s.startsWith("__"))continue;const i=Wm(t,s,He(t[s]),e);i!=null&&(n+=i)}return n},Wm=(t,e,n,s)=>n==null||Se(n)&&(/^on\w+/.test(e)||(n=n(t))==null)?null:n===!0?" "+e:n===!1?null:e==="data"?Zm(n,s):Qm(e,n,s),Qm=(t,e,n)=>(e=t==="style"&&Dt(e)?Um(e):t==="prefix"&&Dt(e)?Vm(e):ue(e)?e.join(Fm[t]||" "):e.toString(),e.length?` ${t}="${n?qo(e):e}"`:null),Zm=(t,e)=>{let n="";for(let s in t){let i=He(t[s]);Se(i)&&(i=i(t)),i!=null&&(n+=` data-${s}="${e?qo(i):i}"`)}return n},Jm=(t,e,n,s,i,r,o)=>{R0[t]&&je(`No body allowed in tag: ${t}`);const a=S0[t];let l=a?" ":">";i=i&&!a&&!Lm[t];for(let u=0,c=e.length;u<c;u++)l+=ae(e[u],n,s,i,r,[...o,u]);return l+(a||`</${t}>`)},Km=t=>t.length>2?`
<!--
${t.slice(1).map(e=>"    "+e).join(`
`)}
-->
`:`
<!-- ${t[1]} -->
`,tg=t=>`<![CDATA[
${t.slice(1).join(`
`)}
]]>`,I0=(t,e,n,s,i,r)=>{const o=[],a=r.slice(0,r.length-1);let l=0;for(let u of t)o.push(ae(u,e,n,s,i,[...a,l++]));return o.join("")},eg=(t,e,n,s,i)=>{const r=ke([],kc),o=ke([],Uc),a=[],l=u=>{Xc(t,e,n,u,a),Ad(null,r,a),Vc(null,o,a)};if(l(s),l(i),s>i){const u=s;s=i,i=u}for(let u=Wa(s,V),c=Wa(i,V);u<c;u+=V)Hc(u,s,i)&&l(u);return[r,o]},E0=(t,e,n)=>{for(let s=t.length;s-- >0;){const i=t[s];Yn(null,e,i),kn(null,n,i)}return[e,n]},ng=t=>E0(t,[1/0,1/0],[-1/0,-1/0]),sg=t=>E0(t,[1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ig=(t,e,n,s,i,r,o)=>{t[n]=Math.min(s,o),e[n]=Math.max(s,o);const a=-s+i,l=s-2*i+r,u=-s+3*i-3*r+o;let c=l*l-a*u;if(c>0){c=Math.sqrt(c);const m=h=>{if(h>0&&h<1){const b=yh(s,i,r,o,h);t[n]=Math.min(t[n],b),e[n]=Math.max(e[n],b)}};m(a/(-l-c)),m(a/(-l+c))}},rg=(t,e,n,s)=>{const i=[],r=[];for(let o=t.length;o-- >0;)ig(i,r,o,t[o],e[o],n[o],s[o]);return[i,r]},og=(t,e,n)=>{const s=F((t-e)/(t-2*e+n)),i=1-s;return i*i*t+2*i*s*e+s*s*n},ag=(t,e,n)=>{for(let s=t.length;s-- >0;)if(!Hc(t[s],e[s],n[s]))return!1;return!0},lg=(t,e,n)=>{const s=Yn([],t,n),i=kn([],t,n);if(!ag(e,s,i)){const r=[];for(let o=t.length;o-- >0;)r[o]=og(t[o],e[o],n[o]);Yn(null,s,r),kn(null,i,r)}return[s,i]};function v0(t,e){return Mi(e)?Di(v0(t),e):n=>{const s=n[2];return Oi(n,(i,r)=>t(r)?s(i,r):i)}}const Kr=(t,e)=>{let n=t.length-1;if(n<0)return;let s=e(t[n]);if(!s)return;let{pos:i,size:r}=s;for(;n-- >0;)s=e(t[n]),s&&([i,r]=cg(i,r,s.pos,s.size));return[i,r]},cg=(t,e,n,s)=>{const i=Ue([],t,e),r=Ue([],n,s),o=Yn([],t,n);return[o,Xn(null,kn(null,i,r),o)]},oi=nn(sn,{aabb:"rect",bpatch:"points",poly:"points",polyline:"points",quad:"points",tri:"points"},{arc:(t,e=0)=>gn(...eg(t.pos,t.r,t.axis,t.start,t.end),e),circle:(t,e=0)=>new yt(qr([],t.pos,t.r+e),Hs(null,[2,2],t.r+e)),cubic:({points:t},e=0)=>gn(...rg(t[0],t[1],t[2],t[3]),e),ellipse:(t,e=0)=>{const n=Fc([],t.r,e);return new yt(Wc([],t.pos,n),rt(null,[2,2],n))},group:(t,e=0)=>{const n=Kr(t.children,oi);return n?new yt(...n).offset(e):void 0},line:({points:[t,e]},n=0)=>gn(Yn([],t,e),kn([],t,e),n),path:(t,e=0)=>{const n=Kr([...Di(Rc(ls(s=>s.geo),v0(s=>!!s)),t.segments)],oi);return n?new yt(...n).offset(e):void 0},points:(t,e=0)=>gn(...ng(t.points),e),points3:(t,e=0)=>Sd(...sg(t.points),e),quadratic:({points:t},e=0)=>gn(...lg(t[0],t[1],t[2]),e),rect:(t,e=0)=>e===0?t.copy():t.copy().offset(e),text:(t,e=0)=>new yt(qr([],t.pos,e),e*2)}),ug=(...t)=>t.map(e=>jm(Cn(e))).join(""),fg=(t,...e)=>{if(e.length>0&&!t.viewBox){const n=Kr(e,oi);if(n){const[[s,i],[r,o]]=n,a=t.bleed||0,l=2*a,u=_(r+l),c=_(o+l);t={width:u,height:c,viewBox:`${_(s-a)} ${_(i-a)} ${u} ${c}`,...Gh(t,["bleed"])}}}return Dm(t,...e)},dg=(t,e,n,s=mt)=>{const i=Bo(t,e,n);return i!==void 0?Ie(t,ei([],e,n,F(i)))<s*s:!1},hg=(t,e,n)=>Ie(e,t)<=n*n,mg=(t,e,n,s)=>{const i=ch(e,n,s)?1:-1;return i*Gn(e,s,t)>=0&&i*Gn(n,e,t)>=0&&i*Gn(s,n,t)>=0},gg=(t,e)=>{const n=e.length-1,s=t[0],i=t[1];let r=e[n],o=e[0],a=0;for(let l=0;l<=n;r=o,o=e[++l])a=pg(s,i,r[0],r[1],o[0],o[1],a);return a},pg=(t,e,n,s,i,r,o)=>(s<e&&r>=e||r<e&&s>=e)&&(n<=t||i<=t)?o^~~(n+(e-s)/(r-s)*(i-n)<t):o,jo=Xt(0),yg=jo.add(2,([t,e],n,s)=>t>=n[0]&&t<=n[0]+s[0]&&e>=n[1]&&e<=n[1]+s[1]),bg=jo.add(3,([t,e,n],s,i)=>t>=s[0]&&t<=s[0]+i[0]&&e>=s[1]&&e<=s[1]+i[1]&&n>=s[2]&&n<=s[2]+i[2]);jo.default((t,e,n)=>{for(let s=t.length;s-- >0;){const i=t[s],r=e[s];if(i<r||i>r+n[s])return!1}return!0});const Ho=Xt(0);Ho.add(2,([t,e],n,s)=>t>=n[0]-s[0]&&t<=n[0]+s[0]&&e>=n[1]-s[1]&&e<=n[1]+s[1]);Ho.add(3,([t,e,n],s,i)=>t>=s[0]-i[0]&&t<=s[0]+i[0]&&e>=s[1]-i[1]&&e<=s[1]+i[1]&&n>=s[2]-i[2]&&n<=s[2]+i[2]);Ho.default((t,e,n)=>{for(let s=t.length;s-- >0;){const i=t[s],r=e[s],o=n[s];if(i<r-o||i>r+o)return!1}return!0});const il=(t,e)=>(e=H(e)?[e,e,e]:e,Id(t||[],e[0],0,0,0,0,e[1],0,0,0,0,e[2],0,0,0,0,e[3]!==void 0?e[3]:1)),ai=nn(sn,{points3:"points",quad:"poly",sphere:"circle"},{aabb:(t,e)=>bg(e,t.pos,t.size),circle:(t,e)=>hg(e,t.pos,t.r),line:(t,e)=>dg(e,t.points[0],t.points[1]),points:({points:t},e)=>Od(e,t),poly:(t,e)=>gg(e,t.points)>0,rect:(t,e)=>yg(e,t.pos,t.size),tri:(t,e)=>mg(e,...t.points)}),rl=(t,e,n=en,s=[])=>{const i=oi(t);if(!i)return;const r=i.pos,o=i.max();for(;e-- >0;)for(;;){const a=gh([],r,o,n);if(ai(t,a)){s.push(a);break}}return s},Li=(t,e)=>{let n;(n=e.fill)&&n!=="none"&&t.fill(),(n=e.stroke)&&n!=="none"&&t.stroke(),(n=e.clip)&&t.clip(n===!0?"nonzero":n)},ol=(t,e,n,s,i=0,r=k,o=!1)=>{t.beginPath(),t.arc(n[0],n[1],s,i,r,o),Li(t,e)},Ag=(t,e,n,s,i=0,r=0,o=k,a=!1)=>{t.beginPath(),t.ellipse(n[0],n[1],s[0],s[1],i,r,o,a),Li(t,e)},fr={},wg=(t,e,n,s)=>{const i=fr[n];At(!!i,`no conversions available for ${n}`);let r=i[s];return r?r(t,e):fr.rgb[s]?i.rgb(t,fr.rgb[s]([],e)):cs(`can't convert: ${s} -> ${n}`)};Object.freeze([0,0,0,1]);Object.freeze([1,1,1,1]);Object.freeze([1,0,0,1]);Object.freeze([0,1,0,1]);Object.freeze([0,0,1,1]);Object.freeze([0,1,1,1]);Object.freeze([1,0,1,1]);Object.freeze([1,1,0,1]);const _g=[3.1338561,-.9787684,.0719453,-1.6168667,1.9161415,-.2289914,-.4906146,.033454,1.4052427],Sg=[3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252],Rg=[.96422,1,.82521],Ig=[.95047,1,1.08883];let li=Go(3),al=d0(3);const Eg=1/255,ve=(t,e=1)=>t!=null?F(t):e,$0=t=>{const e=li(Q(t[0])*360),n=al(F(t[1])),s=al(F(t[2])),i=ve(t[3]);return i<1?`hsla(${e},${n},${s},${li(i)})`:`hsl(${e},${n},${s})`},vg=(t,e,n=1)=>et(t||e,Q(e[0]),F(e[1]),F(e[2]),ve(e[3],n)),$g=(t,e)=>{t=vg(t||e,e);const n=t[1],s=t[2],i=(2-n)*s/2;return t[2]=i,t[1]=i&&i<1?n*s/(i<.5?i*2:2-i*2):n,t},Ng=t=>$0($g([],t)),to=t=>{const e=t>>>24;return e<255?`rgba(${t>>16&255},${t>>8&255},${t&255},${li(e*Eg)})`:`#${Bi(t&16777215)}`},Mg=t=>(t&255)<<16|t>>16&255|t&4278255360,Og=Mg,Dg=(t,e)=>{let{1:n,2:s}=e;s*=k;const i=ve(e[3]);return n>0?et(t||e,e[0],Math.cos(s)*n,Math.sin(s)*n,i):et(t||e,e[0],0,0,i)},dr=t=>{const e=t**3;return e>.008856?e:(t-16/116)/7.787},N0=(t,e,n=Rg)=>{const s=(e[0]+.16)/1.16;return et(t||e,dr(e[1]/5+s)*n[0],dr(s)*n[1],dr(s-e[2]/2)*n[2],ve(e[3]))},xg=(t,e)=>N0(t,e,Ig),Gg=(t,e,n,s=!1)=>{const i=Ce(e,n,0,0,3),r=Ce(e,n,1,0,3),o=Ce(e,n,2,0,3),a=ve(n[3]);return s?et(t||n,F(i),F(r),F(o),a):et(t||n,i,r,o,a)},M0=(t,e,n=_g)=>Gg(t,n,e),Tg=(t,e)=>M0(t,e,Sg),ll=(t,e)=>M0(null,N0(t,e)),Cg=(t,e)=>Tg(null,xg(t,e)),hr=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Ls=(t,e)=>et(t||e,hr(e[0]),hr(e[1]),hr(e[2]),ve(e[3])),mr=(t,e=0)=>(t<0?0:t>1?1:t)*255+.5<<e,Ge=t=>{const e=mr(t[0]),n=mr(t[1]),s=mr(t[2]),i=ve(t[3]);return i<1?`rgba(${e},${n},${s},${li(i)})`:`#${Bi(e<<16|n<<8|s)}`},zg=t=>Ge(Ls([],t)),cl={abgr32:t=>to(Og(t[0])),argb32:t=>to(t[0]),hsl:$0,hsv:Ng,lab50:t=>Ge(Ls(null,ll([],t))),lab65:t=>Ge(Ls(null,Cg([],t))),lch:t=>Ge(Ls(null,ll(null,Dg([],t)))),rgb:zg,srgb:Ge},Bg=t=>{let e;return j(t)?t:H(t)?to(t):t.mode?(e=cl[t.mode])?e(t):cl.rgb(wg([],t,"rgb",t.mode)):Ge(t)},Yo=Bg,O0=(t,e)=>j(e)?e[0]==="$"?t.grads[e.substring(1)]:e:Yo(e),Lg=(t,{from:e,to:n},s)=>{const i=t.createLinearGradient(e[0],e[1],n[0],n[1]);for(let r of s)i.addColorStop(r[0],Yo(r[1]));return i},Pg=(t,{from:e,to:n,r1:s,r2:i},r)=>{const o=t.createRadialGradient(e[0],e[1],s,n[0],n[1],i);for(let a of r)o.addColorStop(a[0],Yo(a[1]));return o},Fg=(t,e,{width:n,height:s},i,r,o,a)=>{if(ht(i,"toImageData")&&(i=i.toImageData()),i instanceof ImageData){t.putImageData(i,r[0],r[1]);return}n=n||i.width,s=s||i.height,o?t.drawImage(i,o[0],o[1],a?a[0]:n,a?a[1]:s,r[0],r[1],n,s):t.drawImage(i,r[0],r[1],n,s)},Ug={align:"left",alpha:1,baseline:"alphabetic",compose:"source-over",dash:[],dashOffset:0,direction:"inherit",fill:"#000",filter:"none",font:"10px sans-serif",lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowBlur:0,shadowColor:"rgba(0,0,0,0)",shadowX:0,shadowY:0,smooth:!0,stroke:"#000",weight:1},D0={align:"textAlign",alpha:"globalAlpha",baseline:"textBaseline",clip:"clip",compose:"globalCompositeOperation",dash:"setLineDash",dashOffset:"lineDashOffset",direction:"direction",fill:"fillStyle",filter:"filter",font:"font",lineCap:"lineCap",lineJoin:"lineJoin",miterLimit:"miterLimit",shadowBlur:"shadowBlur",shadowColor:"shadowColor",shadowX:"shadowOffsetX",shadowY:"shadowOffsetY",smooth:"imageSmoothingEnabled",stroke:"strokeStyle",weight:"lineWidth"},ul=(t,e=!1)=>({attribs:{...t.attribs},grads:{...t.grads},edits:[],restore:e}),kg=(t,e,n)=>{let s;if(!!n){Vg(t,n)&&(s=ul(e,!0));for(let i in n){const r=D0[i];if(r){const o=n[i];o!=null&&e.attribs[i]!==o&&(!s&&(s=ul(e)),s.attribs[i]=o,s.edits.push(i),x0(t,e,i,r,o))}else i==="__background"&&(t.save(),t.resetTransform(),t.fillStyle=O0(e,n[i]),t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore())}return s}},qg=(t,e,n)=>{if(n.restore){t.restore();return}const s=n.edits,i=e.attribs;for(let r=s.length;r-- >0;){const o=s[r],a=i[o];x0(t,e,o,D0[o],a!=null?a:Ug[o])}},fl=(t,e,n)=>{!t.grads&&(t.grads={}),t.grads[e]=n},x0=(t,e,n,s,i)=>{switch(n){case"fill":case"stroke":case"shadowColor":t[s]=O0(e,i);break;case"dash":t[s].call(t,i);break;case"clip":break;default:t[s]=i}},Vg=(t,e)=>{let n;return(n=e.transform)||e.setTransform||e.translate||e.scale||e.rotate?(t.save(),n?t.transform(n[0],n[1],n[2],n[3],n[4],n[5]):(n=e.setTransform)?t.setTransform(n[0],n[1],n[2],n[3],n[4],n[5]):((n=e.translate)&&t.translate(n[0],n[1]),(n=e.rotate)&&t.rotate(n),(n=e.scale)&&(_o(n)?t.scale(n[0],n[1]):t.scale(n,n))),!0):!1},gr=(t,e,n,s)=>{e.stroke!=="none"&&(t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(s[0],s[1]),t.stroke())},jg=(t,e,n)=>{if(e.stroke!=="none"){t.beginPath();for(let{0:s,1:i}of n)t.moveTo(s[0],s[1]),t.lineTo(i[0],i[1]);t.stroke()}},Hg=(t,e,n,s)=>{let i;(i=e.fill)&&i!=="none"&&dl(t,n,s,"fill","fillRect"),(i=e.stroke)&&i!=="none"&&dl(t,n,s,"stroke","strokeRect")},dl=(t,e,n,s,i)=>{const{start:r,cstride:o,estride:a,size:l}={start:0,cstride:1,estride:2,size:1,...e};let u=e&&e.num!=null?e.num:(n.length-r)/a|0;if(e.shape==="circle")for(let c=r;u-- >0;c+=a)t.beginPath(),t.arc(n[c],n[c+o],l,0,k),t[s]();else{const c=l/2;for(let m=r;u-- >0;m+=a)t[i](n[m]-c,n[m+o]-c,l,l)}},G0=(t,e,n)=>{t.beginPath();let s=[0,0];for(let i=0,r=n.length;i<r;i++){const o=n[i];let a=o[1],l,u;switch(o[0]){case"m":a=[s[0]+a[0],s[1]+a[1]];case"M":t.moveTo(a[0],a[1]),s=a;break;case"l":a=[s[0]+a[0],s[1]+a[1]];case"L":t.lineTo(a[0],a[1]),s=a;break;case"h":a=[s[0]+a,s[1]],t.lineTo(a[0],a[1]),s=a;break;case"H":a=[a,s[1]],t.lineTo(a[0],a[1]),s=a;break;case"v":a=[s[0],s[1]+a],t.lineTo(a[0],a[1]),s=a;break;case"V":a=[s[0],a],t.lineTo(a[0],a[1]),s=a;break;case"c":l=o[2],u=o[3],u=[s[0]+u[0],s[1]+u[1]],t.bezierCurveTo(s[0]+a[0],s[1]+a[1],s[0]+l[0],s[1]+l[1],u[0],u[1]),s=u;break;case"C":l=o[2],u=o[3],t.bezierCurveTo(a[0],a[1],l[0],l[1],u[0],u[1]),s=u;break;case"q":l=o[2],l=[s[0]+l[0],s[1]+l[1]],t.quadraticCurveTo(s[0]+a[0],s[1]+a[1],l[0],l[1]),s=l;break;case"Q":l=o[2],t.quadraticCurveTo(a[0],a[1],l[0],l[1]),s=l;break;case"a":l=o[2],l=[s[0]+l[0],s[1]+l[1]],t.arcTo(s[0]+a[0],s[1]+a[1],l[0],l[1],o[3]),s=l;break;case"A":l=o[2],t.arcTo(a[0],a[1],l[0],l[1],o[3]),s=l;break;case"z":case"Z":t.closePath()}}Li(t,e)},Yg=(t,e,n,s)=>{let i;(i=e.fill)&&i!=="none"&&hl(t,n,s,"fill","fillRect"),(i=e.stroke)&&i!=="none"&&hl(t,n,s,"stroke","strokeRect")},hl=(t,e,n,s,i)=>{const r=e&&e.size||1;if(e.shape==="circle")for(let o of n)t.beginPath(),t.arc(o[0],o[1],r,0,k),t[s]();else{const o=r/2;for(let a of n)t[i](a[0]-o,a[1]-o,r,r)}},Xg=(t,e,n)=>{n.length<2||(T0(t,n),t.closePath(),Li(t,e))},T0=(t,e)=>{let n=e[0];t.beginPath(),t.moveTo(n[0],n[1]);for(let s=1,i=e.length;s<i;s++)n=e[s],t.lineTo(n[0],n[1])},Wg=(t,e,n)=>{n.length<2||e.stroke=="none"||(T0(t,n),t.stroke())},Qg=(t,e,n,s,i,r=0)=>{let o;if(r>0)return r=Math.min(Math.min(s,i)/2,r),s-=2*r,i-=2*r,G0(t,e,[["M",[n[0]+r,n[1]]],["h",s],["a",[r,0],[r,r],r],["v",i],["a",[0,r],[-r,r],r],["h",-s],["a",[-r,0],[-r,-r],r],["v",-i],["a",[0,-r],[r,-r],r]]);(o=e.fill)&&o!=="none"&&t.fillRect(n[0],n[1],s,i),(o=e.stroke)&&o!=="none"&&t.strokeRect(n[0],n[1],s,i)},Zg=(t,e,n,s,i)=>{let r;(r=e.fill)&&r!=="none"&&t.fillText(s.toString(),n[0],n[1],i),(r=e.stroke)&&r!=="none"&&t.strokeText(s.toString(),n[0],n[1],i)},Qn=(t,e,n={attribs:{},edits:[]})=>{if(!e)return;if(ht(e,"toHiccup")){Qn(t,e.toHiccup(),n);return}if(ue(e[0])){for(let o of e)Qn(t,o,n);return}const s=e[1];if(s!=null&&s.__skip)return;const i=kg(t,n,s),r=i?i.attribs:n.attribs;switch(e[0]){case"g":case"defs":Jg(t,i,n,e);break;case"linearGradient":fl(n,s.id,Lg(t,s,e[2]));break;case"radialGradient":fl(n,s.id,Pg(t,s,e[2]));break;case"points":Yg(t,r,s,e[2]);break;case"packedPoints":Hg(t,r,s,e[2]);break;case"line":gr(t,r,e[2],e[3]);break;case"lines":jg(t,r,e[2]);break;case"hline":gr(t,r,[-1e6,e[2]],[1e6,e[2]]);break;case"vline":gr(t,r,[e[2],-1e6],[e[2],1e6]);break;case"polyline":Wg(t,r,e[2]);break;case"polygon":Xg(t,r,e[2]);break;case"path":G0(t,r,e[2]);break;case"rect":Qg(t,r,e[2],e[3],e[4],e[5]);break;case"circle":ol(t,r,e[2],e[3]);break;case"ellipse":Ag(t,r,e[2],e[3],e[4],e[5],e[6]);break;case"arc":ol(t,r,e[2],e[3],e[4],e[5]);break;case"text":Zg(t,r,e[2],e[3],e[4]);break;case"img":Fg(t,r,s,e[2],e[3],e[4],e[5])}i&&qg(t,n,i)},Jg=(t,e,n,s)=>{const i=s.length,r=s[0]==="g"&&e||n;for(let o=2;o<i;o++)Qn(t,s[o],r)},ml="0123456789abcdef",Kg=t=>ml[t>>>4&15]+ml[t&15],C0=t=>new tp(t);class tp{constructor(e){this.base=e,this.N=e.length,this.index=[...e].reduce((n,s,i)=>(n[s]=i,n),{})}encode(e){const{base:n,N:s}=this;if(e===0)return n[0];let i="";for(;e>0;)i=n[e%s]+i,e=Math.floor(e/s);return i}encodeBigInt(e){if(e<BigInt(2**53))return this.encode(Number(e));const{base:n,N:s}=this;if(e===BigInt(0))return n[0];const i=BigInt(s);let r="";for(;e>0;)r=n[Number(e%i)]+r,e/=i;return r}encodeBytes(e){let n="";for(let s=0,i=e.length;s<i;s++)n+=Kg(e[s]);return this.encodeBigInt(BigInt(`0x${n}`))}decode(e){const{index:n,N:s}=this;let i=0;for(let r=e.length-1,o=0;o<=r;o++)i+=n[e[o]]*s**(r-o);return i}decodeBigInt(e){const{index:n,N:s}=this,i=BigInt(s);let r=BigInt(0);for(let o=e.length-1,a=0;a<=o;a++)r+=BigInt(n[e[a]])*i**BigInt(o-a);return r}decodeBytes(e,n){let s=this.decodeBigInt(e);const i=BigInt(255),r=BigInt(8);for(let o=n.length;o-- >0;)n[o]=Number(s&i),s>>=r;return n}validate(e){return new RegExp(`^[${this.base}]+$`).test(e)}size(e){return Math.ceil(Math.log(e)/Math.log(this.N))}}const z0="123456789",B0="ABCDEFGHJKLMNPQRSTUVWXYZ",L0="abcdefghijkmnopqrstuvwxyz",ep=z0+B0+L0,P0=z0+L0+B0,np=ep;C0(np);C0(P0);const Xo=[3737844653,799659867,3827263459,1552149530];[...Xo];const sp=(t,e=en,n=0,s=t.length)=>t[e.minmax(n,s)|0];class Wo extends n0{constructor(e=Xo){super(),this.buffer=new Uint32Array(4),this.seed(e)}copy(){return new Wo(this.buffer)}bytes(){return new Uint8Array(this.buffer.buffer)}int(){const e=this.buffer,n=(e[0]+e[1]>>>0)+e[3]>>>0;return e[3]=e[3]+1>>>0,e[0]=e[1]^e[1]>>>9,e[1]=e[2]+(e[2]<<3)>>>0,e[2]=(e[2]<<21|e[2]>>>11)+n>>>0,n}seed(e){return this.buffer.set(e),this}}const ip=(t,e,n=en)=>{const s=t.length;At(s>0,"no choices given");const i=e?t.map((o,a)=>[e[a]||0,o]).sort((o,a)=>a[0]-o[0]):t.map(o=>[1,o]),r=i.reduce((o,a)=>o+a[0],0);return r<=0&&console.warn("total weights <= 0"),()=>{const o=n.float(r);let a=r;for(let l=0;l<s;l++)if(a-=i[l][0],a<=o)return i[l][1]}},F0=t=>t.slice(2).match(new RegExp(`.{${t.length-2>>2}}`,"g")).map(e=>[...e].reduce((n,s)=>n*58+P0.indexOf(s)>>>0,0));let Ps;typeof fxhash=="string"?Ps=F0(fxhash):(Ps=Xo,console.warn("fxhash PRNG not found, using default seed",Ps,`

`));const f=new Wo(Ps),$=(t,e=f)=>e.float()<t,d=(t,e=f)=>sp(t,e),C=(t,e,n=f)=>ip(t,e,n)(),rp=()=>typeof window<"u"&&!!window.chrome,op=new Set(["__proto__","prototype","constructor"]),pr=t=>op.has(t),ap=t=>ue(t)?t.some(pr):j(t)?t.indexOf(".")!==-1?t.split(".").some(pr):pr(t):!1;class lp{constructor(e,n,s,i,r,o,a,l){G(this,"line");G(this,"additionalShapes",[]);G(this,"active",!0);G(this,"generation");G(this,"fixedAttribs");G(this,"spaceTraveled",0);G(this,"lengths",[0]);G(this,"velocity",new B);G(this,"length",0);this.ID=e,this.pos=n,this.dir=s,this.BOUNDS=i,this.spaceManager=r,this.agentAttribs=o,this.maxLength=a,this.parent=l,this.fixedAttribs={},this.generation=l?l.generation+1:0,this.line=[new Ve([Mn(n)],o.getAttribs(this))]}update(e,{fuzziness:n=0,chance:s=1},i=!1){const{BOUNDS:r,spaceManager:o,active:a,agentAttribs:l}=this;if(a){const u=this.move(e,n);if(this.active=this.checkStopCondition(r,o),this.active&&$(s)){const c=Nh(this.line);if(this.addSegment(c,this.pos),this.spaceTraveled+=u,this.lengths[this.lengths.length-1]+=u,this.length+=u,i){const m=l.getAttribs(this);Re(m,c.attribs)||(this.line.push(new Ve([Mn(this.pos)],m)),this.lengths.push(0))}}else this.additionalShapes=[];return this.active}return!0}addSegment(e,n){this.additionalShapes=[],e.points.push(Mn(n));const s=this.agentAttribs.getStyleAttribs(this);s.type==="sanded line"&&e.points.length>1&&(this.drawSandedLine(e,s,e.points[e.points.length-2],this.spaceManager.freeLine(this,e.points[e.points.length-2],Gs([],this.velocity,V),s.maxLength,s.followBounds?this.BOUNDS:void 0)),s.doubleSided&&this.drawSandedLine(e,s,e.points[e.points.length-2],this.spaceManager.freeLine(this,e.points[e.points.length-2],Gs([],this.velocity,-V),s.maxLength,s.followBounds?this.BOUNDS:void 0)))}drawSandedLine(e,n,s,i){const r=Xn([],i,s),o=jr(r);let a=Math.floor(o*n.grainsFactor);for(let l=0;l<a;l++){const u=Ae(n.minAlpha,n.maxAlpha?n.maxAlpha:n.alpha,n.alphaDecay(l/a)),c=new qe([Ah([],i,s,[l/a,l/a])],{stroke:n.stroke,size:Math.max(1e-4,n.weight*n.weightFactor),weight:n.weight*n.weightFactor,shape:"circle",alpha:u});this.additionalShapes.push(c)}}move(e,n=0){const{pos:s,dir:i}=this;return this.velocity=To([],Gs([],i,this.agentAttribs.getAngle(this)),e),n>0&&Ue(null,this.velocity,[f.minmax(-n,n),f.minmax(-n,n)]),Ue(null,s,this.velocity),jr(this.velocity)}getShape(e,n,s=1e4,i=!0){const r=[];let o,a=s;for(let l=this.line.length-1;l>=0&&a>0;l--)if(this.line[l].points.length<=a)a-=this.line[l].points.length,r.unshift(this.line[l]);else{const u=this.line[l].copy();u.points=u.points.slice(-a),r.unshift(u);break}if(n.type==="points"){const l=[],u=this.agentAttribs.getStyleAttribs(this);for(const c of r){const m=(c.attribs?c.attribs.weight:1)*u.weightFactor,h=new qe(c.points,{...c.attribs,weight:m,shape:"circle"});l.push(h)}o=si(this.fixedAttribs,l.map(c=>Tn(c,e)))}return o=si(this.fixedAttribs,r.map(l=>Tn(l,e))),o.children.push(...this.additionalShapes.map(l=>Tn(l,e))),o}getStart(){return this.line?this.line[0].points[0]:this.pos}getAttribs(){return this.line[0].attribs}getPos(){return this.pos}checkStopCondition(e,n){return ai(e,this.pos)&&!n.checkCollision(this,0,!1,!0)&&this.length<=this.maxLength}isRemovable(){return this.line.length===1&&this.line[0].points.length<2}}class cp{constructor(e,n,s,i=[ii([0,0],[1,1])],r=[ii([0,0],[1,1])],o,a=!0){G(this,"agents",[]);G(this,"spaceTraveled",0);G(this,"iterations",0);G(this,"nextAgentID",0);G(this,"agentsToCreate",0);G(this,"toCreate",0);this.spaceManager=e,this.agentFeatures=n,this.minMovement=s,this.BOUNDS=i,this.initBOUNDS=r,this.AgentConstructor=o,this.createAllAgents=a,e.setAgents(this.agents)}createAgent(e=!1,n,s,i,r){const{pos:o,agent:a}=e?this.spaceManager.randomOccupied(n):this.spaceManager.randomFree(n);if(o){const l=a?Gs([],d([new B([a.dir[1],-a.dir[0]]),new B([-a.dir[1],a.dir[0]])],f),this.agentFeatures.angled?r.getAngleAt(o,{}):0):d(i,f),u=new this.AgentConstructor(this.agents.length,o,l,s,this.spaceManager,r,f.minmax(this.agentFeatures.maxLineLength[0],this.agentFeatures.maxLineLength[1]),a);return this.spaceTraveled+=u.move(this.minMovement,0),this.agents.push(u),!0}return!1}cleanUpAgents(e=!0){const n=e?this.getInactiveAgents():this.agents;for(const s of n)s.isRemovable()&&this.agents.splice(0,this.agents.length,...this.agents.filter(i=>i!==s))}updateAgents(e,n,s,i,r=!1){if(this.iterations=this.iterations+1,this.iterations<this.agentFeatures.maxIterations&&this.spaceTraveled<this.agentFeatures.maxSpaceTraveled){const o=this.getActiveAgents().map(m=>m.update(e,this.agentFeatures,r)).filter(m=>m===!1);this.cleanUpAgents();const a=this.getActiveAgents().length;this.spaceTraveled=this.agents.reduce((m,h)=>m+h.spaceTraveled,0),this.agentsToCreate+=o.length*n,this.toCreate=Math.min(this.createAllAgents?this.agentsToCreate:o.length*n,s,this.agentFeatures.max-this.agents.length,this.agentFeatures.maxActive-a);let l=0,u=0;for(;l<this.toCreate&&u<1e3;){const m=d(this.BOUNDS,f);this.createAgent(!0,d(this.initBOUNDS,f),m,[],i)&&(l++,this.agentsToCreate--),u++}const c=a+this.toCreate>0;return c||console.log("no active agents"),c}return console.log(this.iterations>=this.agentFeatures.maxIterations?"ended iterations":"traveled enough"),this.cleanUpAgents(!1),!1}getActiveAgents(){return this.agents.filter(e=>e.active)}getInactiveAgents(){return this.agents.filter(e=>!e.active)}getAgents(e=!0){return e?this.getActiveAgents():this.agents}log(){return{iterations:this.iterations,agents:this.agents.length,activeAgents:this.getActiveAgents().length,agentsToCreate:this.agentsToCreate,toCreateNow:this.toCreate,spaceTraveled:this.spaceTraveled}}}var gl;(function(t){t[t.RED=0]="RED",t[t.ORANGE=1]="ORANGE",t[t.YELLOW=2]="YELLOW",t[t.CHARTREUSE=3]="CHARTREUSE",t[t.GREEN=4]="GREEN",t[t.SPRING_GREEN=5]="SPRING_GREEN",t[t.CYAN=6]="CYAN",t[t.AZURE=7]="AZURE",t[t.BLUE=8]="BLUE",t[t.VIOLET=9]="VIOLET",t[t.MAGENTA=10]="MAGENTA",t[t.ROSE=11]="ROSE"})(gl||(gl={}));class pn{constructor(e,n){this.mode=e,this.value=n}deref(){return this.value}}function rn(t,e){return!e&&(e={}),(...n)=>{const s=JSON.stringify(n);return s!==void 0?s in e?e[s]:e[s]=t.apply(null,n):t.apply(null,n)}}const U0=rn((t,e)=>t.repeat(e)),Pi=rn((t,e=" ")=>{const n=U0(String(e),t);return(s,i)=>s==null?n:(s=s.toString(),i=i!==void 0?i:s.length,i<t?n.substring(i)+s:s)});Pi(2,"0");Pi(3,"0");Pi(4,"0");const k0=rn((t,e=!1)=>e?n=>q0(n)||n.toFixed(t):n=>n.toFixed(t));rn((t,e=3)=>{const n=t-e-1,s=Math.pow(10,n),i=-Math.pow(10,n-1),r=Math.pow(10,-(e-1)),o=Pi(t);return a=>{const l=Math.abs(a);return o(q0(a)||(a===0?"0":l<r||l>=s?up(a,t):a.toFixed(e-(a<i?1:0))))}});const up=(t,e)=>t.toExponential(Math.max(e-4-(Math.log(Math.abs(t))/Math.LN10>=10?2:1)-(t<0?1:0),0)),q0=t=>isNaN(t)?"NaN":t===1/0?"+\u221E":t===-1/0?"-\u221E":void 0,fp=(t=0)=>e=>(e*100).toFixed(t)+"%";Object.freeze([0,0,0,1]);Object.freeze([1,1,1,1]);Object.freeze([1,0,0,1]);Object.freeze([0,1,0,1]);Object.freeze([0,0,1,1]);Object.freeze([0,1,1,1]);Object.freeze([1,0,1,1]);Object.freeze([1,1,0,1]);const dp=[.299,.587,.114],V0=[.2126,.7152,.0722],hp=[.4360747,.2225045,.0139322,.3850649,.7168786,.0971045,.1430804,.0606169,.7141733],mp=[3.1338561,-.9787684,.0719453,-1.6168667,1.9161415,-.2289914,-.4906146,.033454,1.4052427],gp=[3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252],pp=[1.0478112,.0295424,-.0092345,.0228866,.9904844,.0150436,-.050127,-.0170491,.7521316],j0=[.96422,1,.82521],yp=[.95047,1,1.08883];let ci=k0(3),pl=fp(3);const qt=1/255,Gt=1/256,bp={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32",transparent:"0000",rebeccapurple:"639"};let Ap={canvas:"fff",canvastext:"000",linktext:"001ee4",visitedtext:"4e2386",activetext:"eb3323",buttonface:"ddd",buttontext:"000",buttonborder:"000",field:"fff",fieldtext:"000",highlight:"bbd5fb",highlighttext:"000",mark:"000",marktext:"fff",graytext:"808080"};const Nt=t=>typeof t=="string",Ye=(t,e)=>t!=null&&typeof t[e]=="function",Qo=t=>t!=null&&typeof t!="function"&&t.length!==void 0,Xe=t=>typeof t=="number",Fi=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},wp=Fi(()=>"illegal argument(s)"),us=t=>{throw new wp(t)},_p=Math.PI,We=_p*2,Sp=1/We;let fs=1e-6;const Mt=t=>t-Math.floor(t),Rp=rn((t,e=3,n=",",s="[",i="]")=>{const r=typeof e=="number"?k0(e):e;switch(t){case 1:return o=>`${s}${r(o[0])}${i}`;case 2:return o=>`${s}${r(o[0])}${n}${r(o[1])}${i}`;case 3:return o=>`${s}${r(o[0])}${n}${r(o[1])}${n}${r(o[2])}${i}`;case 4:return o=>`${s}${r(o[0])}${n}${r(o[1])}${n}${r(o[2])}${n}${r(o[3])}${i}`;default:return o=>{const a=[];for(let l=0;l<o.length;l++)a.push(r(o[l]));return`${s}${a.join(n)}${i}`}}}),H0=(t,e,n,s,i,r)=>{const o=[];for(;n-- >0;)o.push(new t(e,s,i)),s+=r;return o},Ip=(t,e,n)=>t<e?e:t>n?n:t,x=t=>t<0?0:t>1?1:t,Ep=t=>t<-1?-1:t>1?1:t,vp=Fi(()=>"illegal arity"),Zo=t=>{throw new vp(t)};function Y0(...t){let[e,n,s,i,r,o,a,l,u,c]=t;switch(t.length){case 0:Zo(0);case 1:return e;case 2:return(...h)=>e(n(...h));case 3:return(...h)=>e(n(s(...h)));case 4:return(...h)=>e(n(s(i(...h))));case 5:return(...h)=>e(n(s(i(r(...h)))));case 6:return(...h)=>e(n(s(i(r(o(...h))))));case 7:return(...h)=>e(n(s(i(r(o(a(...h)))))));case 8:return(...h)=>e(n(s(i(r(o(a(l(...h))))))));case 9:return(...h)=>e(n(s(i(r(o(a(l(u(...h)))))))));case 10:default:const m=(...h)=>e(n(s(i(r(o(a(l(u(c(...h))))))))));return t.length===10?m:Y0(m,...t.slice(10))}}const Ui=t=>Ye(t,"xform")?t.xform():t;function X0(...t){return t=t.map(Ui),Y0.apply(null,t)}const Jo=t=>t!=null&&typeof t[Symbol.iterator]=="function",Ko=(t,e)=>[t[0],t[1],e],yr=Symbol(),yl=()=>{};class Zn{constructor(e){this.value=e}deref(){return this.value}}const $p=t=>new Zn(t),Qe=t=>t instanceof Zn,Np=t=>t instanceof Zn?t:new Zn(t),ui=t=>t instanceof Zn?t.deref():t,Mp=t=>t.length===2?[void 0,t[1]]:t.length===3?[t[1],t[2]]:Zo(t.length);function Op(...t){const e=t[0],n=e[0],s=e[1],i=e[2];t=Mp(t);const r=t[0]==null?n():t[0],o=t[1];return ui(s(Ye(o,"$reduce")?o.$reduce(i,r):Qo(o)?Dp(i,r,o):xp(i,r,o)))}const Dp=(t,e,n)=>{for(let s=0,i=n.length;s<i;s++)if(e=t(e,n[s]),Qe(e)){e=e.deref();break}return e},xp=(t,e,n)=>{for(let s of n)if(e=t(e,s),Qe(e)){e=e.deref();break}return e},W0=(t,e)=>[t,n=>n,e];function ta(t){return t?[...t]:W0(()=>[],(e,n)=>(e.push(n),e))}function*Gp(t,e){const n=Ui(t)(ta()),s=n[1],i=n[2];for(let r of e){const o=i([],r);if(Qe(o)){yield*ui(s(o.deref()));return}o.length&&(yield*o)}yield*ui(s([]))}function*Q0(t,e){const n=Ui(t)([yl,yl,(s,i)=>i])[2];for(let s of e){let i=n(yr,s);if(Qe(i)){i=ui(i.deref()),i!==yr&&(yield i);return}i!==yr&&(yield i)}}const Tp=(t,e,n=Q0)=>{const s=e.length-1;return Jo(e[s])?e.length>1?n(t.apply(null,e.slice(0,s)),e[s]):n(t(),e[0]):void 0};function Yt(t,e){return Jo(e)?Q0(Yt(t),e):n=>{const s=n[2];return Ko(n,(i,r)=>s(i,t(r)))}}function Z0(...t){return Tp(Z0,t)||(e=>{const n=e[2],s=t[0];let i=t[1]||0;return Ko(e,(r,o)=>n(r,s(i++,o)))})}function J0(t,e,n){return new Cp(t,e,n)}class Cp{constructor(e,n,s){e===void 0?(e=0,n=1/0):n===void 0&&(n=e,e=0),s=s===void 0?e<n?1:-1:s,this.from=e,this.to=n,this.step=s}*[Symbol.iterator](){let{from:e,to:n,step:s}=this;if(s>0)for(;e<n;)yield e,e+=s;else if(s<0)for(;e>n;)yield e,e+=s}$reduce(e,n){const s=this.step;if(s>0)for(let i=this.from,r=this.to;i<r&&!Qe(n);i+=s)n=e(n,i);else for(let i=this.from,r=this.to;i>r&&!Qe(n);i+=s)n=e(n,i);return n}}function zp(t,e){t=t||"";let n=!0;return e?[...e].join(t):W0(()=>"",(s,i)=>(s=n?s+i:s+t+i,n=!1,s))}function K0(t,e){return Jo(e)?Gp(K0(t),e):n=>{const s=n[2];let i=t;return Ko(n,(r,o)=>--i>0?s(r,o):i===0?Np(s(r,o)):$p(r))}}function ki(...t){return Bp(ki,Op,t)}const Bp=(t,e,n)=>{let s,i;switch(n.length){case 4:i=n[3],s=n[2];break;case 3:i=n[2];break;case 2:return Yt(r=>t(n[0],n[1],r));default:Zo(n.length)}return e(Ui(n[0])(n[1]),s,i)};function*fi(...t){const e=t.map(n=>n[Symbol.iterator]());for(;;){const n=[];for(let s of e){let i=s.next();if(i.done)return;n.push(i.value)}yield n}}const Lp=Fi(()=>"unsupported operation"),qi=t=>{throw new Lp(t)},Vi=(t=0)=>{const e=new Array(5);let n;const s=(...i)=>{const r=e[i[t].length]||n;return r?r(...i):qi(`no impl for vec size ${i[t].length}`)};return s.add=(i,r)=>e[i]=r,s.default=i=>n=i,s.impl=i=>e[i]||n,s},ea="o,a",Pp="o,a,b",Fp="o,a,b,c",Up="o,a,b,n",kp="io=0,ia=0,so=1,sa=1",qp="!o&&(o=[]);",tu="!a&&(a=[]);",na=(t="op")=>([e,n])=>`${e}=${t}(${n});`,Vp=(t="op")=>([e,n,s,i])=>`${e}=${t}(${n},${s},${i});`,eu=([t,e])=>`${t}*${e}`,jp=([t,e])=>`s+=${t}*${e};`,Hp=([t,e])=>`${t}=${e};`,Yp=([t,e,n])=>`${t}=${e}+(${n}-${e})*n;`,Xp=t=>e=>e>1?`${t}[i${t}+${e}*s${t}]`:e==1?`${t}[i${t}+s${t}]`:`${t}[i${t}]`,Wp=t=>Yt(Xp(t),J0()),Qp=t=>Yt(e=>`${t}[${e}]`,J0()),nu=(t,e,n,s="a",i="",r="",o="",a=!1)=>[r,ki(X0(K0(t),Z0((l,u)=>e(u,l))),zp(i),fi.apply(null,n.split(",").map(a?Wp:Qp))),o,s!==""?`return ${s};`:""],su=(t,e,n="a",s,i,r=!1)=>[s,"for(let i=a.length;--i>=0;) {",t(e.split(",").map(r?o=>`${o}[i${o}+i*s${o}]`:o=>`${o}[i]`)),"}",i,n!==null?`return ${n};`:""],iu=(t,e)=>`!${t} && (${t}=${e.split(",")[1]});`,sa=(t,e,n,s=n,i="a",r,o,a,l=!1)=>new Function(n,nu(t,e,s,i,r,o,a,l).join("")),ru=(t,e,n,s,i,r=i,o="a",a="",l,u,c=!1)=>new Function(s,`return (${i})=>{${nu(t,n,r,o,a,l,u,c).join("")}}`)(...e),ou=(t,e,n=e,s="a",i,r,o=!1)=>new Function(e,su(t,n,s,i,r,o).join("")),Zp=(t,e,n,s,i=s,r="a",o,a,l=!1)=>new Function(n,`return (${s})=>{${su(e,i,r,o,a,l).join("")}}`)(...t),au=(t,e=Pp,n,s="o",i=1,r)=>{n=n||e,r=r!=null?r:iu(s,e);const o=Vi(i),a=l=>o.add(l,sa(l,t,e,n,s,"",r));return o.default(ou(t,e,n,s,r)),[o,a(2),a(3),a(4)]},on=(t,e,n=ea,s,i="o",r=1,o)=>{const a=e||na("op");s=s||n,o=o!=null?o:iu(i,n);const l=Vi(r),u=c=>l.add(c,ru(c,[t],a,"op",n,s,i,"",o));return l.default(Zp([t],a,"op",n,s,i,o)),[l,u(2),u(3),u(4)]},[JA,KA,tw,Jp]=on(Ip,Vp(),Fp);on(x,na(),ea);on(Ep,na(),ea);const ia=(t,e,n,s=!0,i=!0)=>{const r=n>0?s?function(){return this.buf[this.offset+n*this.stride]}:function(){return this.buf[this.offset+n]}:function(){return this.buf[this.offset]},o=n>0?s?function(a){this.buf[this.offset+n*this.stride]=a}:function(a){this.buf[this.offset+n]=a}:function(a){this.buf[this.offset]=a};i&&Object.defineProperty(t,n,{get:r,set:o,enumerable:!0}),Object.defineProperty(t,e,{get:r,set:o,enumerable:!0})},Kp=(t,e,n,s)=>e.forEach((i,r)=>ia(t,i,r,n,s)),t2=Math.abs,Ze=(t,e,n=fs)=>t2(t-e)<=n,ra=t=>lu.add(t,ru(t,[Ze,fs],([e,n])=>`eq(${e},${n},eps)`,"eq,_eps","a,b,eps=_eps","a,b","","&&","return a.length === b.length && ",";")),lu=Vi();lu.default((t,e,n=fs)=>Ye(t,"eqDelta")?t.eqDelta(e,n):Ye(e,"eqDelta")?e.eqDelta(t,n):e2(t,e,t.length,n));ra(2);ra(3);const cu=ra(4),e2=(t,e,n,s=fs,i=0,r=0,o=1,a=1)=>{for(;n>0;n--,i+=o,r+=a)if(!Ze(t[i],e[r],s))return!1;return!0};function*n2(t,e,n,s){for(;e-- >0;)yield t[n],n+=s}const bl=1/2**32;class s2{float(e=1){return this.int()*bl*e}norm(e=1){return(this.int()*bl-.5)*2*e}minmax(e,n){return this.float()*(n-e)+e}minmaxInt(e,n){return e|=0,n|=0,e+(this.float()*(n-e)|0)}}const br=Math.random;class i2 extends s2{int(){return br()*4294967296>>>0}float(e=1){return br()*e}norm(e=1){return(br()-.5)*2*e}}const Zt=new i2,r2=(t=Zt,e=0,n=1)=>{let s,i,r;return()=>{if(s!=null)i=s,s=null;else do s=t.norm(),i=t.norm(),r=s*s+i*i;while(r>1||r===0);return e+n*i*Math.sqrt(-2*Math.log(r)/r)}},o2=t=>typeof t=="function",a2=t=>(t%=We,t<0?We+t:t),l2=(t,e)=>a2(Math.atan2(t,e)),gt=(t,e,n,s)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=s,t),U=(t,e,n,s,i)=>(!t&&(t=[]),t[0]=e,t[1]=n,t[2]=s,t[3]=i,t),oa=t=>uu.add(t,sa(t,eu,"a,b",void 0,"","+","return ",";")),uu=Vi();uu.default(ou(jp,"a,b",void 0,"s","let s=0;"));oa(2);const fu=oa(3);oa(4);const[ew,nw,sw,zn]=au(Hp,"o,a",void 0,"o",1,qp),[iw,rw,ow,c2]=au(Yp,Up),u2=Fi(()=>"Assertion failed"),fe=(typeof process<"u"&&process.env!==void 0?!!{}.UMBRELLA_ASSERTS:!!{}.VITE_UMBRELLA_ASSERTS)?(t,e)=>{if(typeof t=="function"&&!t()||!t)throw new u2(typeof e=="function"?e():e)}:()=>{},aa=t=>sa(t,eu,`o,a,${kp}`,"o,a","","+","return ",";",!0);aa(2);const Ar=aa(3),gs=aa(4),f2=(t,e,n)=>t+(e-t)*n,Al=(t,e)=>e!==0?t/e:0;on(Zt,([t])=>`${t}=rnd.minmax(n,m);`,"a,n=-1,m=1,rnd=op","a","a",0,tu);on(r2,([t])=>`${t}=rnd()*n;`,"a,rnd=op(),n=1","a","a",0,tu);const[d2,aw,lw,cw]=on(Zt,([t,e,n])=>`${t}=rnd.minmax(${e},${n});`,"o,a,b,rnd=op","o,a,b"),du=Array.isArray,Bn={},wl=(t,e)=>{for(let n in e){const s=e[n];if(du(s)){const[i,r,o,a]=s;e[n]=s.length===2?(l,u)=>r(l,i(l,u)):s.length===3?(l,u)=>o(l,r(l,i(l,u))):(l,u)=>a(l,o(l,r(l,i(l,u))))}}Bn[t]={...Bn[t],...e}},hu=(t,e,n,s)=>{const i=Bn[n];fe(!!i,`no conversions available for ${n}`);let r=i[s];return r?r(t,e):Bn.rgb[s]?i.rgb(t,Bn.rgb[s]([],e)):qi(`can't convert: ${s} -> ${n}`)},h2=t=>(t&3840)*4352|(t&240)*272|(t&15)*17,m2=t=>((t&61440)*69632|(t&3840)*4352|(t&240)*272|(t&15)*17)>>>0,Jn=(t,e)=>U(t||[],(e>>>16&255)*qt,(e>>>8&255)*qt,(e&255)*qt,(e>>>24)*qt),mu=(t,e)=>U(t||[],(e&255)*qt,(e>>>8&255)*qt,(e>>>16&255)*qt,(e>>>24)*qt),la=t=>{t=(Nt(t)?t:t.deref()).toLowerCase();const e=bp[t]||Ap[t];if(e||t[0]==="#")return new pn("srgb",Jn([],p2(e||t)));const n=t.split(/[(),/ ]+/),[s,i,r,o,a]=n;switch(fe(n.length===5||n.length===6,`invalid ${s} color: ${t}`),s){case"rgb":case"rgba":return new pn("srgb",[Fs(i),Fs(r),Fs(o),ps(a)]);case"hsl":case"hsla":return new pn("hsl",[_l(i),ys(r),ys(o),ps(a)]);case"lab":return new pn("lab50",[ys(i,!1),wr(r)*.01,wr(o)*.01,ps(a)]);case"lch":return new pn("lch",[ys(i,!1),wr(r)*.01,_l(o),ps(a)]);default:qi(`color mode: ${s}`)}},g2={rad:We,grad:400,turn:1,deg:360,undefined:360},_l=t=>{const e=/^(-?[0-9.]+)(deg|rad|grad|turn)?$/.exec(t);return fe(!!e,`expected hue, got: ${t}`),Mt(parseFloat(e[1])/g2[e[2]])},ps=t=>t?Fs(t,1):1,ys=(t,e=!0)=>{fe(/^([0-9.]+)%$/.test(t),`expected percentage, got: ${t}`);const n=parseFloat(t)/100;return e?x(n):n},wr=t=>(fe(/^-?[0-9.]+$/.test(t),`expected number, got: ${t}`),parseFloat(t)),Fs=(t,e=255,n=!0)=>{fe(/^-?[0-9.]+%?$/.test(t),`expected number or percentage, got: ${t}`);const s=parseFloat(t)/(t.endsWith("%")?100:e);return n?x(s):s},p2=t=>{const e=/^#?([0-9a-f]{3,8})$/i.exec(t);if(e){const n=e[1];switch(n.length){case 3:return(h2(parseInt(n,16))|4278190080)>>>0;case 4:return m2(parseInt(n,16))>>>0;case 6:return(parseInt(n,16)|4278190080)>>>0;case 8:return parseInt(n,16)>>>0}}return us(`invalid hex color: "${t}"`)},q=(t,e=1)=>t!=null?x(t):e,y2=t=>{if(typeof t[0]=="number")switch(t.length){case 1:return t.push(0,0,1),[t];case 2:return t.push(0,1),[t];case 3:return t.push(1),[t];default:return[t]}return t},_r=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Sr=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4),ji=(t,e)=>U(t||e,Sr(e[0]),Sr(e[1]),Sr(e[2]),q(e[3])),gu=(t,e)=>ji(null,Jn(t,e)),b2=(t,e)=>ji(null,mu(t,e)),Hi=t=>{const e=t.channels||{},n=t.order,s=n.length;n.reduce((h,b)=>(h[b]={range:[0,1],...e[b]},h),e);const i=n.map(h=>e[h].range[0]),r=n.map(h=>e[h].range[1]),o=zn([],i),a=zn([],r);o[s-1]=1;const l=n.findIndex(h=>!!e[h].hue),u=class{constructor(h,b=0,A=1){this.offset=b,this.stride=A,this.buf=h||[0,0,0,0],this.offset=b,this.stride=A}get mode(){return t.mode}get length(){return s}get range(){return[i,r]}get[Symbol.toStringTag](){return t.mode}[Symbol.iterator](){return n2(this.buf,this.length,this.offset,this.stride)}copy(){return new u(this.deref())}copyView(){return new u(this.buf,this.offset,this.stride)}empty(){return new u}deref(){return[this[0],this[1],this[2],this[3]]}set(h){return zn(this,h)}clamp(){return l>=0&&(this[l]=Mt(this[l])),Jp(null,this,i,r),this}eqDelta(h,b=fs){return cu(this,h,b)}randomize(h){return d2(this,o,a,h)}toJSON(){return this.deref()}toString(){return Rp(4,4)(this)}};Kp(u.prototype,n),wl(t.mode,t.from),wl("rgb",{[t.mode]:t.toRgb});const c=(h,b,A)=>{const N=new u(...A);return b!==t.mode?hu(N,h,t.mode,b):N.set(h)},m=(h,...b)=>h==null?new u:Nt(h)?m(la(h),...b):Qo(h)?Nt(h.mode)?c(h,h.mode,b):new u(h,...b):Ye(h,"deref")?c(h.deref(),h.mode,b):Xe(h)?b.length&&b.every(Xe)?new u(...y2([h,...b])):c(gu([],h),"rgb",b):us(`can't create a ${t.mode} color from: ${h}`);return m.class=u,m.range=[i,r],m.random=(h,b,A,N)=>new u(b,A,N).randomize(h),m.mapBuffer=(h,b=h.length/s|0,A=0,N=1,E=s)=>H0(u,h,b,A,N,E),m},yn=(t,e)=>{const{1:n,2:s}=e;return U(t||e,e[0],Math.hypot(n,s),n===0&&s===0?0:l2(s,n)*Sp,q(e[3]))},Yi=(t,e)=>{let{1:n,2:s}=e;s*=We;const i=q(e[3]);return n>0?U(t||e,e[0],Math.cos(s)*n,Math.sin(s)*n,i):U(t||e,e[0],0,0,i)},Rr=t=>{const e=t**3;return e>.008856?e:(t-16/116)/7.787},pu=(t,e,n=j0)=>{const s=(e[0]+.16)/1.16;return U(t||e,Rr(e[1]/5+s)*n[0],Rr(s)*n[1],Rr(s-e[2]/2)*n[2],q(e[3]))},yu=(t,e)=>pu(t,e,yp),Xi=(t,e,n,s=!1)=>{const i=Ar(e,n,0,0,3),r=Ar(e,n,1,0,3),o=Ar(e,n,2,0,3),a=q(n[3]);return s?U(t||n,x(i),x(r),x(o),a):U(t||n,i,r,o,a)},A2=(t,e,n,s=!0)=>{t=U(t||n,n[0],n[1],n[2],q(n[3]));const i=gs(t,e,0,0)+e[4],r=gs(t,e,0,5)+e[9],o=gs(t,e,0,10)+e[14],a=gs(t,e,0,15)+e[19];return s?U(t,x(i),x(r),x(o),x(a)):U(t,i,r,o,a)},ca=(t,e,n=mp)=>Xi(t,n,e),eo=(t,e)=>ca(t,e,gp),Je=(t,e)=>ca(null,pu(t,e)),bu=(t,e)=>eo(null,yu(t,e)),no=(t,e=V0)=>fu(t,e),ua=t=>fu(t,dp),w2=t=>((t>>>16&255)*76+(t>>>8&255)*150+(t&255)*29)/65025,_2=t=>((t>>>16&255)*29+(t>>>8&255)*150+(t&255)*76)/65025,S2=t=>w2(t[0]),R2=t=>_2(t[0]),fa=(t,e,n=1)=>(e=Mt(e)*6,U(t||[],x(Math.abs(e-3)-1),x(2-Math.abs(e-2)),x(2-Math.abs(e-4)),n)),so=(t,e,n=1)=>U(t||e,x(e[0]),x(e[1]),x(e[2]),q(e[3],n)),da=(t,e,n=1)=>U(t||e,Mt(e[0]),x(e[1]),x(e[2]),q(e[3],n)),Ln=(t,e)=>U(t||e,_r(e[0]),_r(e[1]),_r(e[2]),q(e[3])),Au=(t,e)=>{const n=e[0];let s=e[1];const i=e[2],r=fa(t||e,n,q(e[3])),o=no(r);return i<o?s*=i/o:o<1&&(s*=(1-i)/(1-o)),gt(r,x((r[0]-o)*s+i),x((r[1]-o)*s+i),x((r[2]-o)*s+i))},wu=(t,e)=>{t=da(t||e,e);const n=t[1],s=t[2];if(n<1e-6)return gt(t,s,s,s);const i=t[0]*6%6,r=s*(1-n),o=1-Math.abs(i%2-1);let a=3*s*n/(1+o);const l=a*o+r;switch(a+=r,i|0){case 0:return gt(t,a,l,r);case 1:return gt(t,l,a,r);case 2:return gt(t,r,a,l);case 3:return gt(t,r,l,a);case 4:return gt(t,l,r,a);case 5:return gt(t,a,r,l);default:return gt(t,r,r,r)}},I2=(t,e)=>{t=da(t||e,e);const n=t[1],s=t[2],i=(2-n)*s/2;return t[2]=i,t[1]=i&&i<1?n*s/(i<.5?i*2:2-i*2):n,t},_u=(t,e)=>{const n=x(e[1]),s=x(e[2]);t=fa(t||e,e[0],q(e[3]));const i=(1-Math.abs(2*s-1))*n;return gt(t,(t[0]-.5)*i+s,(t[1]-.5)*i+s,(t[2]-.5)*i+s)},Su=(t,e)=>{t=da(t||e,e);const n=t[1],s=t[2];return fa(t,e[0],t[3]),gt(t,((t[0]-1)*n+1)*s,((t[1]-1)*n+1)*s,((t[2]-1)*n+1)*s)},Ot=(t,e=0)=>(t<0?0:t>1?1:t)*255+.5<<e,Sl=Hi({mode:"srgb",order:["r","g","b","alpha"],from:{abgr32:(t,e)=>mu(t,e[0]),argb32:(t,e)=>Jn(t,e[0]),hcy:Au,hsi:wu,hsl:_u,hsv:Su,rgb:Ln},toRgb:ji}),Ru=t=>(q(t[3])*255+.5<<24|x(t[0])*255+.5<<16|x(t[1])*255+.5<<8|x(t[2])*255+.5)>>>0,E2=t=>(q(t[3])*255+.5<<24|x(t[2])*255+.5<<16|x(t[1])*255+.5<<8|x(t[0])*255+.5)>>>0;class Iu{constructor(e,n=0,s=1){this.offset=n,this.stride=s,this.buf=e||[0]}eqDelta(e,n){return cu(Jn([],this[0]),Jn([],e[0]),n)}get length(){return 1}get range(){return[[0],[4294967295]]}get alpha(){return(this[0]>>>24)/255}set alpha(e){this[0]=this[0]&16777215|Ot(e,24)}*[Symbol.iterator](){yield this[0]}deref(){return[this[0]]}randomize(e=Zt){const n=this[0];return this[0]=n&4278190080|e.int()&16777215,this}clamp(){return this}set(e){return this[0]=e[0],this}toJSON(){return[this[0]]}}class ze extends Iu{get mode(){return"argb32"}get r(){return(this[0]>>16&255)/255}set r(e){this[0]=this[0]&4278255615|Ot(e,16)}get g(){return(this[0]>>8&255)/255}set g(e){this[0]=this[0]&4294902015|Ot(e,8)}get b(){return(this[0]&255)/255}set b(e){this[0]=this[0]&4294967040|Ot(e)}copy(){return new ze([this[0]])}copyView(){return new ze(this.buf,this.offset,this.stride)}empty(){return new ze}}ia(ze.prototype,"value",0);class Be extends Iu{get mode(){return"abgr32"}get r(){return(this[0]&255)/255}set r(e){this[0]=this[0]&4294967040|Ot(e)}get g(){return(this[0]>>8&255)/255}set g(e){this[0]=this[0]&4294902015|Ot(e,8)}get b(){return(this[0]>>16&255)/255}set b(e){this[0]=this[0]&4278255615|Ot(e,16)}copy(){return new Be([this[0]])}copyView(){return new Be(this.buf,this.offset,this.stride)}empty(){return new Be}}ia(Be.prototype,"value",0);const Eu=(t,e)=>{const n=(s,...i)=>s==null?new t:Xe(s)?i.length&&i.every(Xe)?new t([Ru([s,...i])]):new t([s],...i):Nt(s)?n(la(s)):Qo(s)?Nt(s.mode)?new t([e(Sl(s))],...i):new t(s,...i):Ye(s,"deref")?new t([e(Sl(s))],...i):us(`can't create a ARGB32 color from: ${s}`);return n.class=t,n.range=[[0],[4294967295]],n.random=(s=Zt,i,r,o)=>new t(i,r,o).set([s.int()&16777215|4278190080]),n.mapBuffer=(s,i=s.length,r=0,o=1,a=1)=>H0(t,s,i,r,o,a),n},v2=Eu(ze,Ru);Eu(Be,E2);const $2=(t,e,n=hp)=>Xi(null,n,so(t,e)),Ir=t=>t>.00885645?Math.cbrt(t):7.787037*t+16/116,Ke=(t,e,n=j0)=>{const s=Ir(e[0]/n[0]),i=Ir(e[1]/n[1]),r=Ir(e[2]/n[2]);return U(t||e,1.16*i-.16,5*(s-i),2*(i-r),q(e[3]))},vu=(t,e)=>Ke(null,$2(t,e)),ha=(t,e)=>Xi(t,pp,e),$u=(t,e)=>Ke(t,ha(t,yu(t,e))),St=Hi({mode:"lab50",channels:{a:{range:[-.7929,.9355]},b:{range:[-1.1203,.9339]}},order:["l","a","b","alpha"],from:{rgb:vu,lch:Yi,lab65:$u,xyz50:Ke,xyz65:[ha,Ke]},toRgb:Je}),Kn=Hi({mode:"lch",channels:{c:{range:[0,1.312]},h:{hue:!0}},order:["l","c","h","alpha"],from:{rgb:(t,e)=>yn(null,vu(t,e)),lab50:yn,lab65:[$u,yn],xyz50:[Ke,yn],xyz65:[ha,Ke,yn]},toRgb:[Yi,Je]}),N2=[4.0767245293,-1.2681437731,-.0041119885,-3.3072168827,2.6093323231,-.7034763098,.2307590544,-.341134429,1.7068625689],M2=(t,{0:e,1:n,2:s,3:i})=>Xi(t,N2,[(e+.3963377774*n+.2158037573*s)**3,(e-.1055613458*n-.0638541728*s)**3,(e-.0894841775*n-1.291485548*s)**3,i]),O2=(t,e)=>{const{0:n,1:s,2:i}=e;return U(t||e,Al(i*n,s),i,Al(i*(1-n-s),s),q(e[3]))},D2=(t,e,n=V0)=>{const s=e[0],i=(2-2*n[2])*e[1],r=(2-2*n[0])*e[2];return U(t||e,s+r,s-n[2]/n[1]*i-n[0]/n[1]*r,s+i,q(e[3]))},I=Hi({mode:"rgb",order:["r","g","b","alpha"],from:{abgr32:(t,e)=>b2(t,e[0]),argb32:(t,e)=>gu(t,e[0]),hcy:Au,hsi:wu,hsl:_u,hsv:Su,lab50:Je,lab65:bu,lch:[Yi,Je],oklab:M2,rgb:zn,srgb:ji,xyy:[O2,eo],xyz50:ca,xyz65:eo,ycc:D2},toRgb:zn}),Nu=t=>{const e=ci(Mt(t[0])*360),n=pl(x(t[1])),s=pl(x(t[2])),i=q(t[3]);return i<1?`hsla(${e},${n},${s},${ci(i)})`:`hsl(${e},${n},${s})`},x2=t=>Nu(I2([],t)),Rl="0123456789abcdef",di=t=>Rl[t>>>4&15]+Rl[t&15],G2=t=>di(t>>>8)+di(t&255),Mu=t=>di(t>>>16)+G2(t),ma=rn((t,e,n="")=>{const s=U0("0",e);return i=>(i=(i>>>0).toString(t),n+(i.length<e?s.substring(i.length)+i:i))});ma(2,8);ma(2,16);ma(2,32);const Ou=Mu,io=t=>{const e=t>>>24;return e<255?`rgba(${t>>16&255},${t>>8&255},${t&255},${ci(e*qt)})`:`#${Ou(t&16777215)}`},Du=t=>(t&255)<<16|t>>16&255|t&4278255360,T2=Du,C2=Du,Te=t=>{const e=Ot(t[0]),n=Ot(t[1]),s=Ot(t[2]),i=q(t[3]);return i<1?`rgba(${e},${n},${s},${ci(i)})`:`#${Ou(e<<16|n<<8|s)}`},z2=t=>Te(Ln([],t)),Il={abgr32:t=>io(C2(t[0])),argb32:t=>io(t[0]),hsl:Nu,hsv:x2,lab50:t=>Te(Ln(null,Je([],t))),lab65:t=>Te(Ln(null,bu([],t))),lch:t=>Te(Ln(null,Je(null,Yi([],t)))),rgb:z2,srgb:Te},M=t=>{let e;return Nt(t)?t:Xe(t)?io(t):t.mode?(e=Il[t.mode])?e(t):Il.rgb(hu([],t,"rgb",t.mode)):Te(t)};var ro;(function(t){t[t.FINE=0]="FINE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.SEVERE=4]="SEVERE",t[t.NONE=5]="NONE"})(ro||(ro={}));const ga=Object.freeze({level:ro.NONE,fine(){},debug(){},info(){},warn(){},severe(){}});let B2=ga;const at=Symbol();function an(t,e,n){const s={},i=e?L2(e):{},r=(...o)=>{const a=t(...o),l=s[a]||Us(s,i,a)||s[at];return l?l(...o):qi(`missing implementation for: "${a.toString()}"`)};return r.add=(o,a)=>(s[o]&&B2.warn(`overwriting '${o.toString()}' impl`),s[o]=a,!0),r.addAll=o=>{let a=!0;for(let l in o)a=r.add(l,o[l])&&a;return at in o&&r.setDefault(o[at]),a},r.setDefault=o=>r.add(at,o),r.remove=o=>s[o]?(delete s[o],!0):!1,r.callable=(...o)=>{const a=t(...o);return!!(s[a]||Us(s,i,a)||s[at])},r.isa=(o,a)=>{let l=i[o];!l&&(i[o]=l=new Set),l.add(a)},r.impls=()=>{const o=new Set(Object.keys(s));for(let a in i)Us(s,i,a)&&o.add(a);return s[at]&&o.add(at),o},r.rels=()=>i,r.parents=o=>i[o],r.ancestors=o=>new Set(xu([],i,o)),r.dependencies=function*(){for(let o in i)for(let a of i[o])yield[o,a];for(let o in s)!i[o]&&(yield[o,void 0])},n&&r.addAll(n),r}const Us=(t,e,n)=>{const s=e[n];if(!!s)for(let i of s){let r=t[i]||Us(t,e,i);if(r)return r}},xu=(t,e,n)=>{const s=e[n];if(s)for(let i of s)t.push(i),xu(t,e,i);return t},L2=t=>{const e={};for(let n in t){const s=t[n];e[n]=s instanceof Set?s:Array.isArray(s)?new Set(s):new Set([s])}return e},Wi=t=>t.mode,Gu=(t,e)=>e.mode,El=(t,e,n)=>e!==0?t+n.norm(e):t,Ht=(t,e,n,s=x)=>e!==0?s(t+n.norm(e)):t,Tu=(t,e,n)=>Ht(t,e,n,Mt),Qi=(t,e,n)=>(s,i,r,o=Zt)=>U(s||i,t(i[0],r,o),e(i[1],r,o),n(i[2],r,o),q(i[3])),bs=Qi(Tu,Ht,Ht),P2=Qi(Ht,Ht,Ht),Er=Qi(Ht,El,El),F2=an(Gu,{},{hcy:bs,hsi:bs,hsl:bs,hsv:bs,lab50:Er,lab65:Er,lch:Qi(Ht,Ht,Tu),ycc:Er,[at]:P2}),vl=t=>t[t.length-1],U2=(t=Zt)=>t.float()<.5,k2=(t,e,n=Zt)=>{const s=t.length;fe(s>0,"no choices given");const i=e?t.map((o,a)=>[e[a]||0,o]).sort((o,a)=>a[0]-o[0]):t.map(o=>[1,o]),r=i.reduce((o,a)=>o+a[0],0);return r<=0&&console.warn("total weights <= 0"),()=>{const o=n.float(r);let a=r;for(let l=0;l<s;l++)if(a-=i[l][0],a<=o)return i[l][1]}},q2=(t,e=Gt)=>t[2]<=e,$l=(t,e=Gt)=>t[0]<=e&&t[1]<=e&&t[2]<=e,V2=(t,e=Gt)=>t[0]<=e,j2=an(Wi,{hcy:"hsv",hsi:"hsv",hsl:"hsv",labD50:"lch",labD65:"lch",srgb:"rgb",ycc:"rgb"},{hsv:q2,lch:V2,rgb:$l,[at]:t=>$l(I(t))}),H2=(t,e=Gt)=>t[1]<=e,Nl=(t,e=Gt)=>Ze(t[0],t[1],e)&&Ze(t[0],t[2],e),Y2=(t,e=Gt)=>Ze(t[1],0,e)&&Ze(t[2],0,e),X2=an(Wi,{hcy:"hsv",hsi:"hsv",hsl:"hsv",lch:"hsv",labD65:"labD50",srgb:"rgb",ycc:"labD50"},{hsv:H2,labD50:Y2,rgb:Nl,[at]:t=>Nl(I(t))}),W2=(t,e=Gt)=>t[1]<=e&&t[2]>=1-e,Ml=(t,e=Gt)=>(e=1-e,t[0]>=e&&t[1]>=e&&t[2]>=e),Q2=(t,e=Gt)=>t[1]<=e&&t[0]>=1-e,Z2=an(Wi,{hsl:"hsv",hsi:"hsv",labD50:"lch",labD65:"lch",srgb:"rgb",ycc:"lch"},{hcy:(t,e=Gt)=>t[1]<=e&&t[2]>=1-e,hsv:W2,lch:Q2,rgb:Ml,[at]:t=>Ml(I(t))}),Zi={light:{c:[[.3,.7]],l:[[.9,1]],b:[[.35,.5]],w:[[.6,1]]},dark:{c:[[.7,1]],l:[[.15,.4]],b:[[0,.4]],w:[[.4,.6]]},bright:{c:[[.75,.95]],l:[[.8,1]]},weak:{c:[[.15,.3]],l:[[.7,1]],b:[[.4,.6]],w:[[.8,1]]},neutral:{c:[[.25,.35]],l:[[.3,.7]],b:[[.25,.4]],w:[[.9,1]]},fresh:{c:[[.4,.8]],l:[[.8,1]],b:[[.05,.3]],w:[[.8,1]]},soft:{c:[[.2,.3]],l:[[.6,.9]],b:[[.05,.15]],w:[[.6,.9]]},hard:{c:[[.85,.95]],l:[[.4,1]]},warm:{c:[[.6,.9]],l:[[.4,.9]],b:[[.2,.3]],w:[[.8,1]]},cool:{c:[[.05,.2]],l:[[.9,1]],b:[[0,.95]],w:[[.95,1]]},intense:{c:[[.9,1]],l:[[.2,.35],[.8,1]]}},bn=[[0,1]],J2={h:bn,c:bn,l:bn,b:bn,w:bn,a:[[1,1]]},Cu={num:1/0,variance:.025,eps:.001,rnd:Zt},me=(t,e)=>e.minmax(...t[e.int()%t.length]),K2=(t,e)=>{t={...J2,...Nt(t)?Zi[t]:t};const{base:n,variance:s,rnd:i,eps:r}={...Cu,...e};let o,a,l,u;if(n){const c=Kn(n);o=c[2],u=q(c[3]),j2(c,r)?(a=0,l=me(t.b,i)):Z2(c,r)?(a=0,l=me(t.w,i)):X2(c,r)?(a=0,l=me(U2(i)?t.b:t.w,i)):o=Mt(o+i.norm(s))}else o=me(t.h,i),u=me(t.a,i);return Kn([l!=null?l:me(t.l,i),a!==void 0?a:me(t.c,i),o,u])},ty=(t,e)=>{let n;return du(t)?n=ey(t):Nt(t)?n=ny(t):(n={...t},n.weight==null&&(n.weight=1)),Nt(n.range)&&(n.range=Zi[n.range]),Nt(n.base)&&(n.base=Kn(la(n.base))),n.base!==void 0&&(e={...e,base:n.base}),{spec:n,opts:e}},ey=t=>{let e;const[n,...s]=t;return Xe(vl(s))?(e=vl(s),s.pop()):e=1,s.length===1?{range:n,base:s[0],weight:e}:s.length===0?Zi[n]?{range:n,weight:e}:{base:n,weight:e}:us(`invalid theme part: "${t}"`)},ny=t=>Zi[t]?{range:t,weight:1}:{base:t,weight:1};function*st(t,e={}){let{num:n,variance:s,rnd:i}={...Cu,...e};const r=t.map(a=>ty(a,e)),o=k2(r,r.map(a=>a.spec.weight),i);for(;--n>=0;){const{spec:a,opts:l}=o();a.range?yield K2(a.range,l):a.base&&(yield F2(Kn(),Kn(a.base),s,i))}}function sy(t,...e){let[n,s,i,r,o,a,l,u]=e;switch(e.length){case 1:return(...c)=>t(n,...c);case 2:return(...c)=>t(n,s,...c);case 3:return(...c)=>t(n,s,i,...c);case 4:return(...c)=>t(n,s,i,r,...c);case 5:return(...c)=>t(n,s,i,r,o,...c);case 6:return(...c)=>t(n,s,i,r,o,a,...c);case 7:return(...c)=>t(n,s,i,r,o,a,l,...c);case 8:return(...c)=>t(n,s,i,r,o,a,l,u,...c);default:us()}}const iy=()=>t=>t;function*zu(t,e=!0){if(t>0)for(let n=0,s=e?t+1:t;n<s;n++)yield n/t}function*ry(t,e=1/0){for(;e-- >0;)yield t}function*oy(t){const{min:e,max:n,num:s,init:i,mix:r,stops:o}=t,a=t.easing||(N=>N);let l=o.length;if(l<1)return;l===1&&(yield*ry(r(i(o[0][1],o[0][1]),0),s)),o.sort((N,E)=>N[0]-E[0]),o[l-1][0]<n&&o.push([n,o[l-1][1]]),o[0][0]>e&&o.unshift([e,o[0][1]]);const u=n-e;let c=o[0][0],m=o[1][0],h=m-c,b=i(o[0][1],o[1][1]),A=1;l=o.length;for(let N of zu(s)){if(N=e+u*N,N>m){for(;A<l&&N>o[A][0];)A++;c=o[A-1][0],m=o[A][0],h=m-c,b=i(o[A-1][1],o[A][1])}yield r(b,a(h!==0?(N-c)/h:0))}}const ay=(t,e)=>ki(Yt(([n,s,i,r])=>x(n+s*Math.cos(We*(i*e+r)))),ta(),fi(...t)),Ol=(t,e,n)=>ki(X0(Yt(sy(ay,e)),n?Yt(n):iy()),ta(),zu(t-1)),Dl=(t,e)=>{t=so([],t),e=so([],e);const n=[...Yt(([s,i])=>.5*(s-i),fi(t,e))];return[[...Yt(([s,i])=>s-i,fi(t,n))],n,[-.5,-.5,-.5,-.5],[0,0,0,0]]},Bu=(t,e,n,s)=>(i,r,o,a)=>U(i||r,t(r[0],o[0],a),e(r[1],o[1],a),n(r[2],o[2],a),s(r[3],o[3],a)),Lu=(t,e,n)=>{t=Mt(t),e=Mt(e);const s=e-t;return Mt(t+(Math.abs(s)>.5?s<0?s+1:-(1-s):s)*n)},Le=f2,As=Bu(Lu,Le,Le,Le),ly=Bu(Le,Le,Lu,Le),cy=an(Gu,{},{hcy:As,hsi:As,hsl:As,hsv:As,lch:ly,[at]:c2});function Rt(t,e){const n=[...uy(t)];if(e===void 0)return n;const s=n.map(i=>v2(i)[0]);return e?s.map(T2):s}const uy=({num:t,stops:e,easing:n,mix:s})=>oy({num:t-1,stops:e,easing:n,min:0,max:1,init:(i,r)=>[i,r],mix:s?([i,r],o)=>s(i.empty(),i,r,o):([i,r],o)=>cy(i.empty(),i,r,o)}),Z=an(Wi,{lch:"lab",oklab:"lab",ycc:"lab",xyy:"hcy"},{argb32:S2,abgr32:R2,hcy:t=>t[2],lab:t=>t[0],rgb:no,srgb:ua,xyz:t=>t[1],[at]:t=>no(I(t))}),Pu=(t,e)=>t===e?0:t==null?e==null?0:-1:e==null?t==null?0:1:typeof t.compare=="function"?t.compare(e):typeof e.compare=="function"?-e.compare(t):t<e?-1:t>e?1:0,it=(t,e,n)=>{const s=t[e];t[e]=t[n],t[n]=s},fy=(...t)=>{const[e,n,s]=t,i=t.length;switch(i){case 0:return it;case 1:return(r,o,a)=>{it(r,o,a),it(e,o,a)};case 2:return(r,o,a)=>{it(r,o,a),it(e,o,a),it(n,o,a)};case 3:return(r,o,a)=>{it(r,o,a),it(e,o,a),it(n,o,a),it(s,o,a)};default:return(r,o,a)=>{it(r,o,a);for(let l=i;l-- >0;)it(t[l],o,a)}}};function oo(t,e=Pu,n=it,s=0,i=t.length-1){if(s<i){const r=t[s+(i-s>>1)];let o=s-1,a=i+1;for(;;){do o++;while(e(t[o],r)<0);do a--;while(e(t[a],r)>0);if(o>=a)break;n(t,o,a)}oo(t,e,n,s,a),oo(t,e,n,a+1,i)}return t}const dy=(t,e,n=Pu)=>{const s=o2(e)?t.map(e):e;return fe(s.length===t.length,"keys.length != src.length"),oo(s,n,fy(t)),t},hy=(t,e)=>t-e,my=(t,e)=>e-t,Fu=(t,e,n=!1)=>dy(t,e,n?my:hy),An=.072,wn=.213,gy=.285,_n=.715,py=.787,yy=.928,xl=A2,Gl=t=>[wn+py*t,_n-_n*t,An-An*t,0,0,wn-wn*t,_n+gy*t,An-An*t,0,0,wn-wn*t,_n-_n*t,An+yy*t,0,0,0,0,0,1,0];class by{constructor(e,n,s){this.preset=e,this.agentManager=n,this.images=s}getAngle(e){return this.preset.vector_field.getValue(e,this.agentManager,this.images)}getAngleAt(e,n){return this.preset.vector_field.getValueAt(e,n)}getColor(e){return this.getColorAttrib(e,"stroke",this.preset.stroke)}getWeight(e){return this.getFloatAttrib(e,"weight",this.preset.weight)}getAlpha(e){return this.getFloatAttrib(e,"alpha",this.preset.alpha)}getFloatAttrib(e,n,s){const{getValue:i,persistent:r,type:o,values:a}=s;if(r&&e.fixedAttribs[n]!==void 0)return e.fixedAttribs[n];let l=0;return l=i(e,this.agentManager,this.images),r&&(e.fixedAttribs[n]=l),l}getColorAttrib(e,n,s){const{getValue:i,values:r,persistent:o,type:a}=s;if(o&&e.fixedAttribs[n]!==void 0)return e.fixedAttribs[n];let l="#000000";return l=i(e,this.agentManager,this.images),o&&(e.fixedAttribs[n]=l),l}getAttribs(e){return{stroke:e.fixedAttribs.stroke?e.fixedAttribs.stroke:this.getColor(e),weight:e.fixedAttribs.weight?e.fixedAttribs.weight:this.getWeight(e),alpha:e.fixedAttribs.alpha?e.fixedAttribs.alpha:this.getAlpha(e)}}getStyleAttribs(e){const n=this.preset.style.getValue(e,this.agentManager,this.images);return{type:n.type?n.type:"line",alphaDecay:n.alphaDecay?n.alphaDecay:s=>s,maxLength:n.maxLength?n.maxLength:.1,grainsFactor:n.grainsFactor?n.grainsFactor:1,minAlpha:n.minAlpha?n.minAlpha:0,maxAlpha:n.maxAlpha,followBounds:n.followBounds?n.followBounds:!1,weightFactor:n.weightFactor?n.weightFactor:1,doubleSided:n.doubleSided,...this.getAttribs(e)}}}const Ji=(t,e={})=>{const n=Reflect.ownKeys(t),s=Reflect.ownKeys(e),i=Symbol("isa");function r(o){for(let a of n){const l=Object.getOwnPropertyDescriptor(o.prototype,a);(!l||l.configurable)&&Object.defineProperty(o.prototype,a,{value:t[a],writable:!0})}return Object.defineProperty(o.prototype,i,{value:!0}),o}for(let o of s)Object.defineProperty(r,o,{value:e[o],enumerable:e.propertyIsEnumerable(o)});return Object.defineProperty(r,Symbol.hasInstance,{value:o=>!!o[i]}),r};Ji({order(){return[0]},includes(t){return t>=0&&t<this.size[0]},indexAt(t){return this.includes(t)?this.indexAtUnsafe(t):-1},indexAtUnsafe(t){return this.offset+(t|0)*this.stride[0]},getAt(t){return this.includes(t)?this.data[this.indexAtUnsafe(t)]:0},getAtUnsafe(t){return this.data[this.indexAtUnsafe(t)]},setAt(t,e){return this.includes(t)?(this.data[this.indexAtUnsafe(t)]=e,!0):!1},setAtUnsafe(t,e){return this.data[this.indexAtUnsafe(t)]=e,!0}});const Uu=Ji({order(){return Math.abs(this.stride[1])>Math.abs(this.stride[0])?[1,0]:[0,1]},includes(t,e){const n=this.size;return t>=0&&t<n[0]&&e>=0&&e<n[1]},indexAt(t,e){return this.includes(t,e)?this.indexAtUnsafe(t,e):-1},indexAtUnsafe(t,e){return this.offset+(t|0)*this.stride[0]+(e|0)*this.stride[1]},getAt(t,e){return this.includes(t,e)?this.data[this.indexAtUnsafe(t,e)]:0},getAtUnsafe(t,e){return this.data[this.indexAtUnsafe(t,e)]},setAt(t,e,n){return this.includes(t,e)?(this.data[this.indexAtUnsafe(t,e)]=n,!0):!1},setAtUnsafe(t,e,n){return this.data[this.indexAtUnsafe(t,e)]=n,!0}});Ji({order(){return ku(this.stride)},includes(t,e,n){const s=this.size;return t>=0&&t<s[0]&&e>=0&&e<s[1]&&n>=0&&n<s[2]},indexAt(t,e,n){return this.includes(t,e,n)?this.indexAtUnsafe(t,e,n):-1},indexAtUnsafe(t,e,n){const s=this.stride;return this.offset+(t|0)*s[0]+(e|0)*s[1]+(n|0)*s[2]},getAt(t,e,n){return this.includes(t,e,n)?this.data[this.indexAtUnsafe(t,e,n)]:0},getAtUnsafe(t,e,n){return this.data[this.indexAtUnsafe(t,e,n)]},setAt(t,e,n,s){return this.includes(t,e,n)?(this.data[this.indexAtUnsafe(t,e,n)]=s,!0):!1},setAtUnsafe(t,e,n,s){return this.data[this.indexAtUnsafe(t,e,n)]=s,!0}});Ji({order(){return ku(this.stride)},includes(t,e,n,s){const i=this.size;return t>=0&&t<i[0]&&e>=0&&e<i[1]&&n>=0&&n<i[2]&&s>=0&&s<i[3]},indexAt(t,e,n,s){return this.includes(t,e,n,s)?this.indexAtUnsafe(t,e,n,s):-1},indexAtUnsafe(t,e,n,s){const i=this.stride;return this.offset+(t|0)*i[0]+(e|0)*i[1]+(n|0)*i[2]+(s|0)*i[3]},getAt(t,e,n,s){return this.includes(t,e,n,s)?this.data[this.indexAtUnsafe(t,e,n,s)]:0},getAtUnsafe(t,e,n,s){return this.data[this.indexAtUnsafe(t,e,n,s)]},setAt(t,e,n,s,i){return this.includes(t,e,n,s)?(this.data[this.indexAtUnsafe(t,e,n,s)]=i,!0):!1},setAtUnsafe(t,e,n,s,i){return this.data[this.indexAtUnsafe(t,e,n,s)]=i,!0}});const ku=t=>[...t].map((e,n)=>[e,n]).sort((e,n)=>Math.abs(n[0])-Math.abs(e[0])).map(e=>e[1]);var Ay=Object.defineProperty,wy=Object.getOwnPropertyDescriptor,_y=(t,e,n,s)=>{for(var i=s>1?void 0:s?wy(e,n):e,r=t.length-1,o;r>=0;r--)(o=t[r])&&(i=(s?o(e,n,i):o(i))||i);return s&&i&&Ay(e,n,i),i};let ao=class{constructor(t,e,n,s=void 0,i=(r,o)=>{}){G(this,"size");G(this,"stride");G(this,"conversionFactor");G(this,"data",[]);G(this,"freeValue");G(this,"agents",[]);this.space=n,this.data=new Array(t*e).fill(s),this.size=[t,e],this.stride=[1,t],this.conversionFactor=[t/n.size[0],e/n.size[1]],this.freeValue=s;for(let r=0;r<t;r++)for(let o=0;o<e;o++)this.setAtUnsafe(r,o,i(r,o))}clear(){const[t,e]=this.size;for(let n=0;n<t;n++)for(let s=0;s<e;s++)this.setAtUnsafe(n,s,this.freeValue)}setAgents(t){this.agents=t}fromSpaceToGrid(t){return[Math.floor(t[0]*this.conversionFactor[0]),Math.floor(t[1]*this.conversionFactor[1])]}fromGridToSpace(t){return[t[0]/this.conversionFactor[0],t[1]/this.conversionFactor[1]]}checkCollision(t,e,n=!1,s=!1){const i=this.fromSpaceToGrid(t.getPos());return this.isCellFree(i[0],i[1],e,t)?(s&&this.setAt(i[0],i[1],t),!1):!0}isCellFree(t,e,n,s){if(this.includes(t,e)){const i=this.getAt(t,e);return i===this.freeValue||s!==void 0&&i===s}}randomFree(t,e){let n=0;for(;n<1e4;){const s=rl(t,1,f);if(s&&s.length>0){const i=this.fromSpaceToGrid(s[0]);if(this.isCellFree(Math.floor(i[0]),Math.floor(i[1]),0))return{pos:s[0],agent:void 0};n++}}return{pos:void 0,agent:void 0}}freeLine(t,e,n,s,i){const r=s*Math.min(this.width,this.height),o=To([],n,1),a=this.fromSpaceToGrid(e);let l=Ue([],a,o),u=this.fromGridToSpace(l),c=0;for(;(i?ai(i,u):!0)&&this.isCellFree(Math.floor(l[0]),Math.floor(l[1]),0,t)&&c<r;)l=Ue([],l,o),u=this.fromGridToSpace(l),c++;return[u[0],u[1]]}randomOccupied(t,e="random point"){let n=0;for(;n<1e4;){if(e==="random point"){const s=rl(t,1,f);if(s){const i=this.fromSpaceToGrid(s[0]);if(!this.isCellFree(Math.floor(i[0]),Math.floor(i[1]),0))return{pos:[s[0][0],s[0][1]],agent:this.getAt(Math.floor(i[0]),Math.floor(i[1]))}}}else if(this.agents.length>0){const s=C(this.agents,this.agents.map(i=>i.spaceTraveled),f);if(s.spaceTraveled>0){const i=C(s.line,s.lengths,f);if(i.points.length>1){const r=d(i.points,f);if(ai(t,r))return{agent:s,pos:[r[0]+f.minmax(-.001,.001),r[1]+f.minmax(-.001,.001)]}}}}n++}return{pos:void 0,agent:void 0}}setAtUnsafe(t,e,n){}setAt(t,e,n){}getAt(t,e){}getAtUnsafe(t,e){}includes(t,e){}get width(){return this.size[0]}get height(){return this.size[1]}get offset(){return 0}};ao=_y([Uu],ao);const Sy=(t,e,n,s=window.devicePixelRatio||1)=>(s!==1&&(t.style.width=`${e}px`,t.style.height=`${n}px`),t.width=e*s,t.height=n*s,s);var bt;(function(t){t[t.ALPHA=0]="ALPHA",t[t.BLUE=1]="BLUE",t[t.GREEN=2]="GREEN",t[t.RED=3]="RED"})(bt||(bt={}));const hi=(t,e=t,n,s={})=>{const i=document.createElement("canvas");return i.width=t,i.height=e,n&&n.appendChild(i),s.pixelated&&(i.style.imageRendering="pixelated"),{canvas:i,ctx:i.getContext("2d",s.ctx)}};function Ry(t,e){let n,s;if(H(t)){const o=hi(t,e);n=o.canvas,s=o.ctx}else n=t,s=n.getContext("2d");const i=s.getImageData(0,0,n.width,n.height),r=new Uint32Array(i.data.buffer);return{canvas:n,ctx:s,img:i,data:r}}const Iy=(t,e,n=e,s)=>{const i=H(e)?hi(e,n,s):hi(t.width,t.height,s);return i.ctx.drawImage(t,0,0,i.canvas.width,i.canvas.height),i},Ey=async(t,e="anonymous")=>{const n=new Image;return n.crossOrigin=e,n.src=t,await n.decode(),n},vy=(t,e,n,s=1)=>At(t.length>=e*n*s,"pixel buffer too small"),ws=(t,e)=>{const n=t.channels[e];return At(n!=null,`invalid channel ID: ${e}`),n},$y=t=>At(!!t.alpha,"missing alpha channel");function pa(t,e,n,s){var i=arguments.length,r=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(t,e,n,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(i<3?o(r):i>3?o(e,n,r):o(e,n))||r);return i>3&&r&&Object.defineProperty(e,n,r),r}const Ny=t=>{const e=(t>>>24)/255;return t&4278190080|(t>>>16&255)*e<<16|(t>>>8&255)*e<<8|(t&255)*e},My=t=>{const e=(t>>>24)/255;return e>0?(t&4278190080|Math.min(255,(t>>>16&255)/e)<<16|Math.min(255,(t>>>8&255)/e)<<8|Math.min(255,(t&255)/e))>>>0:t},Oy=t=>{const e=t>>>24;return(t>>>16&255)<=e&&(t>>>8&255)<=e&&(t&255)<=e},Dy=t=>((t>>>16&255)*29+(t>>>8&255)*150+(t&255)*76)/255,lo=(t,e,n,s,i,r,o=0,a=0)=>(t|=0,e|=0,n|=0,s|=0,t<0&&(n+=t,o-=t,t=0),e<0&&(s+=e,a-=e,e=0),[t,e,le(n,0,i-t),le(s,0,r-e),o,a]),Tl=(t,e,n={})=>{const s=t.width,i=e.width;let r,o,a,l,u,c;return[r,o,u,c]=lo(n.sx||0,n.sy||0,n.w||s,n.h||t.height,s,t.height),[a,l,u,c,r,o]=lo(n.dx||0,n.dy||0,u,c,i,e.height,r,o),{sx:r,sy:o,dx:a,dy:l,rw:u,rh:c}},xy=(t,e,n)=>{for(let s=t.length;s-- >0;)t[s]=n(t[s],e)},Gy=(t,e,n,s)=>{for(let i=t.length;i-- >0;)t[i]=s(t[i],n(e[i]))},Ty=(t,e,n,s,i)=>{const r=~i;for(let o=t.length;o-- >0;)t[o]=t[o]&r|n(s(e[o]))&i},Cl=(t,e,n)=>{const s=e.fromABGR,i=e.toABGR;for(let r=t.length;r-- >0;)t[r]=s(n(i(t[r])))},co=(t,e)=>e>0?`(${t} << ${e})`:e<0?`(${t} >>> ${-e})`:`${t}`,ya=(t,e)=>co(t,-e),qu=t=>`0x${t.toString(16)}`,Cy=t=>{const e=8-t,n=(1<<t)-1;return new Function("luma",`return (x) => ${ya("luma(x)",e)} & ${n};`)(Dy)},zy=t=>{let e;if(t!==8){const n=(1<<t)-1,s=255/n;e=`(((x & ${n}) * ${s}) | 0)`}else e="x";return new Function("x",`return 0xff000000 | (${e} * 0x010101);`)},By=t=>new Function("x","return ("+t.map(e=>{const n=e.abgrShift+(8-e.size);return`(${ya("x",n)} & ${qu(e.maskA)})`}).join(" | ")+") >>> 0;"),Ly=(t,e)=>{const n=t.map(i=>{if(i.size!==8){const r=i.mask0,o=255/r,a=ya("x",i.shift);return co(`((${a} & ${r}) * ${o})`,24-i.lane*8)}else return co(`(x & ${qu(i.maskA)})`,i.abgrShift)}).join(" | "),s=e?"":"0xff000000 | ";return new Function("x",`return (${s}${n}) >>> 0;`)},Py=(t,e,n)=>{const s=1<<t.size,i=s-1,r=i<<n>>>0,o=~r>>>0,a=t.lane!=null?t.lane:e,l=c=>c>>>n&i,u=(c,m)=>c&o|(m&i)<<n;return{size:t.size,num:s,abgrShift:24-a*8-n,lane:a,shift:n,mask0:i,maskA:r,int:l,setInt:u,float:c=>l(c)/i,setFloat:(c,m)=>u(c,F(m)*i)}},ba=t=>{At(t.channels.length>0,"no channel specs given");const e=t.channels.reduce(([n,s],i,r)=>(s-=i.size,n.push(Py(i,r,s)),[n,s]),[[],t.size])[0];return{__packed:!0,type:t.type,size:t.size,alpha:t.alpha||0,channels:e,fromABGR:t.fromABGR||By(e),toABGR:t.toABGR||Ly(e,!!t.alpha)}},uo=ba({type:"u32",size:32,alpha:8,channels:[{size:8,lane:bt.ALPHA},{size:8,lane:bt.BLUE},{size:8,lane:bt.GREEN},{size:8,lane:bt.RED}],fromABGR:t=>t,toABGR:t=>t});function Fy(t,e="linear",n="clamp"){const s=!!t.format.__float,i=t.format.channels.length===1?"1":"",r=`${e[0]}${n[0]}${i}`,o=(s?{nc1:_s,nw1:Ss,nr1:Rs,nc:_s,nw:Ss,nr:Rs,lc1:a=>vr(te(a)),lw1:a=>vr(ee(a)),lr1:a=>vr(ne(a)),lc:a=>Nr(a,_s(a)),lw:a=>Nr(a,Ss(a)),lr:a=>Nr(a,Rs(a)),cc1:a=>Or(te(a)),cw1:a=>Or(ee(a)),cr1:a=>Or(ne(a)),cc:a=>xr(a,_s(a)),cw:a=>xr(a,Ss(a)),cr:a=>xr(a,Rs(a))}:{nc1:te,nw1:ee,nr1:ne,nc:te,nw:ee,nr:ne,lc1:a=>ks(te(a)),lw1:a=>ks(ee(a)),lr1:a=>ks(ne(a)),lc:a=>$r(a,te(a)),lw:a=>$r(a,ee(a)),lr:a=>$r(a,ne(a)),cc1:a=>Mr(a,te(a)),cw1:a=>Mr(a,ee(a)),cr1:a=>Mr(a,ne(a)),cc:a=>Dr(a,te(a)),cw:a=>Dr(a,ee(a)),cr:a=>Dr(a,ne(a))})[r];return At(!!o,`missing impl for ${r}`),o(t)}const te=({data:t,width:e,height:n})=>(s,i)=>s>=0&&s<e&&i>=0&&i<n?t[(i|0)*e+(s|0)]:0,ee=({data:t,width:e,height:n})=>(s,i)=>t[ni(i|0,n)*e+ni(s|0,e)],ne=({data:t,width:e,height:n})=>{const s=e-1,i=n-1;return(r,o)=>t[le(o|0,0,i)*e+le(r|0,0,s)]},_s=({data:t,width:e,height:n,stride:[s,i]})=>(r,o)=>{let a;return r>=0&&r<e&&o>=0&&o<n?(a=(o|0)*i+(r|0)*s,t.slice(a,a+s)):[0]},Ss=({data:t,width:e,height:n,stride:[s,i]})=>(r,o)=>{let a=ni(o|0,n)*i+ni(r|0,e)*s;return t.slice(a,a+s)},Rs=({data:t,width:e,height:n,stride:[s,i]})=>{const r=e-1,o=n-1;return(a,l)=>{let u=le(l|0,0,o)*i+le(a|0,0,r)*s;return t.slice(u,u+s)}},En=(t,e,n,s,i=4)=>s0(t[s],t[s+i],t[s+2*i],t[s+3*i],e,n),ks=t=>(e,n)=>(e-=.5,n-=.5,s0(t(e,n),t(e+1,n),t(e,n+1),t(e+1,n+1),Q(e),Q(n))),vr=t=>(t=ks(t),(e,n)=>[t(e,n)]),$r=(t,e)=>{const{fromABGR:n,toABGR:s}=t.format,i=new Uint32Array(4),r=new Uint8Array(i.buffer);return(o,a)=>{o-=.5,a-=.5,i[0]=s(e(o,a)),i[1]=s(e(o+1,a)),i[2]=s(e(o,a+1)),i[3]=s(e(o+1,a+1));const l=Q(o),u=Q(a);return n(En(r,l,u,0)|En(r,l,u,1)<<8|En(r,l,u,2)<<16|En(r,l,u,3)<<24)>>>0}},Nr=({stride:[t]},e)=>{const n=new Float32Array(t*4);return(s,i)=>{s-=.5,i-=.5,n.set(e(s,i),0),n.set(e(s+1,i),t),n.set(e(s,i+1),t*2),n.set(e(s+1,i+1),t*3);const r=Q(s),o=Q(i);let a=[];for(let l=0;l<t;l++)a.push(En(n,r,o,l,t));return a}},Vu=t=>(e,n)=>{e-=.5,n-=.5;const s=e-1,i=e+1,r=e+2,o=n-1,a=n+1,l=n+2;return i0(t(s,o),t(e,o),t(i,o),t(r,o),t(s,n),t(e,n),t(i,n),t(r,n),t(s,a),t(e,a),t(i,a),t(r,a),t(s,l),t(e,l),t(i,l),t(r,l),Q(e),Q(n))},Mr=(t,e)=>{const n=t.format.channels[0].mask0;return e=Vu(e),(s,i)=>le(e(s,i),0,n)},Or=t=>(t=Vu(t),(e,n)=>[t(e,n)]),ju=(t,e,n,s,i=4)=>i0(t[s],t[s+i],t[s+2*i],t[s+3*i],t[s+4*i],t[s+5*i],t[s+6*i],t[s+7*i],t[s+8*i],t[s+9*i],t[s+10*i],t[s+11*i],t[s+12*i],t[s+13*i],t[s+14*i],t[s+15*i],e,n),Is=(t,e,n,s,i=4)=>le(ju(t,e,n,s,i),0,255),Dr=(t,e)=>{const{fromABGR:n,toABGR:s}=t.format,i=new Uint32Array(16),r=new Uint8Array(i.buffer);return(o,a)=>{o-=.5,a-=.5;const l=o-1,u=o+1,c=o+2,m=a-1,h=a+1,b=a+2,A=Q(o),N=Q(a);return i[0]=s(e(l,m)),i[1]=s(e(o,m)),i[2]=s(e(u,m)),i[3]=s(e(c,m)),i[4]=s(e(l,a)),i[5]=s(e(o,a)),i[6]=s(e(u,a)),i[7]=s(e(c,a)),i[8]=s(e(l,h)),i[9]=s(e(o,h)),i[10]=s(e(u,h)),i[11]=s(e(c,h)),i[12]=s(e(l,b)),i[13]=s(e(o,b)),i[14]=s(e(u,b)),i[15]=s(e(c,b)),n(Is(r,A,N,0)|Is(r,A,N,1)<<8|Is(r,A,N,2)<<16|Is(r,A,N,3)<<24)>>>0}},xr=({stride:[t]},e)=>{const n=new Float32Array(t*16);return(s,i)=>{s-=.5,i-=.5;const r=s-1,o=s+1,a=s+2,l=i-1,u=i+1,c=i+2,m=Q(s),h=Q(i);n.set(e(r,l),0),n.set(e(s,l),t),n.set(e(o,l),2*t),n.set(e(a,l),3*t),n.set(e(r,i),4*t),n.set(e(s,i),5*t),n.set(e(o,i),6*t),n.set(e(a,i),7*t),n.set(e(r,u),8*t),n.set(e(s,u),9*t),n.set(e(o,u),10*t),n.set(e(a,u),11*t),n.set(e(r,c),12*t),n.set(e(s,c),13*t),n.set(e(o,c),14*t),n.set(e(a,c),15*t);let b=[];for(let A=0;A<t;A++)b.push(ju(n,m,h,A,t));return b}};var De;function Uy(...t){return t[0]instanceof ts?t[0].as(t[1]):new ts(...t)}const ky=(t,e,n,s=n)=>qy(Iy(t,n,s).canvas,e),qy=(t,e=uo)=>{const n=Ry(t),s=t.width,i=t.height;let r;if(e===uo)r=n.data;else{r=Hr(e.type,s*i);const o=n.data,a=e.fromABGR;for(let l=r.length;l-- >0;)r[l]=a(o[l])}return new ts(s,i,e,r)};let ts=De=class{constructor(e,n,s=uo,i){this.size=[e,n],this.stride=[1,e],this.format=s.__packed?s:ba(s),this.data=i||Hr(s.type,e*n)}get pixels(){return this.data}get width(){return this.size[0]}get height(){return this.size[1]}get offset(){return 0}get dim(){return 2}as(e){return this.getRegion(0,0,this.width,this.height,e)}copy(){const e=this.empty();return e.data.set(this.data),e}empty(){return new De(this.width,this.height,this.format)}order(){}includes(e,n){}indexAt(e,n){}indexAtUnsafe(e,n){}getAt(e,n){}getAtUnsafe(e,n){}setAt(e,n,s){}setAtUnsafe(e,n,s){}getChannelAt(e,n,s,i=!1){const r=ws(this.format,s),o=this.getAt(e,n);return i?r.float(o):r.int(o)}setChannelAt(e,n,s,i,r=!1){const o=ws(this.format,s),a=this.getAt(e,n);return r?o.setFloat(a,i):o.setInt(a,i),this}blend(e,n,s){let i=this.width,r=n.width;const{sx:o,sy:a,dx:l,dy:u,rw:c,rh:m}=Tl(this,n,s);if(c<1||m<1)return n;const h=this.data,b=n.data,A=this.format.toABGR,N=n.format.toABGR,E=n.format.fromABGR;for(let D=(o|0)+(a|0)*i,W=(l|0)+(u|0)*r,he=0;he<m;he++,D+=i,W+=r)for(let Ct=0;Ct<c;Ct++)b[W+Ct]=E(e(A(h[D+Ct]),N(b[W+Ct])));return n}blit(e,n){let s=this.width,i=e.width;const{sx:r,sy:o,dx:a,dy:l,rw:u,rh:c}=Tl(this,e,n);if(u<1||c<1)return e;const m=this.data,h=e.data,b=this.format.toABGR,A=e.format.fromABGR,N=this.format!==e.format?(E,D)=>{for(let W=0;W<u;W++)h[D+W]=A(b(m[E+W]))}:(E,D)=>h.set(m.subarray(E,E+u),D);for(let E=(r|0)+(o|0)*s,D=(a|0)+(l|0)*i,W=0;W<c;W++,E+=s,D+=i)N(E,D);return e}blitCanvas(e,n=0,s=0){(e instanceof HTMLCanvasElement?e.getContext("2d"):e).putImageData(this.toImageData(),n,s)}toImageData(){const e=new ImageData(this.width,this.height),n=new Uint32Array(e.data.buffer),s=this.data,i=this.format.toABGR;for(let r=n.length;r-- >0;)n[r]=i(s[r]);return e}getRegion(e,n,s,i,r){const[o,a,l,u]=lo(e,n,s,i,this.width,this.height);return this.blit(new De(l,u,r||this.format),{sx:o,sy:a,w:l,h:u})}getChannel(e){const n=ws(this.format,e),s=new De(this.width,this.height,{type:Yd(n.size),size:n.size,channels:[{size:n.size,lane:bt.RED}],fromABGR:Cy(n.size),toABGR:zy(n.size)}),i=this.data,r=s.data,o=n.int;for(let a=i.length;a-- >0;)r[a]=o(i[a]);return s}setChannel(e,n){const s=ws(this.format,e),i=this.data,r=s.setInt;if(H(n))xy(i,n,r);else{const o=n.data,a=n.format.channels[0];vy(o,this.width,this.height),s.size===a.size?Gy(i,o,a.int,r):Ty(i,o,this.format.fromABGR,n.format.toABGR,s.maskA)}return this}invert(){const{data:e,format:n}=this,s=Math.pow(2,n.size-n.alpha)-1;for(let i=e.length;i-- >0;)e[i]^=s;return this}premultiply(){return $y(this.format),Cl(this.data,this.format,Ny),this}postmultiply(){return Cl(this.data,this.format,My),this}isPremultiplied(){const e=this.data,n=this.format.toABGR;for(let s=e.length;s-- >0;)if(!Oy(n(e[s])))return!1;return!0}forEach(e){const n=this.data;for(let s=n.length;s-- >0;)n[s]=e(n[s],s);return this}fill(e){this.data.fill(e)}flipY(){const{data:e,width:n}=this,s=Hr(this.format.type,n);for(let i=0,r=e.length-n;i<r;i+=n,r-=n)s.set(e.subarray(i,i+n)),e.copyWithin(i,r,r+n),e.set(s,r);return this}scale(e,n="linear"){return At(e>0,"scale must be > 0"),this.resize(this.width*e,this.height*e,n)}resize(e,n,s="linear"){e|=0,n|=0,At(e>0&&n>0,"target width & height must be > 0");const i=Uy(e,n,this.format),r=i.data,o=e>0?this.width/e:0,a=n>0?this.height/n:0;s=j(s)?Fy(this,s,"repeat"):s;for(let l=0,u=0;l<n;l++){const c=l*a;for(let m=0;m<e;m++,u++)r[u]=s(m*o,c)}return i}upsize(){const{width:e,height:n,data:s}=this,i=new De(e*2,n*2,this.format),r=i.data;for(let o=0,a=0;o<n;o++)for(let l=0,u=o*e*4;l<e;l++,a++,u+=2)r[u]=s[a];return i}};ts=De=pa([Uu],ts);const Vy=ba({type:"u32",size:32,alpha:8,channels:[{size:8,lane:bt.ALPHA},{size:8,lane:bt.RED},{size:8,lane:bt.GREEN},{size:8,lane:bt.BLUE}],fromABGR:Zr,toABGR:Zr}),Hu=t=>ue(t)?t:j(t)?t.length>0?t.split("."):[]:t!=null?[t]:[],jy=(t,e)=>{if(t==null)return!1;e=Hu(e);for(let n=e.length-1,s=0;s<=n;s++){const i=e[s];if(!t.hasOwnProperty(i)||(t=t[i],t==null&&s<n))return!1}return!0},Hy=t=>(At(!ap(t),`unsafe path: '${t}'`),t);function Yy(t){const e=Hu(t);Hy(e);let[n,s,i,r]=e;switch(e.length){case 0:return(o,a)=>a;case 1:return(o,a)=>o?(o[n]=a,o):void 0;case 2:return(o,a)=>{let l;return o&&(l=o[n])?(l[s]=a,o):void 0};case 3:return(o,a)=>{let l;return o&&(l=o[n])&&(l=l[s])?(l[i]=a,o):void 0};case 4:return(o,a)=>{let l;return o&&(l=o[n])&&(l=l[s])&&(l=l[i])?(l[r]=a,o):void 0};default:return(o,a)=>{let l=o;const u=e.length-1;for(let c=0;c<u;c++)if(!(l=l[e[c]]))return;return l[e[u]]=a,o}}}const Yu=(t,e,n)=>Yy(e)(t,n),Xy=/^(function\s+\w+)?\s*\(\{([\w\s,:]+)\}/;function fo(t,e){const n={prefix:"@",unwrap:!0,...e};return Dt(t)?Xu(t,n):ue(t)?Wu(t,n):t}const Xu=(t,e,n,s=[],i={},r=[])=>{n=n||t;for(let o in t)es(n,[...s,o],i,r,e);return!e.unwrap||s.length?t:Zu(t,i)},Wu=(t,e,n,s=[],i={},r=[])=>{n=n||t;for(let o=0,a=t.length;o<a;o++)es(n,[...s,o],i,r,e);return!e.unwrap||s.length?t:Zu(t,i)},es=(t,e,n,s,i)=>{const r=e.join("/");s.indexOf(r)>=0&&je(`cyclic references not allowed: ${r}`);let[o,a]=Qu(t,e);if(!n[r]){if(a)return n[r]=!0,o;let l=Nn;s.push(r),Dt(o)?Xu(o,{...i,unwrap:!1},t,e,n,s):ue(o)?Wu(o,{...i,unwrap:!1},t,e,n,s):!i.onlyFnRefs&&j(o)&&o.startsWith(i.prefix)?l=es(t,zl(e,o,i.prefix.length),n,s,i):Se(o)?l=Qy(o,u=>es(t,zl(e,u,0),n,s,i),r,n):jy(t,e)||(o=Wy(t,e,n,s,i)),l!==Nn&&(Yu(t,e,l),o=l),n[r]=!0,s.pop()}return o},Wy=(t,e,n,s,i)=>{let r=s.pop(),o;for(let a=1,l=e.length;a<=l;a++)o=es(t,e.slice(0,a),n,s,i);return s.push(r),o},Qy=(t,e,n,s)=>{const i=Xy.exec(t.toString());let r;if(i){const o=i[2].replace(/\s|(,\s*$)/g,"").split(/,/g).map(a=>a.split(":")[0]).reduce((a,l)=>(a[l]=e(l),a),{});r=t(o,e)}else r=t(e);return Aa(r,n,s),r},Aa=(t,e,n)=>{n[e]=!0,Dt(t)?Zy(t,e,n):ue(t)&&Jy(t,e,n)},Zy=(t,e,n)=>{let s,i;for(let r in t)s=t[r],i=e+"/"+r,Aa(s,i,n)},Jy=(t,e,n)=>{let s,i;for(let r=0,o=t.length;r<o;r++)s=t[r],i=e+"/"+r,Aa(s,i,n)},zl=(t,e,n=1)=>{if(e.charAt(n)==="/")return e.substring(n+1).split("/");t=t.slice(0,t.length-1);const s=e.substring(n).split("/");for(let i=0,r=s.length;i<r;i++)if(s[i]==="..")!t.length&&je(`invalid lookup path: ${e}`),t.pop();else return t.concat(s.slice(i));return!t.length&&je(`invalid lookup path: ${e}`),t};class Bl{constructor(e){this._value=e}deref(){return this._value}}const Qu=(t,e)=>{const n=e.length-1;let s=t,i=t instanceof Bl;for(let r=0;s!=null&&r<=n;r++)s=s[e[r]],s instanceof Bl&&(i=!0,s=s.deref());return[s,i]},Zu=(t,e)=>{for(let n in e){const s=n.split("/"),i=Qu(t,s);i[1]&&Yu(t,s,i[0])}return t},Ky=(t,e,n,s=window.devicePixelRatio||1)=>(s!==1&&(t.style.width=`${e}px`,t.style.height=`${n}px`),t.width=e*s,t.height=n*s,s),tb=t=>typeof t=="string",Ju=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},eb=Ju(()=>"WebGL"),Jt=t=>{throw new eb(t)},nb={alpha:!0,antialias:!0,depth:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},sb=(t={})=>{const e=t.canvas?tb(t.canvas)?document.getElementById(t.canvas):t.canvas:document.createElement("canvas");t.width&&(e.width=t.width),t.height&&(e.height=t.height),t.autoScale!==!1&&Ky(e,e.width,e.height),t.parent&&t.parent.appendChild(e);const n=e.getContext(t.version===2?"webgl2":"webgl",{...nb,...t.opts});return n||Jt("WebGL unavailable"),t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost),{canvas:e,gl:n,ext:Ku(n,t.ext)}},Ku=(t,e,n=!0)=>{const s={};if(e)for(let i of e)s[i]=t.getExtension(i),n&&!s[i]&&Jt(`extension ${i} not available`);return s},ho=t=>t[Symbol.iterator]();function*It(t,...e){let n,s=e.length;switch(s){case 0:return;case 1:let i=ho(e[0]);for(;n=i.next(),!n.done;)yield t(n.value);return;default:let r=e.map(ho);for(;;){let o=[];for(let a=0;a<s;a++){if(n=r[a].next(),n.done)return;o.push(n.value)}yield t.apply(null,o)}}}function*Et(t,e,n){if(t===void 0?(t=0,e=1/0):e===void 0&&(e=t,t=0),n=n===void 0?t<e?1:-1:n,n>0)for(;t<e;)yield t,t+=n;else if(n<0)for(;t>e;)yield t,t+=n}const ib=t=>{let e=ho(t),n,s;for(;n=e.next(),!n.done;)s=n.value;return s},rb=(t,e)=>t===e?0:t==null?e==null?0:-1:e==null?t==null?0:1:typeof t.compare=="function"?t.compare(e):typeof e.compare=="function"?-e.compare(t):t<e?-1:t>e?1:0,ob=(t,e)=>t-e,ab=(t,e,n=o=>o,s=rb,i=0,r=t.length-1)=>{const o=n(e);for(;i<=r;){const a=i+r>>>1,l=s(n(t[a]),o);if(l<0)i=a+1;else if(l>0)r=a-1;else return a}return-i-1},lb=(t,e)=>Math.abs(t-e),cb=(t,e,n)=>t<e?e:t>n?n:t;class wa{constructor(e=[[0,0],[1,1]]){this.stops=e}bounds(){const e=this.stops,n=e.length;if(!n)return{min:0,max:0,minT:0,maxT:0};let s=1/0,i=-1/0;for(let r=n;r-- >0;){const o=e[r][1];s=Math.min(s,o),i=Math.max(i,o)}return{min:s,max:i,minT:e[0][0],maxT:e[n-1][0]}}addStopAt(e,n,s=.01){return this.closestIndex(e,s)!==-1?(this.stops.push([e,n]),this.sort(),!0):!1}removeStopAt(e,n=.01){if(this.stops.length>2){const s=this.closestIndex(e,n);if(s!==-1)return this.stops.splice(s,1),!0}return!1}closestIndex(e,n=.01){const s=this.stops;for(let i=s.length;i-- >0;)if(lb(e,s[i][0])<n)return i;return-1}clampedIndexTime(e,n,s=.01){const i=this.stops,r=i.length-1;return e==0?Math.min(n,i[1][0]-s):e===r?Math.max(n,i[r-1][0]+s):cb(n,i[e-1][0]+s,i[e+1][0]-s)}sort(){this.stops.sort((e,n)=>e[0]-n[0])}uniform(){const e=this.stops.length-1;this.stops.forEach((n,s)=>n[0]=s/e)}timeIndex(e){const n=this.stops,s=n.length;if(s<256){for(let i=s;i-- >0;)if(e>=n[i][0])return i;return-1}return ab(n,[e],i=>i[0],ob)}}const tf=(t,e,n)=>n!==e?(t-e)/(n-e):0,ub=(t,e,n,s,i)=>s+(i-s)*tf(t,e,n),fb=(t,e,n)=>t+(e-t)*n,Ll=(t,e,n,s,i)=>{const r=i-1,o=i*i,a=r*r,l=(1+2*i)*a,u=i*a,c=o*(3-2*i),m=o*r;return l*t+u*e+c*n+m*s},Es=(t,e,n=.5,s=0,i=2)=>n*((e-t)/(i-s)),db=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},hb=db(()=>"illegal arity"),mb=t=>{throw new hb(t)};function ef(...t){let[e,n,s,i,r,o,a,l,u,c]=t;switch(t.length){case 0:mb(0);case 1:return e;case 2:return(...h)=>e(n(...h));case 3:return(...h)=>e(n(s(...h)));case 4:return(...h)=>e(n(s(i(...h))));case 5:return(...h)=>e(n(s(i(r(...h)))));case 6:return(...h)=>e(n(s(i(r(o(...h))))));case 7:return(...h)=>e(n(s(i(r(o(a(...h)))))));case 8:return(...h)=>e(n(s(i(r(o(a(l(...h))))))));case 9:return(...h)=>e(n(s(i(r(o(a(l(u(...h)))))))));case 10:default:const m=(...h)=>e(n(s(i(r(o(a(l(u(c(...h))))))))));return t.length===10?m:ef(m,...t.slice(10))}}const gb=(t,e)=>t!=null&&typeof t[e]=="function",_a=t=>gb(t,"xform")?t.xform():t;function nf(...t){return t=t.map(_a),ef.apply(null,t)}const Pe=Symbol(),Pl=()=>{};function*Fl(t,e=1/0){for(;e-- >0;)yield t}function*pb(t,e=1,n=e){let s=Pe;for(let i of t)e>0&&s===Pe&&(yield*Fl(i,e),e=0),yield i,s=i;n>0&&s!==Pe&&(yield*Fl(s,n))}const Sa=t=>t!=null&&typeof t[Symbol.iterator]=="function";class mi{constructor(e){this.value=e}deref(){return this.value}}const gi=t=>t instanceof mi,yb=t=>t instanceof mi?t:new mi(t),pi=t=>t instanceof mi?t.deref():t,bb=(t,e)=>[t,n=>n,e];function Ab(t){return t?[...t]:bb(()=>[],(e,n)=>(e.push(n),e))}function*Ra(t,e){const n=_a(t)(Ab()),s=n[1],i=n[2];for(let r of e){const o=i([],r);if(gi(o)){yield*pi(s(o.deref()));return}o.length&&(yield*o)}yield*pi(s([]))}function*sf(t,e){const n=_a(t)([Pl,Pl,(s,i)=>i])[2];for(let s of e){let i=n(Pe,s);if(gi(i)){i=pi(i.deref()),i!==Pe&&(yield i);return}i!==Pe&&(yield i)}}const wb=(t,e,n=sf)=>{const s=e.length-1;return Sa(e[s])?e.length>1?n(t.apply(null,e.slice(0,s)),e[s]):n(t(),e[0]):void 0},rf=(t,e)=>[t[0],t[1],e];function Ia(t,e){return Sa(e)?sf(Ia(t),e):n=>{const s=n[2];return rf(n,(i,r)=>s(i,t(r)))}}const _b=()=>t=>{const e=t[2];return rf(t,(n,s)=>{if(s){for(let i of pi(s))if(n=e(n,i),gi(n))break}return gi(s)?yb(n):n})};function of(t,e){return Sa(e)?Ra(of(t),e):nf(Ia(t),_b())}function*Sb(t,e=!0){if(t>0)for(let n=0,s=e?t+1:t;n<s;n++)yield n/t}function af(...t){const e=wb(af,t,Ra);if(e)return e;let n=t[0],s,i;return typeof t[1]=="number"?(i=t[1],s=t[2]):(i=n,s=t[1]),([r,o,a])=>{let l=[],u=0;return[r,c=>(s&&l.length>0&&(c=a(c,l),l=[]),o(c)),(c,m)=>(u<=0?(l.length<n&&l.push(m),l.length===n&&(c=a(c,l),l=i<n?l.slice(i):[],u=i-n)):u--,c)]}}const Rb=t=>new Ib(t);class Ib extends wa{at(e){const n=this.stops,s=n.length-1,i=this.timeIndex(e);if(i<0)return n[0][1];if(i>=s)return n[s][1];{const r=n[Math.max(i-1,0)],[o,a]=n[Math.max(i,0)],[l,u]=n[Math.min(i+1,s)],c=n[Math.min(i+2,s)],m=Es(r[1],u,0,r[0],l),h=Es(a,c[1],0,o,c[0]);return Ll(a,m,u,h,tf(e,o,l))}}interpolatedPoints(e=20){return Ra(nf(af(4,1),of(([n,[s,i],[r,o],a])=>{const l=Es(n[1],o,0,n[0],r),u=Es(i,a[1],0,s,a[0]);return Ia(c=>[fb(s,r,c),Ll(i,l,o,u,c)],Sb(e,!1))})),pb(this.stops,1,2))}}const Eb=t=>new vb(t);class vb extends wa{at(e){const n=this.stops,s=n.length-1,i=this.timeIndex(e);if(i<0)return n[0][1];if(i>=s)return n[s][1];{const r=n[i],o=n[i+1];return ub(e,r[0],o[0],r[1],o[1])}}interpolatedPoints(){return this.stops}}const Ea=t=>new $b(t);class $b{constructor(e){this.base=e,this.N=e.length,this.index=[...e].reduce((n,s,i)=>(n[s]=i,n),{})}encode(e,n=0){const{base:s,N:i}=this;if(e===0)return vs(s[0],n,s[0]);let r="";for(;e>0;)r=s[e%i]+r,e=Math.floor(e/i);return vs(r,n,s[0])}encodeBigInt(e,n=0){if(e<BigInt(2**53))return this.encode(Number(e),n);const{base:s,N:i}=this;if(e===BigInt(0))return vs(s[0],n,s[0]);const r=BigInt(i);let o="";for(;e>0;)o=s[Number(e%r)]+o,e/=r;return vs(o,n,s[0])}encodeBytes(e,n=0){let s="";for(let i=0,r=e.length;i<r;i++)s+=di(e[i]);return this.encodeBigInt(BigInt(`0x${s}`),n)}decode(e){const{index:n,N:s}=this;let i=0;for(let r=e.length-1,o=0;o<=r;o++)i+=n[e[o]]*s**(r-o);return i}decodeBigInt(e){const{index:n,N:s}=this,i=BigInt(s);let r=BigInt(0);for(let o=e.length-1,a=0;a<=o;a++)r+=BigInt(n[e[a]])*i**BigInt(o-a);return r}decodeBytes(e,n){let s=this.decodeBigInt(e);const i=BigInt(255),r=BigInt(8);for(let o=n.length;o-- >0;)n[o]=Number(s&i),s>>=r;return n}validate(e){return new RegExp(`^[${this.base}]+$`).test(e)}size(e){return Math.ceil(Math.log(e)/Math.log(this.N))}}const vs=(t,e,n)=>e-t.length>0?n.repeat(e-t.length)+t:t,lf="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";Ea(lf);const cf=lf+"abcdefghijklmnopqrstuvwxyz";Ea(cf);const Nb=cf+"+/",Mb=Ea(Nb),we=209,Gr=Mb.decodeBytes("61CiIIzUTrQIlucxxB7G+z38sxcEdezIO7OmB4mS3M5sM9oq3HvZJacd693CcegKniFIx+xqJZKTR54pYMf6iObPoRoez+/a1mi4BZaHP6uob9s5ihgisTtP5GeZF0y/MHbYIJkIL6MlONMuH0W7R0yBaGSHZ4mgk7rEsRcLBnXav0C2ybmYsOUzHBRduzhTq3Wr/4D0mdLgpvcDyiUvyjpLzta8kfOZngI9kyExdSc+PeoIK2KdDcbqsJqF/8iUxwI1yklbJqnZSeYbaQM+msj+yqHIjHSgWK8ok7antwKnuz6+rxTsffw55IKyLIyqZnyXUcLqiA2pqURj71OSGJf2Rs5cdukCryJ3++haFZubPaqSeb4DpeWTzijJ/lpeO2WReq8syM4lovXswzY+U8ucA2WPJbSlU7boggkdjEOKrVy/jN1EMab0A2WW3woTkjpNROI4GHmWjn0YzZewmSFHYeMEN5LTV7LrT3qew8j6ogUDhDJK7IL46b6g5dGONOatbQLckRAMuDgrTZeWnuzdydyKXfIRDr5i728lG1aOdnqVgsXeqTFJERUsCsjh2Wv0SLM9noPBFw7C+diEwBUigp1HunzBneLryxsbPIjLWq9mSoSlvbOpvQ+Oyj/DGxQj6190EICbK4rKYKOisbnqa8gIvilEFKqWSuLDhhX/RfsrJ6+E74XXbuP+YKufrwCQyjbRtDxRah7BEq8d9LnGBNPZU8Paiws1uzQj/zZI+yQt/PjvxEZemhgsY81uJJOXW6jIcvQ5hBYllzJGOAooy1WVjHmSjAYYtDJRTNXwF3Sx2WCW9WriOJtQjBQizk0PxlNwRq0ih30uhNbhoRIYoyl2w+FOtqD1w85+iQU9rj6wiRWemUr/6oGqHq8zQc5AYu9YsTF7+kVSBn4jKWCmVm8pnIi+/75B/jh0tV33i+xKbERQUD7dezNjoCFihTezqFIfyFNvRRRe8fRS2tFHuZOSysbOpTBVfgIlW7DtGJSlM4qsbufypyp9+Fo5t+95gQ48BHuYgGyCxXqhkeHssil6z/FtsqfLzSObG8gZiChR5ZjaT4Y1fpCwwd8+yQfqgkERNQTpGi+xFp8lq6zCrBM8k+FLSQcQJNDmxPrVvygiJQ72F3PaR5o2hNgDuQYLwvHhVRNP7KI0xQtBeNM8n5TVzPTj2wJN3Z1tyusoT6+v4XWlJoGnX40siMO+tfL8qSQr2X8lFI8pSpWwh5L1vO1F+BTu3Y8Y94nFLeYBXA+pgilCoD/Wgp4irNySzDGhCPdCnCdW72XBHJyuT6jTivTtmSAouzpFyUtdJZGdVrf7jerpuyot1aXN1tsLmfDiULr5HZKaM7HvR8IClj3ULM27RdYghR7cd5ruyQV0oNgE5WuALp0Kds4rpvDSxC6C+UhQZKe9g5ynmtPAmOOVvgv2+T9dHXiGbLSwtxURTRN7CtIF2Yn262rFBcAQUAdKYeoPki3DylBpF1iONICeaYX9Q59MaOA9ih6z91P4VaT3cc5Fju9brQM4xTlKE1mQUJiXjsSzwAfyHw3E6626e2ayF1uOY6TVOJajNdYCfAIaNXiHYaic0sfbCsrG5uIRjvb4J2ehXL0xf7nZnNafphEDukZ6Ho4DSaOXJMw0d7XNn7OPrRIACpGVOLClcs8mp8P6iwQAyFNpX5eKi7CKrfKdzC0xTOSqG60G8nadCZH5OGqXbmOTrMfsxhooApGEOL0Ycsyyn9LWuhkByzksLZ1Za5nmiNw4o9YMqRksw+7OD1T0Pq5VfIv5sZL9r7biwz2s30iAI2KOWr4of7XLnAMAxz2yXqGMjMz9vfyfyzAAnSsbL9ow72vUKb1jdsTnqeo0mxETxiQWAHuAGa4dLbz4Tbmhc8LIuSUG4n0hPqaxY7TNdwU5cy6lTvgDM3WabMG/kvDfMf5vXS2njD/UQsnMY8o1ixgvFugiyP0ezhPXpquZYcjMhvQ2tzMzUQ6PG5LQY3aAgLSRntaokwCpduiMWtO9FoOLPqajjvLBuEAXBrzFN8o97qrxBn0JPWy9eJqGQ4P0i9H/UOanuymSoiUaWuscHrjw7J531oqf15191tPdN9rqgCwUx/hDCYCaaaOlnMaewrv4z9PfzQelCYam3coQvM8dYPYWoT7Lw/7rDoehoefHkCdGVg35PuQiLLzlK30hW5fKdNTgl9+9rzV1yFBO5n8K1XX41YHWIJ4dPrvOvTtPdtDqqwoOxTAznDtmcgtFDKDoA4nQFbnaSKetbsbGeP21igwbW6Dan8+1yRkuO7yyDLCt1IisQ6LbY8c6LX4DaZGgs7zkzCkmrUdsaRxRKfd45cwaAaXc6oCkvs9qrnH00pfp1Hz1lwAwa4b/BZOSS7WKhQSJmTBDUwUrF7MFSbPAefgY4fshzuaLuAPNyz6fAZnlZ5U8jdOjg9AAwxn4uCsu420aQtGufwOopCndvCWErT+/EIGORImZh2qbsAsczCf9zDcalXySSnOCqeXqxD/QT6P79YGIrhkrdNruvuf/uKCtWJGsBI4a61yLBaX6LniGcHaImLeswwLi410IbpWeLM5GZPY3iRocrjh2IJCjSLPGde5uuisrqREBwy0jvix2yO9SrQDCeMWORbDUFYWmq7mKug8WuSozqA+9fuDjVa4KYOY5ixUzt+3XxU5BfgWKH4CkXNk4iQUmqCVGv+3e+kphvEdwBJGi9MDCRr4zW7PTiwM6sDt380eESoO+YeIW1dER4AlAZSpSBneFsMOkg7bOmBMfvU7XXvAJC1aIt18XR69GjfLnsDVDbA+q50uDUK4Xp8m+mw+IVdvtBJqw5rPSFeoFZypQ/+xBvC+biw1x91aIVXmJsLWoKbvYkQQCuzV071CPHZux2LD7UZCbutSzzD6R2HbE8pM5YLb3m8romBMjv+Vc4358/94e/TCybzpRtDtTyF3l4HecCJ8uOKv0ff1ru8O9dM4QH0OCZmGApWODTeQLEZr54GiE21rF2Zw3KuMcI5bchgkUw+773pv9HrLSUOE87xV1eShHwEplWbv6vfysF7gbB3zHggAtyUpol4eFwNOkyj33mOjiYbmzHYGEieo0+iL7+zg/JMo0A3v1HLKVEpidStPqggwwqRXWpgWWVdaii14symjesuILtxEqvDZIylJh2HiF7K8PIbmURBVFfjhWwBn/BmiENYWghJe/vLfK+SFL+9jgyf9fwC6iXMGIFYuCGsTvhCdcPqoYYxlPSsfYuzdGsRk4yb113WiCQNA9OqvBToW9rrCKvz/M230qBKrDdPYEpz3E+yH/sOzD5X8I0r5VY40ds7b5hPsIqTBI7oCoHpOxSMHsdO+Iy6iK/hOdUWm4koO5ws0C+ged6nuQGKf7D2GBV7vtpuyNijhjBARM34zg7oX4LMY1Vq4TzcWHwQDn+/JX03DBPfcxUW0HmX4YvR+P/lBO01M007UQ0A+/y75d/jct/VpSLInSb5kTtd+1ygnfvy6Z/+tXcGeXvnqy/vKP+l/tBiIj0HWh0o8+3q9o/V3C+TXWz9fDyamiNm3/dpV/2fdC5+Z/mC7FyFBuG1H71t257+6xhVmwoV+yyl/iLHWOcomRuLX7xwcLoBoryEdZCYimxouWlDR6VQslMOUB2tsG6WuaQegchj/o+hq5ltu4SqT33GqD34HHORysyi0ftPebylBq9IGchGG1wGG8/9KOOiFPjkVo0Gq0G0q1MLXPlxIgySZOylBo2mqC0bb05fcCXQ2cfdo4yeME7Yv6ZMT7gfX+sdD7xgU9zR/2HZ4Kbsukkwj9fwcQGto454zcrp8LigUEylFskzR0UPsH6JqiyhawIKyn0LbkpzJqkdZKs0Au4ZLQP0weeXtG2wP+WT2ZqEJJ5YTB8tE8XPEfRHDRvYc4vx37zNe/zPOtyhqgxzbDt+6AtV2//6MWwnEZO3GZjeTSmgcbqDdKAH4AO3GdyZiioBo+wDhR//NrVfMWVQYmgyR7cwUXmRkjqDNH5oCeAaLBKMzrVvkVhyJ6L3un9oWNI48ZdNeWxP4WlBQRJbncLYORcrX7uezjuyIr+jgkuEhe2WGRAX5+90pqVI/qwtBy/E/yBM9JOgx8yMX4yxGsrgsSx+3F62qwPKaxYNbfjAQIr7Wd+ikD0XGs3Izp0L2bRc99tzAwww8QulJhljlUYBhQ8P3OXdAkNnnT7GSDEnObSHn4gnaqXOkOG49IEMLqcxxIpy/Dh9EEw2yssTH7JW41XGK3koO9vKa8+7mZ/S5muHTl5KvcBtIUKP/SbQYxqz/gwE7isid6mgUNVCcI3Quq56COpy/FaeT/AYOX3KvB8esAGgodwERf+CopzwFVTnIJLG1tDY1e3WeJOHeSUaeqe7L7t88YtA5W8nmCJqWaN69HVtvbdPvxri1WDoiNLaWmatzoiPXVqhDNtvWfBIa9GqzBU7TaexAJoSUGW6WJ9I4LSrujpg11z+wpchNdQOIv8XqDFqWjM6vVROoWahcbn+YsA10BWt9nefMgLZicvCkLe7ScQ6ngauP/pAYNr5aFTouFFY4GE1eSa1CQlp8tqtfftSQqzUtdHUtJ/E4hs2qYwQgAV5TcBnKezDjg/ElPzQ+4tgYoMIbRBGSwMoDCpsfTz9jivhso/ktIavQkAXeDN3KHZrqejduutwHEFbvVx9i/uTxMDajHQfH/gRXxgtL3C38KUMudig5Etz/AXhFCCv/aYLyD8I0JEJefILrEOtXeY9I7UKKUpdSRrRkWdgIiRwlG1eVCHIKnMMHrmdnmYQwjBztaaVhuMq0zfLr7pNHFywHSy+AdzlZl3WqHCJCrMbTHYtnemwDyzkMxW0W4kYWEt6qdvgLsxyUwjDdlH0yLZnabnnmbnvYCsy7C/lV/w3GxfnKOIouWVcPGwR+OUewRYIuplv21zAKY43G+NecYliJFRbqnrv86nBk8SC/Xfz/Xr+BSjXiLgOftjSpZ37+g2nCwH3D21W41JXa5zMWH/umkrAMA/UVR",new Uint8Array(we*18)),Ob=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},Db=Ob(()=>"Assertion failed"),xb=(typeof process<"u"&&process.env!==void 0?!!{}.UMBRELLA_ASSERTS:!!{}.VITE_UMBRELLA_ASSERTS)?(t,e)=>{if(typeof t=="function"&&!t()||!t)throw new Db(typeof e=="function"?e():e)}:()=>{},Sn=t=>{Gb(t);const e=[];t*=18;for(let n=0;n<6;n++,t+=3)e.push("#"+Mu(Gr[t]<<16|Gr[t+1]<<8|Gr[t+2]));return e},Gb=t=>xb(t>=0&&t<we,"invalid theme ID"),Tb=.5*(Math.sqrt(3)-1),Rn=(3-Math.sqrt(3))/6,Ul=t=>Math.floor(t)|0,kl=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function Cb(t=Math.random){const e=zb(t),n=new Float64Array(e).map(i=>kl[i%12*2]),s=new Float64Array(e).map(i=>kl[i%12*2+1]);return function(r,o){let a=0,l=0,u=0;const c=(r+o)*Tb,m=Ul(r+c),h=Ul(o+c),b=(m+h)*Rn,A=m-b,N=h-b,E=r-A,D=o-N;let W,he;E>D?(W=1,he=0):(W=0,he=1);const Ct=E-W+Rn,er=D-he+Rn,nr=E-1+2*Rn,sr=D-1+2*Rn,ir=m&255,rr=h&255;let cn=.5-E*E-D*D;if(cn>=0){const Kt=ir+e[rr],dn=n[Kt],hn=s[Kt];cn*=cn,a=cn*cn*(dn*E+hn*D)}let un=.5-Ct*Ct-er*er;if(un>=0){const Kt=ir+W+e[rr+he],dn=n[Kt],hn=s[Kt];un*=un,l=un*un*(dn*Ct+hn*er)}let fn=.5-nr*nr-sr*sr;if(fn>=0){const Kt=ir+1+e[rr+1],dn=n[Kt],hn=s[Kt];fn*=fn,u=fn*fn*(dn*nr+hn*sr)}return 70*(a+l+u)}}function zb(t){const n=new Uint8Array(512);for(let s=0;s<512/2;s++)n[s]=s;for(let s=0;s<512/2-1;s++){const i=s+~~(t()*(256-s)),r=n[s];n[s]=n[i],n[i]=r}for(let s=256;s<512;s++)n[s]=n[s-256];return n}const uf=4,$s=1<<uf,ff=8,Bb=1<<ff,ct=4095;let df=4,hf=.5;const Tr=t=>.5*(1-Math.cos(t*Math.PI));let ot;const Lb=function(t,e=0,n=0){if(ot==null){ot=new Array(ct+1);for(let E=0;E<ct+1;E++)ot[E]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),n<0&&(n=-n);let s=Math.floor(t),i=Math.floor(e),r=Math.floor(n),o=t-s,a=e-i,l=n-r,u,c,m=0,h=.5,b,A,N;for(let E=0;E<df;E++){let D=s+(i<<uf)+(r<<ff);u=Tr(o),c=Tr(a),b=ot[D&ct],b+=u*(ot[D+1&ct]-b),A=ot[D+$s&ct],A+=u*(ot[D+$s+1&ct]-A),b+=c*(A-b),D+=Bb,A=ot[D&ct],A+=u*(ot[D+1&ct]-A),N=ot[D+$s&ct],N+=u*(ot[D+$s+1&ct]-N),A+=c*(N-A),b+=Tr(l)*(A-b),m+=b*h,h*=hf,s<<=1,o*=2,i<<=1,a*=2,r<<=1,l*=2,o>=1&&(s++,o--),a>=1&&(i++,a--),l>=1&&(r++,l--)}return m},Pb=function(t,e){t>0&&(df=t),e>0&&(hf=e)},Fb=function(t){const e=(()=>{let r,o;return{setSeed(a){o=r=(a==null?Math.random()*4294967296:a)>>>0},getSeed(){return r},rand(){return o=(1664525*o+1013904223)%4294967296,o/4294967296}}})();e.setSeed(t),ot=new Array(ct+1);for(let n=0;n<ct+1;n++)ot[n]=e.rand()};function L(t,e,n=0,s=0){return t==="simplex"?new jl("simplex",e,n,s):t==="perlin"?new jl("perlin",e,n,s):new mf(t,e,n,s)}function ql(t,e,n=!0){for(let s=0;s<e.length-2;s++){if(t<e[s])return e[s];if(t<e[s+1])return n&&t-e[s]<e[s+1]-t?e[s]:e[s+1]}return e[e.length-1]}function Ub(t,e,n={}){return 0}function kb(t,e,n={center:[.5,.5]}){const s=n.center?n.center:[.5,.5];return Math.atan2(e-s[1],t-s[0])}function Vl(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return z*s*Math.cos(t*i)*Math.sin(e*i)}function qb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*Math.cos(t*i)/(Math.sin(e*i)+.001)}function Vb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*(Math.cos(t*i)+Math.sin(e*i))}function jb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*(Math.sin(e*i)-Math.cos(t*i))}function Hb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*(Math.sin(t*i)+Math.sin(e*i))}function Yb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*Math.cos(t*i)}function Xb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return k*s*Math.cos(e*i)}function Wb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return Math.acos(s*Math.cos(i*t))}function Qb(t,e,n={scale:1,amplitude:1}){const s=n.amplitude?n.amplitude:1,i=n.scale?n.scale:1;return Math.acos(s*Math.cos(i*e))}function Zb(t,e,n={a:1,b:1,c:1}){const s=n.a?n.a:1,i=n.b?n.b:1,r=n.c?n.c:1,o=e-1-Math.sqrt(Math.abs(i*t-1-r))*Math.sign(t-1),a=s-t-1;return Math.atan2(a,o)}function Jb(t,e,n={a:1,b:1,c:1,d:1}){const s=n.a?n.a:1,i=n.b?n.b:1,r=n.c?n.c:1,o=n.d?n.d:1,a=Math.sin(s*e)+r*Math.cos(s*t),l=Math.sin(i*t)+o*Math.cos(i*e);return Math.atan2(l,a)}function Kb(t,e,n={a:1,b:1,c:1,d:1}){const s=n.a?n.a:1,i=n.b?n.b:1,r=n.c?n.c:1,o=n.d?n.d:1,a=Math.sin(s*e)-Math.cos(i*t),l=Math.sin(r*t)-Math.cos(o*e);return Math.atan2(l,a)}function t3(t,e,n={a:1,b:1,c:1,d:1}){const s=n.a?n.a:1,i=n.b?n.b:1,r=n.c?n.c:1,o=n.d?n.d:1,a=Math.sin(i*e)+r*Math.sin(i*t),l=Math.sin(s*t)+o*Math.sin(s*e);return Math.atan2(l,a)}function e3(t,e,n={a:1,b:1}){const s=n.a?n.a:1,i=n.b?n.b:1,r=s*t+(1-s)*2*t*t/(1+t*t),o=i*e*r,a=r-t;return Math.atan2(a,o)}class mf{constructor(e,n,s=0,i){G(this,"quantizationArray",[]);G(this,"computeFn");this.type=e,this.opts=n,this.rotation=s,this.quantization=i,this.computeFn=this.getComputeFn(e),this.update()}getComputeFn(e){switch(e){case"zero":return Ub;case"radial":return kb;case"sinTimesCos":return Vl;case"sinFractCos":return qb;case"sinPlusCos":return Vb;case"sinMinusCos":return jb;case"sinPusSin":return Hb;case"cosX":return Yb;case"cosY":return Xb;case"aCosX":return Wb;case"aCosY":return Qb;case"hopalong":return Zb;case"clifford":return Jb;case"fractalDream":return t3;case"gumowskiMira":return e3;case"deJong":return Kb}return Vl}update(){if(typeof this.quantization=="number"){this.quantizationArray=[0,k];for(let n=1;n<this.quantization;n++)this.quantizationArray.splice(n,0,n*k/this.quantization)}else this.quantizationArray=this.quantization;const e=this.opts.quantizationShift?this.opts.quantizationShift:0;this.quantizationArray=this.quantizationArray.map(n=>n+e)}getRawValue(e,n){const[s,i]=e,r={...this.opts,...n};return this.computeFn(s,i,r)}getValue(e,n){return n&&n.clamp?Va(this.getRawValue(e,n)):this.getRawValue(e,n)}getQuantizedValue(e,n){const s=this.getValue(e,n);return this.quantization===0?s+this.rotation:ql(s,this.quantizationArray,n?n.quantizeToClosest:!0)+this.rotation}getQuantizedValueWithFn(e,n,s){const[i,r]=e,o={...this.opts,...s};let a=this.getComputeFn(n)(i,r,o);return s&&s.clamp&&(a=Va(a)),this.quantization===0?a+this.rotation:ql(a,this.quantizationArray,this.opts?this.opts.quantizeToClosest:!0)+this.rotation}}class jl extends mf{constructor(n,s,i=0,r){super(n,s,i,r);G(this,"noise2D");if(this.type=n,this.opts=s,this.rotation=i,this.quantization=r,n==="simplex")this.noise2D=Cb(f.float.bind(f));else{Fb(F0(fxhash)),this.noise2D=Lb;const o=s.lod?s.lod:4,a=s.falloff?s.falloff:.5;Pb(o,a)}}getRawValue(n,s){const[i,r]=n,o={...this.opts,...s},a=o.amplitude?o.amplitude:1,l=o.scale?o.scale:1;return k*a*this.noise2D(i*l,r*l)}}Object.freeze([1,0,0,1]);Object.freeze([1,0,0,1,0,0]);Object.freeze([1,0,0,0,1,0,0,0,1]);const gf=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),R={iskra:["#FCF9F0","#262220"],hypothetically:["#2E0D00","#0CA5AE","#B12800"],coffee:["#262220","#FCF1D2"],coffee_plus_red:["#262220","#FCF1D2","#D82220"],parcel:["#DBCBB2","#0A121C"],dark:["#111111","#FCFCFC"],black_on_white:["#FFFFFF","#000000"],desl1:["#EEE9DF","#394E76","#435A4F","#FFFFFE"],whiteOnBlack:["#000000","#FFFFFF"],blueprint:["#141D50","#F8F9F9"],blueprint_dark:["#191B27","#D2D4C5"],grey:["#373737","#D9D9D9"],red:["#A92218","#131313"],red_plus:["#7f0233","#fedac0","#c52b3e"],bloody:["#1c1418","#857e6b","#8c433a","#ba4033","#c8a15c","#d0c1ae"],mondrian:["#1c1418","#000000","#DD0100","#225095","#FAC901","#FFFFFF"],blueScale:["#18141c",...Ol(10,Dl([0,0,.102],[.933,.996,1])).map(t=>M(xl(null,Gl(.8),t)))],redScale:["#1c1418",...Ol(10,Dl([.067,0,0,1],[1,.996,.933,1])).map(t=>M(xl(null,Gl(.8),t)))],tm_1:["#f2ebe5","#502527","#366974","#d93d0f"],tm_2:["#e2cdb5","#49332d","#715650","#9e8178"],tm_3:["#d6dac2","#101012","#973828","#556150"],tm_4:["#d9ddd9","#070b04","#2e3911","#646e32"],tm_5:["#eef5fa","#0a0320","#260d6c","#613dda"],severance:["#BBCFD4","#1B2937","#5C7F68","#223C33"],control_room_1:["#bbe3d5","#3f322f","#71a99a","#d06f4c"],control_room_2:["#7f0233","#2f112d","#c52b3e","#fedac0"],control_room_3:["#6f6166","#1c161c","#9f8b8c","#fbeae4"],control_room_inv:["#7f0233","#fedac0","#c52b3e","#2f112d"]},re=t=>({bg:[t[0]],fg:t.slice(1)}),In=t=>s3(Fu(t.map(e=>I(e)),ua).map(e=>M(e))),n3=t=>re(Fu(t.map(e=>I(e)),ua).map(e=>M(e))),s3=t=>({bg:[t[0]],fg:t.slice(1).reverse()}),O={default:{type:"default",matrix:gf,offset:[0,0,0,0]},Chrome:{type:"Chrome",matrix:[1.398,-.051,-.051,0,-.316,1.278,.119,0,.065,-.08,1.151,0,-.273,-.273,-.29,1],offset:[.201,.201,.215,0]},Fade:{type:"Fade",matrix:[1.073,.107,.015,0,-.015,.859,.077,0,.092,.184,1.104,0,-.115,-.115,-.115,1],offset:[-.017,-.017,-.017,0]},Cold:{type:"Cold",matrix:[1.1,0,0,0,0,1.1,0,0,0,0,1.2,0,0,0,0,1],offset:[-.1,-.1,-.1,0]},Warm:{type:"Warm",matrix:[1.06,0,0,0,0,1.01,0,0,0,0,.93,0,0,0,0,1],offset:[0,0,0,0]},Monochrome:{type:"Monochrome",matrix:[.212,.212,.212,0,.715,.715,.715,0,.114,.114,.114,0,0,0,0,1],offset:[0,0,0,0]},Monowash:{type:"Monowash",matrix:[.163,.163,.171,0,.518,.529,.529,0,.084,.082,.084,0,0,0,0,1],offset:[.208,.21,.214,0]},Noir:{type:"Noir",matrix:[.15,.15,.15,0,1.3,1.3,1.3,0,-.25,-.25,-.25,0,.1,.1,.1,1],offset:[-.2,-.2,-.2,0]},Monostark:{type:"Monostark",matrix:[.338,.302,.286,0,.991,1.049,1.016,0,.117,.096,.146,0,0,0,0,1],offset:[-.196,-.196,-.196,0]},Summer:{type:"Summer",matrix:[.95,.1,0,0,.2,.9,0,0,0,0,.9,0,0,0,0,1],offset:[0,0,0,0]},Pastel:{type:"Pastel",matrix:[.75,.25,.25,0,.25,.75,.25,0,.25,.25,.75,0,0,0,0,1],offset:[0,0,0,0]},SepiaRust:{type:"Sepia Rust",matrix:[.269,.239,.186,0,.764,.527,.4,0,.172,.152,.119,0,0,0,0,1],offset:[.1,.176,.159,0]},SepiaBlues:{type:"Sepia Blues",matrix:[.289,.257,.2,0,.62,.566,.43,0,.185,.163,.128,0,0,0,0,1],offset:[.077,.115,.188,0]},SepiaColor:{type:"Sepia Color",matrix:[.547,.281,.225,0,.764,.925,.558,0,.134,.12,.33,0,0,0,0,1],offset:[-.147,-.135,-.113,0]}},Bt={default:{brightness:0,contrast:0,filterMatrix:O.default.matrix,filterOffset:O.default.offset,exposure:0,saturation:0},Effected:{brightness:0,contrast:0,filterMatrix:O.default.matrix,filterOffset:O.default.offset,exposure:0,saturation:0}},Cr={radial_center:{type:"radial",opts:{center:[.5,.5],clamp:!0},rotation:0,quantization:0},finding_my_way:{type:()=>d(["sinPlusCos"]),opts:{scale:()=>d([37,70,100]),amplitude:1,clamp:!0},rotation:0,quantization:0},finding_my_way_plus:{type:d(["sinPlusSin","sinPlusCos","sinTimesCos","sinMinusCos"]),opts:{scale:d([37,70,100]),amplitude:1,clamp:!0},rotation:0,quantization:0},test:{type:d(["sinPlusSin","sinPlusCos","sinTimesCos","cosX","cosY","aCosX","aCosY","radial"]),opts:{scale:f.minmax(2,55),amplitude:f.minmax(.1,2),clamp:!0},rotation:d([0,z/3,z/4,z/2,z]),quantization:d([0,3,4,5,6,7,8,9,10,11,12,13,14,15,16])},what_is_missing:[{type:()=>d(["aCosX"]),opts:{scale:()=>f.minmax(50,80),amplitude:1,clamp:!0},rotation:0,quantization:0},{type:"simplex",opts:{scale:()=>f.minmax(1,15),amplitude:()=>f.minmax(.05,.8),clamp:!0},rotation:0,quantization:0}],what_is_missing_plus:[{type:"aCosX",opts:{scale:f.minmax(50,80),amplitude:1},rotation:0,quantization:0},{type:"simplex",opts:{scale:f.minmax(1,15),amplitude:f.minmax(.05,.8)},rotation:0,quantization:0},{type:"hopalong",opts:{a:f.minmax(-1,1),b:f.minmax(-1,1),c:f.minmax(-1,1)},rotation:0,quantization:0},{type:"clifford",opts:{a:f.minmax(-10,10),b:f.minmax(-10,10),c:f.minmax(-10,10),d:f.minmax(-10,10)},rotation:0,quantization:0},{type:"bedhead",opts:{a:f.minmax(-10,10),b:f.minmax(-10,10)},rotation:0,quantization:0}],troublemaker:[{type:"clifford",opts:{a:-1.4,b:1.6,c:1,d:.7},quantization:0,rotation:0},{type:"clifford",opts:{a:1.7,b:1.7,c:.6,d:1.2},quantization:0,rotation:0},{type:"deJong",opts:{a:1.4,b:-2.3,c:2.4,d:-2.1},quantization:0,rotation:0},{type:"perlin",opts:{lod:2,falloff:.8,scale:50},quantization:0,rotation:0},{type:"perlin",opts:{lod:2,falloff:.4673,scale:50},quantization:0,rotation:0},{type:"simplex",opts:{amplitude:.2347,scale:17},quantization:0,rotation:0},{type:"perlin",opts:{lod:2,falloff:.8,scale:1},quantization:0,rotation:0},{type:"perlin",opts:{falloff:.8,lod:2,scale:10},quantization:0,rotation:0},{type:"aCosX",opts:{scale:32,amplitude:.1},quantization:0,rotation:0},{type:"sinTimesCos",opts:{scale:32,amplitude:.1},quantization:0,rotation:0},{type:"hopalong",opts:{a:1.17,b:.44,c:2.56},quantization:0,rotation:0},{type:"bedhead",opts:{a:-8.1,b:-9.2},quantization:0,rotation:0},{type:"fractalDream",opts:{d:.74,a:-29.6,b:-23,c:.77},quantization:0,rotation:0},{type:"gumowskiMira",opts:{a:.01,b:-.7},quantization:0,rotation:0}]};3/4,d([.04,.1]),d([In(Sn(f.minmaxInt(0,we))),{bg:["#01182b"],fg:["#fafff7","#2ec4ad","#ff9519","#e71d3c","#990a21"]},{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#ff9519"),weight:1},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")}],{num:15,variance:.02})].map(t=>M(t))},{bg:["#231927"],fg:[...st([{range:"cool",base:I("#eebcb2"),weight:1},{range:"cool",base:I("#d56a76"),weight:1},{range:"warm",base:I("#97061d")},{range:"cool",base:I("#610d21")},{range:"cool",base:I("#323445")}],{num:15,variance:.02})].map(t=>M(t))},{bg:[R.coffee_plus_red[0]],fg:[...st([{range:"cool",base:I(R.coffee_plus_red[1]),weight:2},{range:"warm",base:I(R.coffee_plus_red[2])}],{num:15,variance:.04})].map(t=>M(t))}]),Bt.default,3/4,d([.2,.5,.8]),d([In(Sn(f.minmaxInt(0,we))),{bg:["#01182b"],fg:["#fafff7","#2ec4ad","#ff9519","#e71d3c","#990a21"]},{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#ff9519"),weight:1},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")}],{num:15,variance:.02})].map(t=>M(t))},{bg:["#231927"],fg:[...st([{range:"cool",base:I("#eebcb2"),weight:1},{range:"cool",base:I("#d56a76"),weight:1},{range:"warm",base:I("#97061d")},{range:"cool",base:I("#610d21")},{range:"cool",base:I("#323445")}],{num:15,variance:.02})].map(t=>M(t))},{bg:[R.coffee_plus_red[0]],fg:[...st([{range:"cool",base:I(R.coffee_plus_red[1]),weight:2},{range:"warm",base:I(R.coffee_plus_red[2])}],{num:15,variance:.04})].map(t=>M(t))}]),Bt.default,d([.04,.1,.2,.5,.8]),d([In(Sn(f.minmaxInt(0,we))),{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#ff9519"),weight:1},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")}],{num:15,variance:.02,rnd:f})].map(t=>M(t))},{bg:[R.coffee_plus_red[0]],fg:[...st([{range:"cool",base:I(R.coffee_plus_red[1]),weight:2},{range:"warm",base:I(R.coffee_plus_red[2])}],{num:15,variance:.03,rnd:f})].map(t=>M(t))}]),re(d([R.iskra,R.coffee,R.parcel,R.dark,R.blueprint_dark,R.grey,R.tm_1,R.tm_2,R.tm_3,R.tm_4,R.red_plus])),Bt.default,re(d([R.iskra,R.coffee,R.parcel,R.dark,R.blueprint])),$(.5),f.minmaxInt(2,10),f.minmaxInt(5,15),f.minmaxInt(1e3,25e3),Bt.default,d([1,750/938,582/1149]),d([.04,.1,.2,.5,.8]),d([n3(d([R.control_room_1,R.control_room_2,R.control_room_3])),In(Sn(f.minmaxInt(0,we))),{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#ff9519"),weight:1},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")}],{num:15,variance:.02,rnd:f})].map(t=>M(t))},{bg:[R.coffee_plus_red[0]],fg:[...st([{range:"cool",base:I(R.coffee_plus_red[1]),weight:2},{range:"warm",base:I(R.coffee_plus_red[2])}],{num:15,variance:.03,rnd:f})].map(t=>M(t))}]),650/811,d([.04,.1,.2,.5,.8]),d([{bg:["#ffffff"],fg:["#6187ab","#959599","#766550","#857d75","#35392d","#4a4d3f","#21261c","#d37642","#78a13c","#bcaea2"]}]),Bt.default,515/768,d([.04,.1,.2,.5,.8]),d([{bg:["#ffffff"],fg:["#bcaea2","#6187ab","#959599","#766550","#857d75","#35392d","#4a4d3f","#21261c","#d37642","#78a13c"]}]),Bt.default,1170/1252,d([.04,.1,.2,.5,.8]),d([{bg:["#ffffff"],fg:["#bcaea2","#6187ab","#959599","#766550","#857d75","#35392d","#4a4d3f","#21261c","#d37642","#78a13c"]}]),Bt.default,re(d([R.iskra,R.coffee,R.parcel,R.dark,R.blueprint_dark,R.grey,R.tm_1,R.tm_2,R.tm_3,R.tm_4,R.control_room_inv])),Bt.default,re(d([R.severance,R.control_room_1,R.control_room_2,R.control_room_3])),Bt.default,d([In(Sn(f.minmaxInt(0,we))),{bg:["#01182b"],fg:["#fafff7","#2ec4ad","#ff9519","#e71d3c","#990a21"]}]),d([.04,.1,.2,.5,.8]),d([{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#ff9519"),weight:1},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")}],{num:15,variance:.02,rnd:f})].map(t=>M(t))},{bg:[R.coffee_plus_red[0]],fg:[...st([{range:"cool",base:I(R.coffee_plus_red[1]),weight:2},{range:"warm",base:I(R.coffee_plus_red[2])}],{num:15,variance:.03,rnd:f})].map(t=>M(t))}]);const i3=async t=>Promise.all(t.map(e=>Ey(e))).then(e=>e.map(n=>ky(n,Vy))),Hl=t=>new r3(t);class r3 extends wa{at(e){const n=this.stops,s=n.length-1,i=this.timeIndex(e);return i<0?n[0][1]:i>=s?n[s][1]:n[i][1]}interpolatedPoints(e=20){return this.stops}}const o3={troublemaker_next:{aspectRatio:.8,scalingFactor:1,xRes:1500,yRes:({xRes:t,aspectRatio:e})=>Math.floor(t/e),gridFactor:d([.2,.5,.8]),step:({xRes:t})=>d([1,2])/t,assets:[],style:({agents:t,aspectRatio:e})=>{const n=f.minmax(.05,.1),s={type:"sanded line",alphaDecay:r=>r*r,maxLength:n,grainsFactor:Math.max(300,f.minmaxInt(200,1e3)*n*10),minAlpha:.01,followBounds:!1,weightFactor:d([.3,.5]),doubleSided:!1};return{def:s,getValue:(r,o)=>({...s,type:o.spaceTraveled/t.maxSpaceTraveled<.8?"sanded line":"line"})}},colors:d([{bg:["#01182b"],fg:[...st([{range:"cool",base:I("#FF9519")},{range:"warm",base:I("#e71d3c")},{range:"cool",base:I("#990a21")},{range:"cool",base:I("#F1DABF")}],{num:15,variance:.02,rnd:f})].map(t=>M(t))},re(["#7f0233","#c52b3e","#fedac0","#2f112d"]),re(["#6f6166","#9f8b8c","#1c161c","#fbeae4"]),re(["#7f0233","#fedac0","#c52b3e","#2f112d"])]),vector_field:({aspectRatio:t,agents:e})=>{const n=d([{type:d(["sinTimesCos","perlin","fractalDream","gumowskiMira","aCosX","radial","sinPlusCos","sinFractCos","cosX"]),opts:{scale:f.minmaxInt(10,65),amplitude:f.minmax(.2,.4),quantizationShift:d([0,-V,-z]),quantizeToClosest:$(.5),a:f.minmax(-10,10),b:f.minmax(-10,10),c:f.minmax(-10,10),d:f.minmax(-10,10),clamp:$(.5),falloff:f.minmax(.01,1),lod:f.minmaxInt(0,5),center:[f.minmax(.1,.9),f.minmax(.1,.9)]},rotation:d([y(0),y(30),y(45),y(60),y(90)]),quantization:d([0,3,4,5,6,7,8,9])}]),s=L("radial",{center:[.5*t,.5]},0,d([0])),i=L(n.type,n.opts,n.rotation,n.quantization);f.minmaxInt(4,10);const r=[[0,0],[.2,1],[.5,0],[1,0]],o=C([Rb(r),Eb(r),Hl(r)],[1,1,2]),a=Hl([[0,0],[.33,1],[.66,0],[1,1]]),l=d(["time"]);return console.log(s),console.log(i),console.log(o),console.log(l),{def:n,vf:s,factor:l,getValue:(c,m)=>{const h=s.getQuantizedValue(c.pos),b=i.getQuantizedValue(c.pos);let A=0;return l==="time"?A=o.at(m.spaceTraveled/e.maxSpaceTraveled):l==="width"?A=a.at(c.pos[0]/t):A=a.at(c.pos[1]),Ae(h,b,A)},getValueAt:(c,m)=>s.getQuantizedValue(c,m)}},agents:()=>({initialStep:d([.01,.001,1e-4]),angled:!1,maxNewPerFrame:30,chance:1,fuzziness:0,maxIterations:1e4,maxSpaceTraveled:d([20,30]),maxActive:120,branch:f.minmaxInt(2,8),initial:f.minmaxInt(10,40),max:d([1e3]),maxLineLength:d([[2,2],[1,2],[.5,1],[.1,.5]]),initialDirections:[[0,1],[0,-1],[1,0],[-1,0]]}),bounds:({agents:t,aspectRatio:e})=>{let n,s,i;return n=[v([.2,.2],[e*.8,.8])],s=i=[v([.1,.1],[e*.9,.9])],n=s=[K([.5*e,.5],.3)],i=[...It(r=>K([.5*e,.5],r),Et(.4*e,.48*e,20))],{overall:i,update:s,init:n}},stroke:({colors:t,agents:e})=>d([{values:t.fg,persistent:!0,type:"random",getValue:n=>d(t.fg)},{values:t.fg,persistent:!0,type:"agentID",getValue:n=>t.fg[Math.floor(S(n.ID,0,e.max/2,0,t.fg.length-1))]}]),weight:({style:t,agents:e,aspectRatio:n})=>{const s=C([[6,0],[8,1]],[1,1]);return{values:s,...d([{persistent:!1,type:"agentID",getValue:i=>{const r=S(Math.sqrt(Math.pow(i.pos[0]-n/2,2)+Math.pow(i.pos[1]-.5,2)),0,Math.sqrt(Math.pow(n/2,2)+Math.pow(.5,2)),10,-1),o=S(i.ID,0,e.max,s[0],s[1]);return Math.min(r,o)}},{persistent:!0,type:"random",getValue:i=>f.minmax(s[0],s[1])},{type:"distancePosCenter",persistent:!1,getValue:i=>S(Math.sqrt(Math.pow(i.pos[0]-n/2,2)+Math.pow(i.pos[1]-.5,2)),0,Math.sqrt(Math.pow(n/2,2)+Math.pow(.5,2)),s[0],-1.5)}])}},alpha:({agents:t})=>{const e=d([[.81,.2],[.5,.02]]);return{values:e,...d([{type:"agentID",persistent:!0,getValue:n=>S(n.ID,0,t.max,e[0],e[1])},{type:"random",persistent:!0,getValue:n=>f.minmax(e[0],e[1])}])}},events:({vector_field:t})=>[],postprocess:()=>{const t=d([O.Pastel,O.Warm]);return{brightness:0,contrast:0,filterMatrix:t.matrix,filterOffset:t.offset,exposure:.1,saturation:0,type:t.type}}}},a3=()=>fo({iterations:0,lineSlice:3e4,presetId:d(["broken_pieces_plus"],f),preset:({presetId:t})=>fo({...o3.troublemaker_next},{onlyFnRefs:!0})},{onlyFnRefs:!0}),pf=(t,e)=>fo({...t,margin:0,useFixedSizeCanvas:!0,fixedHeight:e.yRes,fixedWidth:e.xRes,dpr:({useFixedSizeCanvas:n})=>n?2:window.devicePixelRatio||1,width:({margin:n})=>t.width/t.height<=e.aspectRatio?t.width-2*n:t.height*e.aspectRatio-2*n,height:({margin:n})=>t.width/t.height<=e.aspectRatio?t.width/e.aspectRatio-2*n:t.height-2*n,scaledSize:({width:n,height:s,dpr:i,useFixedSizeCanvas:r,fixedHeight:o,fixedWidth:a})=>[r?a*i:n*i,r?o*i:s*i],aspect:({width:n,height:s})=>n/s,glCanvas:({width:n,height:s,dpr:i,scaledSize:r,useFixedSizeCanvas:o})=>{let a;const l=document.getElementById("main");return l?a={canvas:l,gl:l.getContext("webgl2")}:(a=sb({width:r[0]*e.scalingFactor/i,height:r[1]*e.scalingFactor/i,parent:document.getElementById("app"),version:2}),a.canvas.setAttribute("id","main")),o&&(a.canvas.style.width=`${n}px`,a.canvas.style.height=`${s}px`),a},canvas:({width:n,height:s,dpr:i,scaledSize:r,useFixedSizeCanvas:o})=>{let a;const l=document.getElementById("canvas2d");return l?a={canvas:l,ctx:l.getContext("2d")}:(a=hi(n,s,document.getElementById("app")),a.canvas.setAttribute("id","canvas2d"),o&&(a.canvas.width=r[0],a.canvas.height=r[1])),o?(a.canvas.style.width=`${n}px`,a.canvas.style.height=`${s}px`,a.canvas.style.display="none"):Sy(a.canvas,n,s),a}},{onlyFnRefs:!0});class l3{constructor(e){this.events=e;for(const n of e)n.triggered=!1}checkEvents(e,n){for(let s of this.events)(s.trigger.repeat==="always"||!s.triggered)&&this.getFactor(s.trigger.factor,e,n)>=s.trigger.threshold&&(console.log("triggered",s.trigger.factor,s.trigger.threshold),s.triggered=!0,s.action.fn(),s.action.value)}getFactor(e,n,s){switch(e){case"agentID":return s.agents.length/n.agents.max;case"spaceTraveled":return s.spaceTraveled}return 1}}const c3={WEBGL_draw_buffers:{gl:!0,alias:"GL_EXT_draw_buffers"},OES_standard_derivatives:{gl:!0,alias:"GL_OES_standard_derivatives"}};var yi;(function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(yi||(yi={}));const yf={fragColor:["vec4",0]};var g;(function(t){t[t.ALPHA=6406]="ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.R16F=33325]="R16F",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32F=33326]="R32F",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.R8=33321]="R8",t[t.R8_SNORM=36756]="R8_SNORM",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.RED=6403]="RED",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RG16F=33327]="RG16F",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32F=33328]="RG32F",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RG8=33323]="RG8",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RGB=6407]="RGB",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB16I=36233]="RGB16I",t[t.RGB16UI=36215]="RGB16UI",t[t.RGB32F=34837]="RGB32F",t[t.RGB32I=36227]="RGB32I",t[t.RGB32UI=36209]="RGB32UI",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.RGB8=32849]="RGB8",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGB8I=36239]="RGB8I",t[t.RGB8UI=36221]="RGB8UI",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA=6408]="RGBA",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGBA16F=34842]="RGBA16F",t[t.RGBA16I=36232]="RGBA16I",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGBA32F=34836]="RGBA32F",t[t.RGBA32I=36226]="RGBA32I",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGBA4=32854]="RGBA4",t[t.RGBA8=32856]="RGBA8",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGBA8I=36238]="RGBA8I",t[t.RGBA8UI=36220]="RGBA8UI",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8"})(g||(g={}));var p;(function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"})(p||(p={}));var bi;(function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"})(bi||(bi={}));var Ai;(function(t){t[t.LINEAR=9729]="LINEAR",t[t.NEAREST=9728]="NEAREST",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"})(Ai||(Ai={}));var wi;(function(t){t[t.REPEAT=10497]="REPEAT",t[t.CLAMP=33071]="CLAMP",t[t.REPEAT_MIRROR=33648]="REPEAT_MIRROR"})(wi||(wi={}));const w=(t,e,n,s=!1,i=!1,r=s)=>({format:t,types:e,render:s,renderExt:r,filter:i,num:n}),zr={[g.ALPHA]:w(g.ALPHA,[p.UNSIGNED_BYTE,1,p.HALF_FLOAT,2,p.HALF_FLOAT_OES,2,p.FLOAT,4],1,!0,!0),[g.DEPTH_COMPONENT]:w(g.DEPTH_COMPONENT,[p.UNSIGNED_SHORT,2,p.UNSIGNED_INT,4],1,!0),[g.DEPTH_COMPONENT16]:w(g.DEPTH_COMPONENT,[p.UNSIGNED_SHORT,2,p.UNSIGNED_INT,4],1,!0),[g.DEPTH_COMPONENT24]:w(g.DEPTH_COMPONENT,[p.UNSIGNED_INT,4],1,!0),[g.DEPTH_COMPONENT32F]:w(g.DEPTH_COMPONENT,[p.FLOAT,4],1,!0),[g.DEPTH_STENCIL]:w(g.DEPTH_STENCIL,[p.UNSIGNED_INT_24_8,4],1,!0),[g.DEPTH24_STENCIL8]:w(g.DEPTH_STENCIL,[p.UNSIGNED_INT_24_8,4],1,!0),[g.DEPTH32F_STENCIL8]:w(g.DEPTH_STENCIL,[p.FLOAT_32_UNSIGNED_INT_24_8_REV,4],1,!0),[g.LUMINANCE_ALPHA]:w(g.LUMINANCE_ALPHA,[p.UNSIGNED_BYTE,2,p.HALF_FLOAT,4,p.HALF_FLOAT_OES,4,p.FLOAT,8],2,!0,!0),[g.LUMINANCE]:w(g.LUMINANCE,[p.UNSIGNED_BYTE,1,p.HALF_FLOAT,2,p.HALF_FLOAT_OES,2,p.FLOAT,4],1,!0,!0),[g.R11F_G11F_B10F]:w(g.RGB,[p.FLOAT,12,p.HALF_FLOAT,6,p.UNSIGNED_INT_10F_11F_11F_REV,4],3,!1,!0,!0),[g.R16F]:w(g.RED,[p.FLOAT,4,p.HALF_FLOAT,2],1,!1,!0,!0),[g.R16I]:w(g.RED_INTEGER,[p.SHORT,2],1,!0),[g.R16UI]:w(g.RED_INTEGER,[p.UNSIGNED_SHORT,2],1,!0),[g.R32F]:w(g.RED,[p.FLOAT,4],1,!1,!1,!0),[g.R32I]:w(g.RED_INTEGER,[p.INT,4],1,!0),[g.R32UI]:w(g.RED_INTEGER,[p.UNSIGNED_INT,4],1,!0),[g.R8_SNORM]:w(g.RED,[p.BYTE,1],1,!1,!0),[g.R8]:w(g.RED,[p.UNSIGNED_BYTE,1],1,!0,!0),[g.R8I]:w(g.RED_INTEGER,[p.BYTE,1],1,!0),[g.R8UI]:w(g.RED_INTEGER,[p.UNSIGNED_BYTE,1],1,!0),[g.RG16F]:w(g.RG,[p.FLOAT,8,p.HALF_FLOAT,4],2,!1,!0,!0),[g.RG16I]:w(g.RG_INTEGER,[p.SHORT,4],2,!0),[g.RG16UI]:w(g.RG_INTEGER,[p.UNSIGNED_SHORT,4],2,!0),[g.RG32F]:w(g.RG,[p.FLOAT,8],2,!1,!1,!0),[g.RG32I]:w(g.RG_INTEGER,[p.INT,8],2,!0),[g.RG32UI]:w(g.RG_INTEGER,[p.UNSIGNED_INT,8],2,!0),[g.RG8_SNORM]:w(g.RG,[p.BYTE,2],2,!1,!0),[g.RG8]:w(g.RG,[p.UNSIGNED_BYTE,2],2,!0,!0),[g.RG8I]:w(g.RG_INTEGER,[p.BYTE,2],2,!0),[g.RG8UI]:w(g.RG_INTEGER,[p.UNSIGNED_BYTE,2],2,!0),[g.RGB]:w(g.RGB,[p.UNSIGNED_BYTE,3,p.HALF_FLOAT,6,p.HALF_FLOAT_OES,6,p.FLOAT,12,p.UNSIGNED_SHORT_5_6_5,2],3,!0,!0),[g.RGB10_A2]:w(g.RGBA,[p.UNSIGNED_INT_2_10_10_10_REV,4],4,!0,!0),[g.RGB10_A2UI]:w(g.RGBA_INTEGER,[p.UNSIGNED_INT_2_10_10_10_REV,4],4,!0),[g.RGB16F]:w(g.RGB,[p.FLOAT,12,p.HALF_FLOAT,6],3,!1,!0),[g.RGB16I]:w(g.RGB_INTEGER,[p.SHORT,6],3),[g.RGB16UI]:w(g.RGB_INTEGER,[p.UNSIGNED_SHORT,6],3),[g.RGB32F]:w(g.RGB,[p.FLOAT,12],3),[g.RGB32I]:w(g.RGB_INTEGER,[p.INT,12],3),[g.RGB32UI]:w(g.RGB_INTEGER,[p.UNSIGNED_INT,12],3),[g.RGB5_A1]:w(g.RGBA,[p.UNSIGNED_BYTE,4,p.UNSIGNED_SHORT_5_5_5_1,2,p.UNSIGNED_INT_2_10_10_10_REV,4],4,!0,!0),[g.RGB565]:w(g.RGB,[p.UNSIGNED_BYTE,3,p.UNSIGNED_SHORT_5_6_5,2],3,!0,!0),[g.RGB8_SNORM]:w(g.RGB,[p.BYTE,3],3,!1,!0),[g.RGB8]:w(g.RGB,[p.UNSIGNED_BYTE,3],3,!0,!0),[g.RGB8I]:w(g.RGB_INTEGER,[p.BYTE,3],3),[g.RGB8UI]:w(g.RGB_INTEGER,[p.UNSIGNED_BYTE,3],3),[g.RGB9_E5]:w(g.RGB,[p.FLOAT,12,p.HALF_FLOAT,6,p.UNSIGNED_INT_5_9_9_9_REV,4],3,!1,!0),[g.RGBA]:w(g.RGBA,[p.UNSIGNED_BYTE,4,p.HALF_FLOAT,8,p.HALF_FLOAT_OES,8,p.FLOAT,16,p.UNSIGNED_SHORT_4_4_4_4,2,p.UNSIGNED_SHORT_5_5_5_1,2],4,!0,!0),[g.RGBA16F]:w(g.RGBA,[p.FLOAT,16,p.HALF_FLOAT,8],4,!1,!0,!0),[g.RGBA16I]:w(g.RGBA_INTEGER,[p.SHORT,8],4,!0),[g.RGBA16UI]:w(g.RGBA_INTEGER,[p.UNSIGNED_SHORT,8],4,!0),[g.RGBA32F]:w(g.RGBA,[p.FLOAT,16],4,!1,!1,!0),[g.RGBA32I]:w(g.RGBA_INTEGER,[p.INT,16],4,!0),[g.RGBA32UI]:w(g.RGBA_INTEGER,[p.UNSIGNED_INT,16],4,!0),[g.RGBA4]:w(g.RGBA,[p.UNSIGNED_BYTE,4,p.UNSIGNED_SHORT_4_4_4_4,2],4,!0,!0),[g.RGBA8_SNORM]:w(g.RGBA,[p.BYTE,4],4,!1,!0),[g.RGBA8]:w(g.RGBA,[p.UNSIGNED_BYTE,4],4,!0,!0),[g.RGBA8I]:w(g.RGBA_INTEGER,[p.BYTE,4],4,!0),[g.RGBA8UI]:w(g.RGBA_INTEGER,[p.UNSIGNED_BYTE,4],4,!0),[g.SRGB8_ALPHA8]:w(g.RGBA,[p.UNSIGNED_BYTE,4],4,!0,!0),[g.SRGB8]:w(g.RGB,[p.UNSIGNED_BYTE,3],3,!1,!0)};var X;(function(t){t[t.I8=5120]="I8",t[t.U8=5121]="U8",t[t.I16=5122]="I16",t[t.U16=5123]="U16",t[t.I32=5124]="I32",t[t.U32=5125]="U32",t[t.F32=5126]="F32"})(X||(X={}));X.I8+"",X.U8+"",X.I16+"",X.U16+"",X.I32+"",X.U32+"",X.F32+"";const u3={i8:X.I8,u8:X.U8,u8c:X.U8,i16:X.I16,u16:X.U16,i32:X.I32,u32:X.U32,f32:X.F32,f64:void 0},f3={i8:0,u8:0,u8c:0,i16:1,u16:1,i32:2,u32:2,i64:3,u64:3,f32:2,f64:3},d3={f32:Float32Array,f64:Float64Array},h3={i8:Int8Array,i16:Int16Array,i32:Int32Array},m3={u8:Uint8Array,u8c:Uint8ClampedArray,u16:Uint16Array,u32:Uint32Array},Yl={...d3,...h3,...m3},bf=t=>{const e=u3[t];return e!==void 0?e:t},g3=t=>{if(Array.isArray(t))return"f64";for(let e in Yl)if(t instanceof Yl[e])return e;return"f64"},va=t=>typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext;class Af{constructor(e,n,s=e.ARRAY_BUFFER,i=e.STATIC_DRAW,r=!1){this.gl=e,this.buffer=e.createBuffer()||Jt("error creating WebGL buffer"),this.target=s,this.mode=i,n&&(this.set(n),r&&(this.data=n))}bind(){return this.gl.bindBuffer(this.target,this.buffer),!0}unbind(){return this.gl.bindBuffer(this.target,null),!0}release(){return this.buffer&&(this.gl.deleteBuffer(this.buffer),delete this.buffer),!0}update(){this.data&&this.set(this.data)}set(e,n=this.mode){this.bind(),this.gl.bufferData(this.target,e,n),this.data&&(this.data=e)}setChunk(e,n=0){this.bind(),this.gl.bufferSubData(this.target,n,e),this.data&&this.data.set(e,n>>>f3[g3(e)])}}const p3=(t,e,n=t.ARRAY_BUFFER,s=t.STATIC_DRAW)=>new Af(t,e,n,s),y3=(t,e,n=t.STATIC_DRAW)=>(e.attribPool?e.attribs=A3(t,e.attribPool,void 0,t.ARRAY_BUFFER,n):Xl(t,e.attribs,n),e.instances&&Xl(t,e.instances.attribs,n),b3(t,e.indices,n),e.mode==null&&(e.mode=yi.TRIANGLES),e),wf=(t,e,n,s)=>{e.buffer?e.data&&e.buffer.set(e.data):e.buffer=new Af(t,e.data,n,s)},Xl=(t,e,n)=>{if(e)for(let s in e)wf(t,e[s],t.ARRAY_BUFFER,n);return e},b3=(t,e,n=t.STATIC_DRAW)=>(e&&wf(t,e,t.ELEMENT_ARRAY_BUFFER,n),e),A3=(t,e,n,s=t.ARRAY_BUFFER,i=t.STATIC_DRAW)=>{const r=p3(t,e.bytes(),s,i),o={};for(let a of n||Object.keys(e.specs)){const l=e.specs[a];o[a]={buffer:r,size:l.size,type:bf(l.type),stride:e.byteStride,offset:l.byteOffset}}return o},tt=Array.isArray,w3=t=>t instanceof Map,_f=(t,e)=>t!=null&&typeof t[e]=="function",Sf=t=>e=>{if(!!e)for(let n=e.length,s;n-- >0;)(s=e[n])&&s[t](n)},_3=Sf("bind"),S3=Sf("unbind");class R3{constructor(e,n={}){this.gl=e,this.tex=e.createTexture()||Jt("error creating WebGL texture"),this.configure({filter:Ai.NEAREST,wrap:wi.CLAMP,...n})}configure(e={},n=!0){const s=this.gl,i=e.target||this.target||bi.TEXTURE_2D,r=e.format||this.format||g.RGBA,o=zr[r],a=e.type||this.type||o.types[0];return!this.target&&(this.target=i),this.format=r,this.type=a,s.bindTexture(this.target,this.tex),e.flip!==void 0&&s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e.flip?1:0),e.premultiply!==void 0&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiply?1:0),this.configureImage(i,e),e.mipmap&&s.generateMipmap(i),this.configureFilter(i,e),this.configureWrap(i,e),this.configureLOD(i,e),this.configureLevels(i,e),n&&s.bindTexture(this.target,null),!0}configureImage(e,n){n.image!==void 0&&(e===bi.TEXTURE_3D?this.configureImage3d(e,n):this.configureImage2d(e,n))}configureImage2d(e,n){const s=n.level||0,i=n.pos||[0,0,0],{image:r,width:o,height:a}=n,u=zr[this.format].format,{gl:c,type:m,format:h}=this;o&&a?n.sub?c.texSubImage2D(e,s,i[0],i[1],o,a,u,m,r):(s===0&&(this.size=[o,a]),c.texImage2D(e,s,h,o,a,0,u,m,r)):n.sub?c.texSubImage2D(e,s,i[0],i[1],u,m,r):(r!=null&&s===0&&(this.size=[r.width,r.height]),c.texImage2D(e,s,h,u,m,r))}configureImage3d(e,n){const{image:s,width:i,height:r,depth:o}=n;if(!(i&&r&&o))return;const a=n.level||0,l=n.pos||[0,0,0],c=zr[this.format].format,{gl:m,type:h,format:b}=this;n.sub?m.texSubImage3D(e,a,l[0],l[1],l[2],i,r,o,c,h,s):(a===0&&(this.size=[i,r,o]),m.texImage3D(e,a,b,i,r,o,0,c,h,s))}configureFilter(e,n){const s=this.gl,i=n.filter||this.filter||Ai.NEAREST;let r,o;tt(i)?(r=i[0],o=i[1]||r,this.filter=[r,o]):(this.filter=[i,i,i],r=o=i),s.texParameteri(e,s.TEXTURE_MIN_FILTER,r),s.texParameteri(e,s.TEXTURE_MAG_FILTER,o)}configureWrap(e,n){const s=this.gl,i=n.wrap||this.wrap||wi.CLAMP;let r,o,a;tt(i)?(r=i[0],o=i[1]||r,a=i[2]||r,this.wrap=[r,o,a]):(r=o=a=i,this.wrap=[i,i,i]),s.texParameteri(e,s.TEXTURE_WRAP_S,r),s.texParameteri(e,s.TEXTURE_WRAP_T,o),va(s)&&e===s.TEXTURE_3D&&s.texParameteri(e,s.TEXTURE_WRAP_R,a)}configureLOD(e,n){const s=this.gl;if(n.lod){const[i,r]=n.lod;i&&s.texParameterf(e,s.TEXTURE_MIN_LOD,i),r&&s.texParameterf(e,s.TEXTURE_MAX_LOD,r)}}configureLevels(e,n){const s=this.gl;if(n.minMaxLevel){const[i,r]=n.minMaxLevel;s.texParameteri(e,s.TEXTURE_BASE_LEVEL,i),s.texParameteri(e,s.TEXTURE_MAX_LEVEL,r)}}bind(e=0){const n=this.gl;return n.activeTexture(n.TEXTURE0+e),n.bindTexture(this.target,this.tex),!0}unbind(e=0){const n=this.gl;return n.activeTexture(n.TEXTURE0+e),n.bindTexture(this.target,null),!0}release(){return this.tex?(this.gl.deleteTexture(this.tex),delete this.tex,delete this.gl,!0):!1}}const Wl=(t,e)=>new R3(t,e),I3=(t,e={})=>{const n=tt(t)?t:[t];for(let s=0,i=n.length;s<i;s++){const r=n[s],o=r.indices,a=r.shader.gl;e.bindTex!==!1&&_3(r.textures),e.shaderState!==!1&&r.shader.prepareState(),e.bindShader!==!1&&r.shader.bind(r),o&&o.buffer?(o.buffer.bind(),r.instances?Ql(a,r):a.drawElements(r.mode,r.num,o.data instanceof Uint32Array?a.UNSIGNED_INT:a.UNSIGNED_SHORT,0)):r.instances?Ql(a,r):a.drawArrays(r.mode,0,r.num),e.unbindShader!==!1&&r.shader.unbind(null),e.unbindTex&&S3(r.textures)}},Ql=(t,e)=>{const n=va(t),s=n?void 0:t.getExtension("ANGLE_instanced_arrays");n||s||Jt("instancing not supported");const i=e.shader.attribs,r=e.instances.attribs;e.shader.bindAttribs(r);for(let o in r){const a=i[o];if(a){let l=r[o].divisor;l=l!==void 0?l:1,n?t.vertexAttribDivisor(a.loc,l):s.vertexAttribDivisorANGLE(a.loc,l)}}if(e.indices){const o=e.indices.data instanceof Uint32Array?t.UNSIGNED_INT:t.UNSIGNED_SHORT;n?t.drawElementsInstanced(e.mode,e.num,o,0,e.instances.num):s.drawElementsInstancedANGLE(e.mode,e.num,o,0,e.instances.num)}else n?t.drawArraysInstanced(e.mode,0,e.num,e.instances.num):s.drawArraysInstancedANGLE(e.mode,0,e.num,e.instances.num);for(let o in r){const a=i[o];a&&(n?t.vertexAttribDivisor(a.loc,0):s.vertexAttribDivisorANGLE(a.loc,0))}e.shader.unbind(null)};let ns=ga;const E3=Object.freeze([1,0,0,1]);Object.freeze([1,0,0,1,0,0]);const v3=Object.freeze([1,0,0,0,1,0,0,0,1]),$3=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),N3=Ju(()=>"unsupported operation"),M3=t=>{throw new N3(t)},$a=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},O3=$a(()=>"Assertion failed"),Rf=(typeof process<"u"&&process.env!==void 0?!!{}.UMBRELLA_ASSERTS:!!{}.VITE_UMBRELLA_ASSERTS)?(t,e)=>{if(typeof t=="function"&&!t()||!t)throw new O3(typeof e=="function"?e():e)}:()=>{},mo=(t,e)=>(Rf(t.tag!=="swizzle"||t.val.tag==="sym","can't assign to non-symbol swizzle"),{tag:"assign",type:t.type,l:t,r:e}),Pn=t=>typeof t=="string";let D3=0;const Na=(t="_s")=>`${t}${(D3++).toString(36)}`,x3=Array.isArray,pt=Symbol(),Zl=()=>{},Jl=Object.getPrototypeOf({}),Ns="function",Kl="string",de=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===Ns)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===Ns)return e.equiv(t)}else return t==e;return typeof t===Kl||typeof e===Kl?!1:(n=Object.getPrototypeOf(t),(n==null||n===Jl)&&(n=Object.getPrototypeOf(e),n==null||n===Jl)?z3(t,e):typeof t!==Ns&&t.length!==void 0&&typeof e!==Ns&&e.length!==void 0?G3(t,e):t instanceof Set&&e instanceof Set?T3(t,e):t instanceof Map&&e instanceof Map?C3(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},G3=(t,e,n=de)=>{let s=t.length;if(s===e.length)for(;s-- >0&&n(t[s],e[s]););return s<0},T3=(t,e,n=de)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),C3=(t,e,n=de)=>t.size===e.size&&n([...t].sort(),[...e].sort()),z3=(t,e,n=de)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(!e.hasOwnProperty(s)||!n(t[s],e[s]))return!1;return!0},B3=(t,e,n=de)=>{for(let s=t.length;s-- >0;)if(n(e,t[s]))return s;return-1};function If(t,e){for(let n of e)t.delete(n);return t}const L3=(t,e)=>{if(t===e)return!0;if(!(e instanceof Map)||t.size!==e.size)return!1;for(let n of t.entries())if(!de(e.get(n[0]),n[1]))return!1;return!0},P3=(t,e)=>{if(t===e)return!0;if(!(e instanceof Set)||t.size!==e.size)return!1;for(let n of t.keys())if(!e.has(n))return!1;return!0},F3="modulepreload",U3=function(t,e){return new URL(t,e).href},tc={},k3=function(e,n,s){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=U3(r,s),r in tc)return;tc[r]=!0;const o=r.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let c=i.length-1;c>=0;c--){const m=i[c];if(m.href===r&&(!o||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":F3,o||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),o)return new Promise((c,m)=>{u.addEventListener("load",c),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())},q3=(t,e={})=>{const n=Reflect.ownKeys(t),s=Reflect.ownKeys(e),i=Symbol("isa");function r(o){for(let a of n){const l=Object.getOwnPropertyDescriptor(o.prototype,a);(!l||l.configurable)&&Object.defineProperty(o.prototype,a,{value:t[a],writable:!0})}return Object.defineProperty(o.prototype,i,{value:!0}),o}for(let o of s)Object.defineProperty(r,o,{value:e[o],enumerable:e.propertyIsEnumerable(o)});return Object.defineProperty(r,Symbol.hasInstance,{value:o=>!!o[i]}),r},V3=()=>typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node<"u",j3=t=>t!=null&&typeof t[Symbol.iterator]=="function",H3=(t,e)=>[t[0],t[1],e],Y3=t=>_f(t,"xform")?t.xform():t;class Ef{constructor(e){this.value=e}deref(){return this.value}}const X3=t=>t instanceof Ef,W3=t=>t instanceof Ef?t.deref():t;function*Q3(t,e){const n=Y3(t)([Zl,Zl,(s,i)=>i])[2];for(let s of e){let i=n(pt,s);if(X3(i)){i=W3(i.deref()),i!==pt&&(yield i);return}i!==pt&&(yield i)}}function Ma(t,e){return j3(e)?Q3(Ma(t),e):n=>{const s=n[2];return H3(n,(i,r)=>s(i,t(r)))}}let ss=null;V3()&&k3(()=>import("./__vite-browser-external.aaa15d46.js"),[],import.meta.url).then(t=>{ss=t.inspect});const Z3=(t,e)=>[...Ma(n=>ss(n,e),t)].join(", "),J3=(t,e)=>[...Ma(([n,s])=>`${ss(n,e)} => ${ss(s,e)}`,t)].join(", "),vf=q3({[Symbol.for("nodejs.util.inspect.custom")](t,e){const n=this[Symbol.toStringTag],s={...e,depth:e.depth===null?null:e.depth-1};return t>=0?[`${n}(${this.size||0}) {`,ss?this instanceof Set?Z3(this,s):this instanceof Map?J3(this,s):"":"","}"].join(" "):e.stylize(`[${n}]`,"special")}});function _i(t,e){if(w3(t))for(let n of e)t.set(n[0],n[1]);else for(let n of e)t.add(n);return t}var vn;const be=new WeakMap,Lt=t=>be.get(t).vals;let ut=vn=class extends Set{constructor(e,n={}){super(),be.set(this,{equiv:n.equiv||de,vals:[]}),e&&this.into(e)}*[Symbol.iterator](){yield*Lt(this)}get[Symbol.species](){return vn}get[Symbol.toStringTag](){return"ArraySet"}get size(){return Lt(this).length}copy(){const{equiv:e,vals:n}=be.get(this),s=new vn(null,{equiv:e});return be.get(s).vals=n.slice(),s}empty(){return new vn(null,this.opts())}clear(){Lt(this).length=0}first(){if(this.size)return Lt(this)[0]}add(e){return!this.has(e)&&Lt(this).push(e),this}into(e){return _i(this,e)}has(e){return this.get(e,pt)!==pt}get(e,n){const{equiv:s,vals:i}=be.get(this),r=B3(i,e,s);return r>=0?i[r]:n}delete(e){const{equiv:n,vals:s}=be.get(this);for(let i=s.length;i-- >0;)if(n(s[i],e))return s.splice(i,1),!0;return!1}disj(e){return If(this,e)}equiv(e){return P3(this,e)}forEach(e,n){const s=Lt(this);for(let i=s.length;i-- >0;){const r=s[i];e.call(n,r,r,this)}}*entries(){for(let e of Lt(this))yield[e,e]}*keys(){yield*Lt(this)}*values(){yield*Lt(this)}opts(){return{equiv:be.get(this).equiv}}};ut=vn=pa([vf],ut);var $n;const lt=new WeakMap,Ms=t=>lt.get(t).map;let Si=$n=class extends Map{constructor(e,n){super();const s={equiv:de,keys:ut,...n};lt.set(this,{keys:new s.keys(null,{equiv:s.equiv}),map:new Map,opts:s}),e&&this.into(e)}[Symbol.iterator](){return this.entries()}get[Symbol.species](){return $n}get[Symbol.toStringTag](){return"EquivMap"}get size(){return lt.get(this).keys.size}clear(){const{keys:e,map:n}=lt.get(this);e.clear(),n.clear()}empty(){return new $n(null,lt.get(this).opts)}copy(){const{keys:e,map:n,opts:s}=lt.get(this),i=new $n;return lt.set(i,{keys:e.copy(),map:new Map(n),opts:s}),i}equiv(e){return L3(this,e)}delete(e){const{keys:n,map:s}=lt.get(this);return e=n.get(e,pt),e!==pt?(s.delete(e),n.delete(e),!0):!1}dissoc(e){return If(this,e)}forEach(e,n){for(let s of Ms(this))e.call(n,s[1],s[0],this)}get(e,n){const{keys:s,map:i}=lt.get(this);return e=s.get(e,pt),e!==pt?i.get(e):n}has(e){return lt.get(this).keys.has(e)}set(e,n){const{keys:s,map:i}=lt.get(this),r=s.get(e,pt);return r!==pt?i.set(r,n):(s.add(e),i.set(e,n)),this}into(e){return _i(this,e)}entries(){return Ms(this).entries()}keys(){return Ms(this).keys()}values(){return Ms(this).values()}opts(){return lt.get(this).opts}};Si=$n=pa([vf],Si);const K3=(t,e)=>_f(t,"copy")?t.copy():new(t[Symbol.species]||e)(t),$f=(t,e,n)=>{if(t.size<e.size){const s=t;t=e,e=s}return n=n?_i(n,t):K3(t,Set),t===e?n:_i(n,e)},ec=Object.getPrototypeOf({}),Os="function",nc="string",ds=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===Os)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===Os)return e.equiv(t)}else return t==e;return typeof t===nc||typeof e===nc?!1:(n=Object.getPrototypeOf(t),(n==null||n===ec)&&(n=Object.getPrototypeOf(e),n==null||n===ec)?s5(t,e):typeof t!==Os&&t.length!==void 0&&typeof e!==Os&&e.length!==void 0?t5(t,e):t instanceof Set&&e instanceof Set?e5(t,e):t instanceof Map&&e instanceof Map?n5(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},t5=(t,e,n=ds)=>{let s=t.length;if(s===e.length)for(;s-- >0&&n(t[s],e[s]););return s<0},e5=(t,e,n=ds)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),n5=(t,e,n=ds)=>t.size===e.size&&n([...t].sort(),[...e].sort()),s5=(t,e,n=ds)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(!e.hasOwnProperty(s)||!n(t[s],e[s]))return!1;return!0},Nf=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},i5=Nf(()=>"illegal argument(s)"),r5=t=>{throw new i5(t)},o5=t=>t!=null&&typeof t[Symbol.iterator]=="function",a5=(t,e)=>[t[0],t[1],e],Br=Symbol(),sc=()=>{},Mf=(t,e)=>t!=null&&typeof t[e]=="function",l5=t=>Mf(t,"xform")?t.xform():t,c5=t=>t!=null&&typeof t!="function"&&t.length!==void 0,u5=Nf(()=>"illegal arity"),f5=t=>{throw new u5(t)};class Of{constructor(e){this.value=e}deref(){return this.value}}const Oa=t=>t instanceof Of,Df=t=>t instanceof Of?t.deref():t,d5=t=>t.length===2?[void 0,t[1]]:t.length===3?[t[1],t[2]]:f5(t.length);function h5(...t){const e=t[0],n=e[0],s=e[1],i=e[2];t=d5(t);const r=t[0]==null?n():t[0],o=t[1];return Df(s(Mf(o,"$reduce")?o.$reduce(i,r):c5(o)?m5(i,r,o):g5(i,r,o)))}const m5=(t,e,n)=>{for(let s=0,i=n.length;s<i;s++)if(e=t(e,n[s]),Oa(e)){e=e.deref();break}return e},g5=(t,e,n)=>{for(let s of n)if(e=t(e,s),Oa(e)){e=e.deref();break}return e},p5=(t,e)=>[t,n=>n,e];function*y5(t,e){const n=l5(t)([sc,sc,(s,i)=>i])[2];for(let s of e){let i=n(Br,s);if(Oa(i)){i=Df(i.deref()),i!==Br&&(yield i);return}i!==Br&&(yield i)}}function go(t,e){return o5(e)?y5(go(t),e):n=>{const s=n[2];return a5(n,(i,r)=>t(r)?s(i,r):i)}}class is{constructor(e){if(this.dependencies=new Si,this.dependents=new Si,e)for(let[n,s]of e)s!=null?this.addDependency(n,s):this.addNode(n)}*[Symbol.iterator](){yield*this.sort()}get[Symbol.species](){return is}copy(){const e=new is;for(let n of this.dependencies)e.dependencies.set(n[0],n[1].copy());for(let n of this.dependents)e.dependents.set(n[0],n[1].copy());return e}addNode(e){return!this.dependencies.has(e)&&this.dependencies.set(e,new ut),this}addDependency(e,n){(ds(e,n)||this.depends(n,e))&&r5(`Circular dependency between: ${e} & ${n}`);let s=this.dependencies.get(e);return this.dependencies.set(e,s?s.add(n):new ut([n])),s=this.dependents.get(n),this.dependents.set(n,s?s.add(e):new ut([e])),this}addDependencies(e,n){for(let s of n)this.addDependency(e,s)}removeEdge(e,n){let s=this.dependencies.get(e);return s&&s.delete(n),s=this.dependents.get(n),s&&s.delete(e),this}removeNode(e){return this.dependencies.delete(e),this}depends(e,n){return this.transitiveDependencies(e).has(n)}dependent(e,n){return this.transitiveDependents(e).has(n)}immediateDependencies(e){return this.dependencies.get(e)||new ut}immediateDependents(e){return this.dependents.get(e)||new ut}isLeaf(e){return this.immediateDependents(e).size===0}isRoot(e){return this.immediateDependencies(e).size===0}nodes(){return $f(new ut(this.dependencies.keys()),new ut(this.dependents.keys()))}leaves(){return go(e=>this.isLeaf(e),this.nodes())}roots(){return go(e=>this.isRoot(e),this.nodes())}transitiveDependencies(e){return po(this.dependencies,e)}transitiveDependents(e){return po(this.dependents,e)}sort(){const e=[],n=this.copy();let s=new ut(n.leaves());for(;;){if(!s.size)return e.reverse();const i=s.first();s.delete(i);for(let r of[...n.immediateDependencies(i)])n.removeEdge(i,r),n.isLeaf(r)&&s.add(r);e.push(i),n.removeNode(i)}}}const po=(t,e)=>{const n=t.get(e);return n?h5(p5(null,(s,i)=>$f(s,po(t,i))),n,n):new ut},Ki=t=>typeof t=="number",ic=Object.getPrototypeOf,b5=t=>{let e;return t!=null&&typeof t=="object"&&((e=ic(t))===null||ic(e)===null)},A5=/^[iub]?vec[234]$/,w5=/^mat[234]$/,_5=t=>b5(t)&&!!t.tag&&!!t.type,ln=t=>A5.test(t.type),xf=t=>w5.test(t.type),Gf=t=>t.tag==="fn"||t.tag==="for"||t.tag=="while"?t.scope.body:t.tag==="if"?t.f?t.t.body.concat(t.f.body):t.t.body:void 0,S5=t=>Gf(t)||(t.tag==="scope"?t.body:t.tag==="ternary"?[t.t,t.f]:t.tag==="ret"?[t.val]:t.tag==="call"||t.tag==="call_i"?t.args:t.tag==="sym"&&t.init?[t.init]:t.tag==="decl"?[t.id]:t.tag==="op1"||t.tag==="swizzle"?[t.val]:t.tag==="op2"?[t.l,t.r]:t.tag==="assign"?[t.r]:ln(t)||xf(t)||_5(t.val)?t.val:void 0),Ri=(t,e,n,s,i=!0)=>{if(x3(s))s.forEach(r=>n=Ri(t,e,n,r,i));else{i&&(n=t(n,s));const r=e(s);r&&(n=Ri(t,e,n,r,i)),!i&&(n=t(n,s))}return n},Tf=(t,e=new is)=>t.deps&&t.deps.length?t.deps.reduce((n,s)=>Tf(s,n.addDependency(t,s)),e):e.addNode(t),R5=t=>({tag:"decl",type:t.type,id:t}),Cf=(t,e=!1)=>({tag:"scope",type:"void",body:t.filter(n=>n!=null).map(n=>n.tag==="sym"?R5(n):n),global:e}),I5=t=>{const e=t.filter(s=>s.tag!=="fn"),n=t.reduce((s,i)=>i.tag==="fn"?Tf(i,s):s,new is);return Cf(e.concat(n.sort()),!0)},E5=$a(()=>"illegal argument(s)"),zf=t=>{throw new E5(t)};function ft(t,...e){let n,s,i;switch(e.length){case 0:Pn(t)||(i=t,t=i.type);break;case 1:Pn(e[0])?n=e[0]:e[0].tag?i=e[0]:s=e[0];break;case 2:Pn(e[0])?[n,s]=e:[s,i]=e;break;case 3:[n,s,i]=e;break;default:zf()}return{tag:"sym",type:t,id:n||Na(),opts:s||{},init:i}}const rc=(t,e,n)=>ft(t,e,{q:"in",type:"in",...n}),oc=(t,e,n)=>ft(t,e,{q:"out",type:"out",...n}),ac=(t,e,n)=>ft(t,e,{q:"in",type:"uni",...n}),v5=t=>{const[e,n,s]=Pn(t)?[t]:t;return{tag:"arg",type:e,id:n||Na(),opts:{q:"in",...s}}};function $5(t,e,n,s){e=e||Na();const i=n.map(v5),r=s(...i.map(u=>ft(u.type,u.id,u.opts))).filter(u=>u!=null),o=Ri((u,c)=>(c.tag==="ret"&&(Rf(c.type===t,`wrong return type for function '${e}', expected ${t}, got ${c.type}`),u++),u),Gf,0,r);if(t!=="void"&&!o)throw new Error(`function '${e}' must return a value of type ${t}`);const a=Ri((u,c)=>(c.tag==="call"&&c.fn&&u.push(c.fn),u),S5,[],r),l=(...u)=>N5(l,...u);return Object.assign(l,{tag:"fn",type:t,id:e,args:i,deps:a,scope:Cf(r)})}const Bf=t=>$5("void","main",[],t);function N5(t,...e){return Pn(t)?{tag:"call",type:e[0],id:t,args:e.slice(1)}:{tag:"call",type:t.type,id:t.id,args:e,fn:t}}const lc=(t,e,...n)=>({tag:"call_i",type:e,id:t,args:n}),Da=t=>typeof t=="boolean",$e=(t,e,n)=>t===e.type&&n===e.info?e:{tag:"lit",type:t,info:n,val:e},Lf=t=>$e("bool",Ki(t)?!!t:t),Tt=t=>$e("float",Da(t)?t&1:t),Pf=t=>$e("int",Da(t)?t&1:Ki(t)?t|0:t),Ff=t=>$e("uint",Da(t)?t&1:Ki(t)?t>>>0:t),M5=(t,e)=>n=>Ki(n)||n!==void 0&&!ln(n)&&n.type!==t?e(n):n,O5=M5("float",Tt);Lf(!0);Lf(!1);const Uf=Tt(0),D5=Tt(1);Tt(2);Tt(.5);Pf(0);Pf(1);Ff(0);Ff(1);Tt(Math.PI);Tt(Math.PI*2);Tt(Math.PI/2);Tt(Math.SQRT2);Tt((1+Math.sqrt(5))/2);const x5=(t,e)=>n=>[n[0]===void 0?e:t(n[0]),...n.slice(1).map(t)],xa=x5(O5,Uf),G5=(t,e="")=>t[0]+e.substring(1),Ga=(t,e)=>ln(t[0])?G5(t[0].type,e[t.length]):e[t.length],T5=(t,e,n)=>$e(t,n=e(n),Ga(n,["n","n"])),C5=(t,e,n)=>$e(t,n=e(n),Ga(n,["n","n","vn"])),z5=(t,e,n)=>$e(t,n=e(n),n.length===2?ln(n[1])?n[0].type[0]+n[1].type[0]:"vn":Ga(n,["n","n",,"vnn"]));function Ta(...t){return T5("vec2",xa,t)}function Ca(...t){return C5("vec3",xa,t)}function B5(...t){return z5("vec4",xa,t)}Ta(0);Ta(1);Ta(2);Ca(0);Ca(1);Ca(2);const cc=t=>{const e=t.type[0],n=t.type.indexOf("Shadow")>0;return e==="s"?n?"float":"vec4":e==="i"?n?"int":"ivec4":e==="u"?n?"uint":"uvec4":zf(`unknown sampler type ${t.type}`)},L5=(t,e,n,s)=>{const i=s?lc(t,cc(e),e,...n,s):lc(t,cc(e),e,...n);return!ln(i)&&(i.info="n"),i};function P5(t,e,n){return L5("texture",t,[e],n)}const F5=t=>{let{size:e,uv:n,center:s}={size:2,uv:!0,center:!0,...t};e*=.5;const i=s?0:e;return{attribs:{position:{data:new Float32Array([i-e,i-e,i+e,i-e,i-e,i+e,i+e,i+e]),size:2},...n?{uv:{data:new Float32Array([0,0,1,0,0,1,1,1]),size:2}}:null},uniforms:{},shader:null,mode:yi.TRIANGLE_STRIP,num:4}},U5=t=>t!=null&&typeof t.deref=="function",k5=t=>U5(t)?t.deref():t,kf=t=>t!=null,q5=t=>typeof t=="boolean",Ii=t=>typeof t=="function",uc=(t,e)=>(!e&&(e=new Map),n=>{e.has(n)||(e.set(n,!0),t(n))});var dt;(function(t){t.GLES_100="100",t.GLES_300="300 es"})(dt||(dt={}));const V5=t=>typeof t=="boolean",Lr=t=>typeof t=="number",j5=(t,e=n=>n!==void 0?": "+n:"")=>class extends Error{constructor(n){super(t(n)+e(n))}},H5=j5(()=>"unsupported operation"),Pr=t=>{throw new H5(t)},Y5=t=>t.replace("[]",""),X5=$a(()=>"unsupported operation"),qf=t=>{throw new X5(t)};let W5=ga;const ie=Symbol();function Q5(t,e,n){const s={},i=e?Z5(e):{},r=(...o)=>{const a=t(...o),l=s[a]||qs(s,i,a)||s[ie];return l?l(...o):qf(`missing implementation for: "${a.toString()}"`)};return r.add=(o,a)=>(s[o]&&W5.warn(`overwriting '${o.toString()}' impl`),s[o]=a,!0),r.addAll=o=>{let a=!0;for(let l in o)a=r.add(l,o[l])&&a;return ie in o&&r.setDefault(o[ie]),a},r.setDefault=o=>r.add(ie,o),r.remove=o=>s[o]?(delete s[o],!0):!1,r.callable=(...o)=>{const a=t(...o);return!!(s[a]||qs(s,i,a)||s[ie])},r.isa=(o,a)=>{let l=i[o];!l&&(i[o]=l=new Set),l.add(a)},r.impls=()=>{const o=new Set(Object.keys(s));for(let a in i)qs(s,i,a)&&o.add(a);return s[ie]&&o.add(ie),o},r.rels=()=>i,r.parents=o=>i[o],r.ancestors=o=>new Set(Vf([],i,o)),r.dependencies=function*(){for(let o in i)for(let a of i[o])yield[o,a];for(let o in s)!i[o]&&(yield[o,void 0])},n&&r.addAll(n),r}const qs=(t,e,n)=>{const s=e[n];if(!!s)for(let i of s){let r=t[i]||qs(t,e,i);if(r)return r}},Vf=(t,e,n)=>{const s=e[n];if(s)for(let i of s)t.push(i),Vf(t,e,i);return t},Z5=t=>{const e={};for(let n in t){const s=t[n];e[n]=s instanceof Set?s:Array.isArray(s)?new Set(s):new Set([s])}return e},J5=t=>Q5(e=>e.tag,{},{[ie]:e=>qf(`no impl for AST node type: '${e.tag}'`),...t}),fc=/[};]$/,K5=t=>{const e={type:"fs",version:dt.GLES_300,versionPragma:!0,prelude:"",...t},n=e.type==="vs",s=e.prec!==void 0?c=>c===(c|0)?c+".0":c.toFixed(e.prec):c=>c===(c|0)?c+".0":String(c),i=c=>c,r=(c,m=", ")=>c.map(u).join(m),o=c=>`${c.id}(${r(c.args)})`,a=(c,m=!1)=>{const{id:h,type:b,opts:A,init:N}=c,E=[];if(A.type){let D;e.version<dt.GLES_300?n?D={in:"attribute",out:"varying",uni:"uniform"}[A.type]:(D={in:"varying",out:null,uni:"uniform"}[A.type],!D&&Pr("GLSL 100 doesn't support fragment shader output variables")):(A.loc!=null&&E.push(`layout(location=${A.loc}) `),A.smooth!=null&&E.push(A.smooth+" "),D=A.type==="uni"?"uniform":A.type),E.push(D+" ")}else A.const&&E.push("const "),m&&A.q&&E.push(A.q+" ");return A.prec&&E.push(A.prec+" "),E.push(i(Y5(b))," ",h),A.num&&E.push(`[${A.num}]`),N&&E.push(" = ",u(N)),E.join("")},l=c=>`${u(c.val)}[${u(c.id)}]`,u=J5({arg:c=>a(c,!0),array_init:c=>e.version>=dt.GLES_300?`${c.type}(${r(c.init)})`:Pr(`array initializers not available in GLSL ${e.version}`),assign:c=>u(c.l)+" = "+u(c.r),ctrl:c=>c.id,call:o,call_i:c=>c.id==="texture"&&e.version<dt.GLES_300?`${c.id}${c.args[0].type.substring(7)}(${r(c.args)})`:o(c),decl:c=>a(c.id),fn:c=>`${i(c.type)} ${c.id}(${r(c.args)}) ${u(c.scope)}`,for:c=>`for(${c.init?u(c.init):""}; ${u(c.test)}; ${c.iter?u(c.iter):""}) ${u(c.scope)}`,idx:l,idxm:l,if:c=>{const m=`if (${u(c.test)}) `+u(c.t);return c.f?m+" else "+u(c.f):m},lit:c=>{const m=c.val;switch(c.type){case"bool":return V5(m)?String(m):`bool(${u(m)})`;case"float":return Lr(m)?s(m):`float(${u(m)})`;case"int":return Lr(m)?String(m):`int(${u(m)})`;case"uint":return Lr(m)?`${m}u`:`uint(${u(m)})`;default:return ln(c)||xf(c)?`${c.type}(${r(m)})`:Pr(`unknown type: ${c.type}`)}},op1:c=>c.post?`(${u(c.val)}${c.op})`:`(${c.op}${u(c.val)})`,op2:c=>`(${u(c.l)} ${c.op} ${u(c.r)})`,ret:c=>"return"+(c.val?" "+u(c.val):""),scope:c=>{let m=c.body.map(u).reduce((h,b)=>(h.push(fc.test(b)?b:b+";"),h),[]).join(`
`);return m+=c.body.length&&!fc.test(m)?";":"",c.global?(e.prelude&&(m=e.prelude+`
`+m),e.versionPragma&&(m=`#version ${e.version}
`+m),m):`{
${m}
}`},swizzle:c=>`${u(c.val)}.${c.id}`,sym:c=>c.id,ternary:c=>`(${u(c.test)} ? ${u(c.t)} : ${u(c.f)})`,while:c=>`while (${u(c.test)}) ${u(c.scope)}`});return Object.assign(u,{gl_FragColor:ft("vec4","gl_FragColor"),gl_FragCoord:ft("vec4","gl_FragCoord",{const:!0}),gl_FragData:ft("vec4[]","gl_FragData",{num:1}),gl_FrontFacing:ft("bool","gl_FrontFacing",{const:!0}),gl_PointCoord:ft("vec2","gl_PointCoord",{const:!0}),gl_PointSize:ft("float","gl_PointSize"),gl_Position:ft("vec4","gl_Position")}),u};function*Fr(t){for(let e in t)t.hasOwnProperty(e)&&(yield t[e])}const tA={a:"",v:"",u:"",o:""},eA={[dt.GLES_100]:{number:100,attrib:(t,e,n)=>`attribute ${tt(e)?e[0]:e} ${n.a}${t};`,varying:{vs:(t,e,n)=>Me("varying",e,n.v+t),fs:(t,e,n)=>Me("varying",e,n.v+t)},uniform:(t,e,n)=>Me("uniform",e,n.u+t),output:(t,e,n)=>tt(e)?`#define ${n.o}${t} gl_FragData[${e[1]}]`:""},[dt.GLES_300]:{number:300,attrib:(t,e,n)=>tt(e)?`layout(location=${e[1]}) in ${e[0]} ${n.a}${t};`:`in ${e} ${n.a}${t};`,varying:{vs:(t,e,n)=>Me("out",e,n.v+t),fs:(t,e,n)=>Me("in",e,n.v+t)},uniform:(t,e,n)=>Me("uniform",e,n.u+t),output:(t,e,n)=>tt(e)?`layout(location=${e[1]}) out ${e[0]} ${n.o}${t};`:`out ${e} ${n.o}${t};`}},Me=(t,e,n)=>{const s=tt(e)?e[0]:e;return s.indexOf("[]")>0?`${t} ${s.replace("[]","")} ${n}[${e[1]}];`:`${t} ${s} ${n};`},dc=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp int;
precision highp float;
#else
precision mediump int;
precision mediump float;
#endif
#ifndef PI
#define PI 3.141592653589793
#endif
#ifndef TAU
#define TAU 6.283185307179586
#endif
#ifndef HALF_PI
#define HALF_PI 1.570796326794896
#endif
`,hc=Object.getPrototypeOf({}),Ds="function",mc="string",tr=(t,e)=>{let n;if(t===e)return!0;if(t!=null){if(typeof t.equiv===Ds)return t.equiv(e)}else return t==e;if(e!=null){if(typeof e.equiv===Ds)return e.equiv(t)}else return t==e;return typeof t===mc||typeof e===mc?!1:(n=Object.getPrototypeOf(t),(n==null||n===hc)&&(n=Object.getPrototypeOf(e),n==null||n===hc)?iA(t,e):typeof t!==Ds&&t.length!==void 0&&typeof e!==Ds&&e.length!==void 0?za(t,e):t instanceof Set&&e instanceof Set?nA(t,e):t instanceof Map&&e instanceof Map?sA(t,e):t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():t instanceof RegExp&&e instanceof RegExp?t.toString()===e.toString():t!==t&&e!==e)},za=(t,e,n=tr)=>{let s=t.length;if(s===e.length)for(;s-- >0&&n(t[s],e[s]););return s<0},nA=(t,e,n=tr)=>t.size===e.size&&n([...t.keys()].sort(),[...e.keys()].sort()),sA=(t,e,n=tr)=>t.size===e.size&&n([...t].sort(),[...e].sort()),iA=(t,e,n=tr)=>{if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(!e.hasOwnProperty(s)||!n(t[s],e[s]))return!1;return!0},Vt=-1/0,jt=1/0;Object.freeze([Vt,Vt]);Object.freeze([jt,jt]);Object.freeze([1,1]);const ge=Object.freeze([0,0]);Object.freeze([1,0]);Object.freeze([0,1]);Object.freeze([Vt,Vt,Vt]);Object.freeze([jt,jt,jt]);Object.freeze([1,1,1]);const pe=Object.freeze([0,0,0]);Object.freeze([1,0,0]);Object.freeze([0,1,0]);Object.freeze([0,0,1]);Object.freeze([Vt,Vt,Vt,Vt]);Object.freeze([jt,jt,jt,jt]);Object.freeze([1,1,1,1]);const ye=Object.freeze([0,0,0,0]);Object.freeze([1,0,0,0]);Object.freeze([0,1,0,0]);Object.freeze([0,0,1,0]);Object.freeze([0,0,0,1]);const Pt=t=>(e,n,s=0)=>{let i;return r=>{r=r===void 0?s:r,r!==i&&(e["uniform1"+t](n,r),i=r)}},T=(t,e)=>(n,s,i=e)=>{let r=[];return o=>{o=o===void 0?i:o,za(r,o)||(n["uniform"+t](s,o),r=[...o])}},Oe=(t,e)=>(n,s,i=e)=>{let r=[];return o=>{o=o===void 0?i:o,za(r,o)||(n["uniformMatrix"+t](s,!1,o),r=[...o])}},Ft=[0],rA={bool:Pt("i"),float:Pt("f"),int:Pt("i"),uint:Pt("ui"),bvec2:T("2iv",ge),bvec3:T("3iv",pe),bvec4:T("4iv",ye),ivec2:T("2iv",ge),ivec3:T("3iv",pe),ivec4:T("4iv",ye),vec2:T("2fv",ge),vec3:T("3fv",pe),vec4:T("4fv",ye),mat2:Oe("2fv",E3),mat3:Oe("3fv",v3),mat4:Oe("4fv",$3),sampler2D:Pt("i"),sampler2DShadow:Pt("i"),sampler3D:Pt("i"),samplerCube:Pt("i"),samplerCubeShadow:Pt("i"),"bool[]":T("1iv",Ft),"float[]":T("1fv",Ft),"int[]":T("1iv",Ft),"uint[]":T("1uiv",Ft),"bvec2[]":T("2iv",ge),"bvec3[]":T("3iv",pe),"bvec4[]":T("4iv",ye),"ivec2[]":T("2iv",ge),"ivec3[]":T("3iv",pe),"ivec4[]":T("4iv",ye),"vec2[]":T("2fv",ge),"vec3[]":T("3fv",pe),"vec4[]":T("4fv",ye),"mat2[]":Oe("2fv",ge),"mat3[]":Oe("3fv",pe),"mat4[]":Oe("4fv",ye),"sampler2D[]":T("1iv",Ft),"sampler2DShadow[]":T("1iv",Ft),"sampler3D[]":T("1iv",Ft),"samplerCube[]":T("1iv",Ft),"samplerCubeShadow[]":T("1iv",Ft)},oA=/ERROR: \d+:(\d+): (.*)/;class Ba{constructor(e,n,s,i,r){this.warnAttrib=uc(o=>ns.warn(`unknown attrib: ${o} (no further warnings will be shown...)`)),this.warnUni=uc(o=>ns.warn(`unknown uniform: ${o} (no further warnings will be shown...)`)),this.gl=e,this.program=n,this.attribs=s,this.uniforms=i,this.state=r||{}}withState(e){return new Ba(this.gl,this.program,this.attribs,this.uniforms,{...this.state,...e})}bind(e){return this.program?(this.gl.useProgram(this.program),this.bindAttribs(e.attribs),this.bindUniforms(e.uniforms),!0):!1}unbind(){let e;for(let n in this.attribs)(e=this.attribs[n])&&this.gl.disableVertexAttribArray(e.loc);return this.gl.useProgram(null),!0}release(){return this.program?(this.gl.deleteProgram(this.program),delete this.program,!0):!1}bindAttribs(e){const n=this.gl;let s;for(let i in e)if(s=this.attribs[i]){const r=e[i];r.buffer.bind(),n.enableVertexAttribArray(s.loc),n.vertexAttribPointer(s.loc,r.size||3,bf(r.type||n.FLOAT),r.normalized||!1,r.stride||0,r.offset||0)}else this.warnAttrib(i)}bindUniforms(e={}){const n=this.uniforms;for(let s in e){const i=n[s];if(i){let r=e[s];r=Ii(r)?r(n,e):k5(r),i.setter(r)}else this.warnUni(s)}for(let s in n)if(n.hasOwnProperty(s)&&(!e||!kf(e[s]))){const i=n[s],r=i.defaultFn?i.defaultFn(n,e):i.defaultVal;i.setter(r)}}prepareState(e=this.state){const n=this.gl;e.depth!==void 0&&this.setState(n.DEPTH_TEST,e.depth),e.cull!==void 0&&(this.setState(n.CULL_FACE,e.cull),e.cullMode&&n.cullFace(e.cullMode)),e.blend!==void 0&&(this.setState(n.BLEND,e.blend),e.blendFn&&n.blendFunc(e.blendFn[0],e.blendFn[1]),e.blendEq!==void 0&&n.blendEquation(e.blendEq)),e.stencil!==void 0&&(this.setState(n.STENCIL_TEST,e.stencil),e.stencilFn&&n.stencilFunc(e.stencilFn[0],e.stencilFn[1],e.stencilFn[2]),e.stencilOp&&n.stencilOp(e.stencilOp[0],e.stencilOp[1],e.stencilOp[2]),e.stencilMask!==void 0&&n.stencilMask(e.stencilMask))}setState(e,n){n?this.gl.enable(e):this.gl.disable(e)}}const aA=(t,e,n)=>{const s=va(t)?dt.GLES_300:dt.GLES_100,i=Ii(e.vs)?yc(e,"vs",s,n):bc(e,"vs",s),r=Ii(e.fs)?yc(e,"fs",s,n):bc(e,"fs",s);ns.debug(i),ns.debug(r),cA(t,e.ext);const o=Ac(t,t.VERTEX_SHADER,i),a=Ac(t,t.FRAGMENT_SHADER,r),l=t.createProgram()||Jt("error creating shader program");if(t.attachShader(l,o),t.attachShader(l,a),t.linkProgram(l),t.getProgramParameter(l,t.LINK_STATUS)){const u=hA(t,l,e.attribs),c=mA(t,l,e.uniforms);return t.deleteShader(o),t.deleteShader(a),new Ba(t,l,u,c,e.state)}throw new Error(`Error linking shader: ${t.getProgramInfoLog(l)}`)},xs=(t,e,n)=>{let s=[];for(let i in t)t.hasOwnProperty(i)&&s.push(e(i,t[i],n));return s.push(""),s.join(`
`)},lA=(t,e,n)=>{const s=c3[t],i=n===dt.GLES_300;return s&&(!i&&s.gl||i&&s.gl2)?`#extension ${s&&s.alias||t} : ${q5(e)?e?"enable":"disable":e}
`:""},cA=(t,e)=>{if(e)for(let n in e){const s=e[n];(s===!0||s==="require")&&Ku(t,[n],s==="require")}},jf=(t,e)=>{let n=t.pre?t.replacePrelude?t.pre:t.pre+`
`+dc:dc;if(t.ext)for(let s in t.ext)n+=lA(s,t.ext[s],e);return n},gc=(t,e,n)=>{for(let s in e){const i=e[s];n[s]=tt(i)?t(i[0],s,{loc:i[1]}):t(i,s)}},uA=t=>{const[e,n]=tt(t)?[t[0],{num:t[1]}]:[t,{}];return/(u?int|[ui]vec[234])/.test(e)&&(n.smooth="flat"),[e,n]},pc=(t,e,n)=>{for(let s in t.varying){const[i,r]=uA(t.varying[s]);n[s]=e(i,s,r)}},fA=(t,e)=>{for(let n in t.uniforms){const s=t.uniforms[n];e[n]=tt(s)?ac(s[0],n,s[0].indexOf("[]")>0?{num:s[1]}:void 0):ac(s,n)}},yc=(t,e,n,s={})=>{let i=jf(t,n);const r={},o={},a={},l={};if(t.uniforms&&fA(t,l),e==="vs")gc(rc,t.attribs,r),t.varying&&pc(t,oc,o);else{t.varying&&pc(t,rc,r);const c=t.outputs||yf;if(n>=dt.GLES_300)gc(oc,c,o);else for(let m in c){const h=c[m];tt(h)&&h[0]==="vec4"?(i+=`#define ${m} gl_FragData[${h[1]}]
`,a[m]=ft("vec4",m)):M3(`GLSL ${n} doesn't support output vars`)}}const u=K5({type:e,version:n,prelude:i,prec:s.prec});return u(I5([...Fr(l),...Fr(r),...Fr(o),...t[e](u,l,r,{...o,...a})]))+(t.post?`
`+t.post:"")},bc=(t,e,n)=>{const s=eA[n],i={...tA,...t.declPrefixes},r=e==="vs";let o="";return o+=`#version ${n}
`,o+=jf(t,n),t.generateDecls!==!1&&(o+=r?xs(t.attribs,s.attrib,i):xs(t.outputs||yf,s.output,i),o+=xs(t.varying,s.varying[e],i),o+=xs(t.uniforms,s.uniform,i)),o+=t[e],t.post&&(o+=`
`+t.post),o},Ac=(t,e,n)=>{const s=t.createShader(e)||Jt("error creating shader");return t.shaderSource(s,n),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS)?s:dA(t,s,n)},dA=(t,e,n)=>{const s=n.split(`
`),r=t.getShaderInfoLog(e).split(`
`).map(o=>{const a=oA.exec(o),l=a?a[1]:null;if(l)return`line ${l}: ${a[2]}
${s[parseInt(l)-1]}`}).filter(kf).join(`
`);return Jt(`Error compiling shader:
${r}`)},hA=(t,e,n)=>{const s={};for(let i in n){const r=n[i],[o,a]=tt(r)?r:[r,null],l=i;a!=null?(t.bindAttribLocation(e,a,l),s[i]={type:o,loc:a}):s[i]={type:o,loc:t.getAttribLocation(e,l)}}return s},mA=(t,e,n={})=>{const s={};for(let i in n){const r=n[i];let o,a,l,u,c;tt(r)?([o,a,l]=r,u=o.indexOf("[]")<0?a:l,Ii(u)&&(c=u,u=void 0)):o=r;const m=t.getUniformLocation(e,i);if(m!=null){const h=rA[o];h?s[i]={loc:m,setter:h(t,m,u),defaultFn:c,defaultVal:u,type:o}:Jt(`invalid uniform type: ${o}`)}else ns.warn(`unknown uniform: ${i}`)}return s},gA=(t,e,n,s)=>[Bf(()=>[mo(s.v_uv,n.uv),mo(t.gl_Position,B5(n.position,Uf,D5))])],pA=(t,e,n,s)=>[Bf(()=>[mo(s.fragColor,P5(e.tex,n.v_uv))])],yA={vs:gA,fs:pA,attribs:{position:"vec2",uv:"vec2"},varying:{v_uv:"vec2"},uniforms:{tex:"sampler2D"},state:{depth:!1},ext:{}};class bA{constructor(e,n){G(this,"img");G(this,"model");G(this,"tex");G(this,"light");this.gl=e,this.tex=Wl(this.gl),this.light=Wl(this.gl),this.model=y3(this.gl,{...F5(),shader:aA(this.gl,{...yA,fs:`void main() {
                    vec4 src = texture(tex, v_uv );

                    // vec4 src = texture(tex, v_uv / 2.0 + vec2(0.25, 0.35) );
                        
					mat4 matrix = u_brightnessMatrix * u_contrastMatrix * u_exposureMatrix * u_saturationMatrix * u_filterMatrix;
					vec4 offset = u_brightnessOffset + u_contrastOffset + u_exposureOffset + u_saturationOffset * u_filterOffset;

					// Diff view
					// fragColor = mix(src, matrix * src + offset, step(0.5, v_uv.x + 0.75 * (-v_uv.y + 0.5)));
					fragColor = matrix * src + offset;
                    // fragColor = src;
                }`,uniforms:{tex:"sampler2D",u_brightnessMatrix:["mat4",gf],u_brightnessOffset:["vec4",[n.brightness,n.brightness,n.brightness,0]],u_contrastMatrix:["mat4",il([],1+n.contrast)],u_contrastOffset:["vec4",[-.5*n.contrast,-.5*n.contrast,-.5*n.contrast,0]],u_filterMatrix:["mat4",n.filterMatrix],u_filterOffset:["vec4",n.filterOffset],u_exposureMatrix:["mat4",il([],1+n.exposure)],u_exposureOffset:["vec4",[0,0,0,0]],u_saturationMatrix:["mat4",this.computeSaturationMatrix(n.saturation)],u_saturationOffset:["vec4",[0,0,0,0]]}}),textures:[this.tex,this.light]})}updateImage(e){this.img=e,this.tex.configure({image:e,width:e.width,height:e.height,flip:!0})}draw(){I3(this.model)}computeSaturationMatrix(e){const n=1+e,s=.2126,i=.7152,r=.0722,o=(1-n)*s,a=(1-n)*i,l=(1-n)*r;return[o+n,o,o,0,a,a+n,a,0,l,l,l+n,0,0,0,0,1]}}let wt,La,ce,Vs=!0,oe,yo,Hf,Ei,bo,AA=!1,vi;const wA=async()=>{wt=a3();const{preset:t}=wt;ce=pf({width:window.innerWidth,height:window.innerHeight},t);const{canvas:e,scaledSize:n,glCanvas:s}=ce;vi=new bA(s.gl,t.postprocess),rp()&&(bo=c1(e.canvas,fxhash,{fps:30})),La=await i3(t.assets),Yf()},Yf=()=>{const{preset:t,presetId:e}=wt,{xRes:n,yRes:s,gridFactor:i,vector_field:r,agents:o,bounds:a,style:l,events:u,aspectRatio:c}=t;oe=new cp(new ao(Math.floor(n*i),Math.floor(s*i),ii([0,0],[1*c,1]),0,(N,E)=>0),o,o.initialStep,a.overall,a.update,lp,!1),yo=new by(wt.preset,oe,La),window.agentManager=oe;const{canvas:m,scaledSize:h}=ce;Qn(m.ctx,si({lineCap:"round"},SA(h,t))),Hf=new l3(u);let b=0,A=0;for(;b<o.initial&&A<1e3;)oe.createAgent(!1,C(a.init,a.init.map(N=>Xr(N))),d(a.overall),o.initialDirections,yo)&&b++;rs()},rs=()=>{const{preset:t}=wt,{canvas:e}=ce;Hf.checkEvents(t,oe);const n=oe.updateAgents(t.step,t.agents.branch,t.agents.maxNewPerFrame,yo,!0),s=Xf(wt,ce);Qn(e.ctx,s),vi.updateImage(e.canvas),vi.draw(),n||fxpreview(),n&&Vs&&(Ei=requestAnimationFrame(rs))},_A=()=>{cancelAnimationFrame(Ei),ce=pf({width:window.innerWidth,height:window.innerHeight},wt.preset),rs()},Xf=({preset:t,lineSlice:e,presetId:n},{scaledSize:s})=>{const i=oe.getAgents(!AA).map(o=>o.getShape(ih(s[0]/t.aspectRatio,s[1]),t.style.getValue(o,oe,La),3));return si({lineCap:"round"},i)},SA=(t,e,n)=>{let s=[];return[ii(t,{fill:e.colors.bg[0]}),...s]};window.onkeydown=t=>{switch(t.key){case"p":cancelAnimationFrame(Ei),Yf();break;case" ":Vs=!Vs,Vs&&rs();break;case"x":cancelAnimationFrame(Ei),vi.draw(),l1(ce.glCanvas.canvas,`${wt.presetId}-${fxhash}-${Pa()}`,"png"),rs();break;case"s":Ao(`${fxhash}-${Pa()}.svg`,ug(fg({},Xf(wt,ce))),{mime:"image/svg+xml"});break;case"q":console.log("starting canvas video recording"),bo.start();break;case"w":console.log("stopping canvas video recording"),bo.stop();break}};window.onresize=_A;wA();window.$fxhashFeatures={preset:wt.presetId};u1("state",wt);
